nohup: ignoring input
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_96', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_96_SparseTSF_ETTh1_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Epoch: 1 cost time: 2.75582218170166
Epoch: 1, Steps: 30 | Train Loss: 0.4787085 Vali Loss: 0.9947836 Test Loss: 0.4005520
Epoch: 2 cost time: 2.0931410789489746
Epoch: 2, Steps: 30 | Train Loss: 0.4092841 Vali Loss: 0.8829373 Test Loss: 0.3871351
Epoch: 3 cost time: 2.1084654331207275
Epoch: 3, Steps: 30 | Train Loss: 0.3728871 Vali Loss: 0.7833111 Test Loss: 0.3716554
Epoch: 4 cost time: 1.9579479694366455
Epoch: 4, Steps: 30 | Train Loss: 0.3682732 Vali Loss: 0.8351892 Test Loss: 0.3782333
Epoch: 5 cost time: 2.2994346618652344
Epoch: 5, Steps: 30 | Train Loss: 0.3659340 Vali Loss: 0.8089378 Test Loss: 0.3748807
Epoch: 6 cost time: 4.174033880233765
Epoch: 6, Steps: 30 | Train Loss: 0.3661785 Vali Loss: 0.8190299 Test Loss: 0.3761048
Epoch: 7 cost time: 2.049938440322876
Epoch: 7, Steps: 30 | Train Loss: 0.3655201 Vali Loss: 0.8172212 Test Loss: 0.3768365
Epoch: 8 cost time: 1.951592206954956
Epoch: 8, Steps: 30 | Train Loss: 0.3656684 Vali Loss: 0.8171737 Test Loss: 0.3770051
Epoch: 9 cost time: 1.9897491931915283
Epoch: 9, Steps: 30 | Train Loss: 0.3656379 Vali Loss: 0.8188226 Test Loss: 0.3778815
Epoch: 10 cost time: 1.9919219017028809
Epoch: 10, Steps: 30 | Train Loss: 0.3657347 Vali Loss: 0.8188753 Test Loss: 0.3783140
Epoch: 11 cost time: 2.065488338470459
Epoch: 11, Steps: 30 | Train Loss: 0.3657790 Vali Loss: 0.8194143 Test Loss: 0.3786943
Epoch: 12 cost time: 2.0045812129974365
Epoch: 12, Steps: 30 | Train Loss: 0.3658594 Vali Loss: 0.8198905 Test Loss: 0.3790975
Epoch: 13 cost time: 2.0177857875823975
Epoch: 13, Steps: 30 | Train Loss: 0.3659075 Vali Loss: 0.8201419 Test Loss: 0.3793549
Epoch: 14 cost time: 1.9588823318481445
Epoch: 14, Steps: 30 | Train Loss: 0.3659583 Vali Loss: 0.8204335 Test Loss: 0.3795979
Epoch: 15 cost time: 2.001966953277588
Epoch: 15, Steps: 30 | Train Loss: 0.3660024 Vali Loss: 0.8206552 Test Loss: 0.3797989
Epoch: 16 cost time: 2.13226056098938
Epoch: 16, Steps: 30 | Train Loss: 0.3660391 Vali Loss: 0.8208426 Test Loss: 0.3799632
Epoch: 17 cost time: 4.162889003753662
Epoch: 17, Steps: 30 | Train Loss: 0.3660727 Vali Loss: 0.8210055 Test Loss: 0.3801054
Epoch: 18 cost time: 2.4363889694213867
Epoch: 18, Steps: 30 | Train Loss: 0.3661018 Vali Loss: 0.8211452 Test Loss: 0.3802260
Epoch: 19 cost time: 2.0821220874786377
Epoch: 19, Steps: 30 | Train Loss: 0.3661276 Vali Loss: 0.8212668 Test Loss: 0.3803291
Epoch: 20 cost time: 2.0898818969726562
Epoch: 20, Steps: 30 | Train Loss: 0.3661508 Vali Loss: 0.8213735 Test Loss: 0.3804186
Epoch: 21 cost time: 2.015157461166382
Epoch: 21, Steps: 30 | Train Loss: 0.3661715 Vali Loss: 0.8214676 Test Loss: 0.3804961
Epoch: 22 cost time: 2.011733055114746
Epoch: 22, Steps: 30 | Train Loss: 0.3661901 Vali Loss: 0.8215514 Test Loss: 0.3805639
Epoch: 23 cost time: 1.9323256015777588
Epoch: 23, Steps: 30 | Train Loss: 0.3662070 Vali Loss: 0.8216264 Test Loss: 0.3806235
Epoch: 24 cost time: 1.965172529220581
Epoch: 24, Steps: 30 | Train Loss: 0.3662224 Vali Loss: 0.8216939 Test Loss: 0.3806763
Epoch: 25 cost time: 1.9905211925506592
Epoch: 25, Steps: 30 | Train Loss: 0.3662364 Vali Loss: 0.8217551 Test Loss: 0.3807231
Epoch: 26 cost time: 1.9842126369476318
Epoch: 26, Steps: 30 | Train Loss: 0.3662492 Vali Loss: 0.8218107 Test Loss: 0.3807651
Epoch: 27 cost time: 2.008204936981201
Epoch: 27, Steps: 30 | Train Loss: 0.3662611 Vali Loss: 0.8218616 Test Loss: 0.3808026
Epoch: 28 cost time: 1.8843142986297607
Epoch: 28, Steps: 30 | Train Loss: 0.3662721 Vali Loss: 0.8219085 Test Loss: 0.3808366
Epoch: 29 cost time: 1.9502215385437012
Epoch: 29, Steps: 30 | Train Loss: 0.3662823 Vali Loss: 0.8219516 Test Loss: 0.3808673
Epoch: 30 cost time: 1.979888677597046
Epoch: 30, Steps: 30 | Train Loss: 0.3662917 Vali Loss: 0.8219913 Test Loss: 0.3808952
>>>>>>>testing : ETTh1_720_96_SparseTSF_ETTh1_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38008734583854675, mae:0.40228673815727234, rse:0.5855979919433594
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_192', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_192_SparseTSF_ETTh1_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2689
test 2689
Epoch: 1 cost time: 2.856210947036743
Epoch: 1, Steps: 30 | Train Loss: 0.5418727 Vali Loss: 1.2023872 Test Loss: 0.5074036
Epoch: 2 cost time: 1.9724459648132324
Epoch: 2, Steps: 30 | Train Loss: 0.5044188 Vali Loss: 1.2136468 Test Loss: 0.5162278
Epoch: 3 cost time: 1.744945764541626
Epoch: 3, Steps: 30 | Train Loss: 0.4958620 Vali Loss: 1.1728799 Test Loss: 0.5079073
Epoch: 4 cost time: 1.7676315307617188
Epoch: 4, Steps: 30 | Train Loss: 0.4975044 Vali Loss: 1.2097503 Test Loss: 0.5092274
Epoch: 5 cost time: 1.8741600513458252
Epoch: 5, Steps: 30 | Train Loss: 0.4890156 Vali Loss: 1.1387248 Test Loss: 0.4902476
Epoch: 6 cost time: 2.0107131004333496
Epoch: 6, Steps: 30 | Train Loss: 0.4878426 Vali Loss: 1.2009041 Test Loss: 0.4965182
Epoch: 7 cost time: 1.8069617748260498
Epoch: 7, Steps: 30 | Train Loss: 0.4816521 Vali Loss: 1.1115841 Test Loss: 0.4707577
Epoch: 8 cost time: 1.7931106090545654
Epoch: 8, Steps: 30 | Train Loss: 0.4780580 Vali Loss: 1.1894466 Test Loss: 0.4800916
Epoch: 9 cost time: 1.857494592666626
Epoch: 9, Steps: 30 | Train Loss: 0.4772619 Vali Loss: 1.0940125 Test Loss: 0.4593709
Epoch: 10 cost time: 1.8139691352844238
Epoch: 10, Steps: 30 | Train Loss: 0.4720894 Vali Loss: 1.1834191 Test Loss: 0.4714195
Epoch: 11 cost time: 1.808655023574829
Epoch: 11, Steps: 30 | Train Loss: 0.4772248 Vali Loss: 1.0892985 Test Loss: 0.4579261
Epoch: 12 cost time: 1.7904903888702393
Epoch: 12, Steps: 30 | Train Loss: 0.4689243 Vali Loss: 1.1718119 Test Loss: 0.4664161
Epoch: 13 cost time: 1.9090454578399658
Epoch: 13, Steps: 30 | Train Loss: 0.4733356 Vali Loss: 1.0969465 Test Loss: 0.4659545
Epoch: 14 cost time: 1.998720645904541
Epoch: 14, Steps: 30 | Train Loss: 0.4684553 Vali Loss: 1.1688716 Test Loss: 0.4658211
Epoch: 15 cost time: 1.8213517665863037
Epoch: 15, Steps: 30 | Train Loss: 0.4716071 Vali Loss: 1.1005639 Test Loss: 0.4680764
Epoch: 16 cost time: 1.8503661155700684
Epoch: 16, Steps: 30 | Train Loss: 0.4694007 Vali Loss: 1.1730019 Test Loss: 0.4669306
Epoch: 17 cost time: 1.794630527496338
Epoch: 17, Steps: 30 | Train Loss: 0.4729315 Vali Loss: 1.1003795 Test Loss: 0.4680693
Epoch: 18 cost time: 1.729027271270752
Epoch: 18, Steps: 30 | Train Loss: 0.4698689 Vali Loss: 1.1722171 Test Loss: 0.4678443
Epoch: 19 cost time: 1.826364517211914
Epoch: 19, Steps: 30 | Train Loss: 0.4723501 Vali Loss: 1.1010154 Test Loss: 0.4690625
Epoch: 20 cost time: 1.8824398517608643
Epoch: 20, Steps: 30 | Train Loss: 0.4701048 Vali Loss: 1.1731429 Test Loss: 0.4681551
Epoch: 21 cost time: 1.8960552215576172
Epoch: 21, Steps: 30 | Train Loss: 0.4728936 Vali Loss: 1.1018673 Test Loss: 0.4695621
Epoch: 22 cost time: 1.7525429725646973
Epoch: 22, Steps: 30 | Train Loss: 0.4703446 Vali Loss: 1.1729786 Test Loss: 0.4684977
Epoch: 23 cost time: 1.7994520664215088
Epoch: 23, Steps: 30 | Train Loss: 0.4728042 Vali Loss: 1.1022706 Test Loss: 0.4700835
Epoch: 24 cost time: 1.8295059204101562
Epoch: 24, Steps: 30 | Train Loss: 0.4705001 Vali Loss: 1.1733205 Test Loss: 0.4686966
Epoch: 25 cost time: 1.9129555225372314
Epoch: 25, Steps: 30 | Train Loss: 0.4731089 Vali Loss: 1.1027794 Test Loss: 0.4704267
Epoch: 26 cost time: 1.7504875659942627
Epoch: 26, Steps: 30 | Train Loss: 0.4706249 Vali Loss: 1.1732222 Test Loss: 0.4688660
Epoch: 27 cost time: 1.8030602931976318
Epoch: 27, Steps: 30 | Train Loss: 0.4731515 Vali Loss: 1.1031368 Test Loss: 0.4707754
Epoch: 28 cost time: 1.908266544342041
Epoch: 28, Steps: 30 | Train Loss: 0.4707109 Vali Loss: 1.1732931 Test Loss: 0.4689730
Epoch: 29 cost time: 1.8186695575714111
Epoch: 29, Steps: 30 | Train Loss: 0.4733170 Vali Loss: 1.1034963 Test Loss: 0.4710271
Epoch: 30 cost time: 1.9097580909729004
Epoch: 30, Steps: 30 | Train Loss: 0.4707893 Vali Loss: 1.1732486 Test Loss: 0.4690673
>>>>>>>testing : ETTh1_720_192_SparseTSF_ETTh1_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.45666268467903137, mae:0.4676980972290039, rse:0.6417340636253357
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_336', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_336_SparseTSF_ETTh1_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 2.9385318756103516
Epoch: 1, Steps: 29 | Train Loss: 0.6007696 Vali Loss: 1.4389833 Test Loss: 0.5011001
Epoch: 2 cost time: 2.081223964691162
Epoch: 2, Steps: 29 | Train Loss: 0.6525562 Vali Loss: 1.6192018 Test Loss: 0.6945757
Epoch: 3 cost time: 2.1628777980804443
Epoch: 3, Steps: 29 | Train Loss: 0.5189712 Vali Loss: 1.3408846 Test Loss: 0.4477299
Epoch: 4 cost time: 2.0353965759277344
Epoch: 4, Steps: 29 | Train Loss: 0.5281866 Vali Loss: 1.3419536 Test Loss: 0.4674721
Epoch: 5 cost time: 1.9527766704559326
Epoch: 5, Steps: 29 | Train Loss: 0.5275463 Vali Loss: 1.3794278 Test Loss: 0.4819782
Epoch: 6 cost time: 2.193308115005493
Epoch: 6, Steps: 29 | Train Loss: 0.5368912 Vali Loss: 1.3597598 Test Loss: 0.4854836
Epoch: 7 cost time: 2.0831305980682373
Epoch: 7, Steps: 29 | Train Loss: 0.5651074 Vali Loss: 1.3690891 Test Loss: 0.4874443
Epoch: 8 cost time: 2.0737006664276123
Epoch: 8, Steps: 29 | Train Loss: 0.5754828 Vali Loss: 1.2858166 Test Loss: 0.4379202
Epoch: 9 cost time: 1.9802281856536865
Epoch: 9, Steps: 29 | Train Loss: 0.5436713 Vali Loss: 1.4004385 Test Loss: 0.5008639
Epoch: 10 cost time: 2.0784761905670166
Epoch: 10, Steps: 29 | Train Loss: 0.5714211 Vali Loss: 1.3056291 Test Loss: 0.4568086
Epoch: 11 cost time: 2.451690196990967
Epoch: 11, Steps: 29 | Train Loss: 0.5278627 Vali Loss: 1.3593470 Test Loss: 0.4808184
Epoch: 12 cost time: 2.164591073989868
Epoch: 12, Steps: 29 | Train Loss: 0.5648664 Vali Loss: 1.3036392 Test Loss: 0.4522212
Epoch: 13 cost time: 2.029639959335327
Epoch: 13, Steps: 29 | Train Loss: 0.5462519 Vali Loss: 1.3015144 Test Loss: 0.4507461
Epoch: 14 cost time: 2.0552048683166504
Epoch: 14, Steps: 29 | Train Loss: 0.5665118 Vali Loss: 1.3002619 Test Loss: 0.4479713
Epoch: 15 cost time: 1.9901056289672852
Epoch: 15, Steps: 29 | Train Loss: 0.5260640 Vali Loss: 1.3235885 Test Loss: 0.4660028
Epoch: 16 cost time: 2.074354648590088
Epoch: 16, Steps: 29 | Train Loss: 0.5586685 Vali Loss: 1.3119363 Test Loss: 0.4552138
Epoch: 17 cost time: 2.125318765640259
Epoch: 17, Steps: 29 | Train Loss: 0.5431889 Vali Loss: 1.3059564 Test Loss: 0.4525515
Epoch: 18 cost time: 2.047272205352783
Epoch: 18, Steps: 29 | Train Loss: 0.5618170 Vali Loss: 1.3014514 Test Loss: 0.4515570
Epoch: 19 cost time: 2.02852463722229
Epoch: 19, Steps: 29 | Train Loss: 0.5237201 Vali Loss: 1.3264333 Test Loss: 0.4647069
Epoch: 20 cost time: 2.1236791610717773
Epoch: 20, Steps: 29 | Train Loss: 0.5516810 Vali Loss: 1.3114661 Test Loss: 0.4553650
Epoch: 21 cost time: 2.10537052154541
Epoch: 21, Steps: 29 | Train Loss: 0.5519943 Vali Loss: 1.2942393 Test Loss: 0.4476371
Epoch: 22 cost time: 1.9999585151672363
Epoch: 22, Steps: 29 | Train Loss: 0.5405758 Vali Loss: 1.3183913 Test Loss: 0.4570147
Epoch: 23 cost time: 2.1127989292144775
Epoch: 23, Steps: 29 | Train Loss: 0.5545941 Vali Loss: 1.2965965 Test Loss: 0.4514934
Epoch: 24 cost time: 2.0410878658294678
Epoch: 24, Steps: 29 | Train Loss: 0.5380141 Vali Loss: 1.3094575 Test Loss: 0.4523481
Epoch: 25 cost time: 2.080461025238037
Epoch: 25, Steps: 29 | Train Loss: 0.5562178 Vali Loss: 1.2960589 Test Loss: 0.4489110
Epoch: 26 cost time: 2.0292246341705322
Epoch: 26, Steps: 29 | Train Loss: 0.5330133 Vali Loss: 1.3078758 Test Loss: 0.4546924
Epoch: 27 cost time: 2.0260589122772217
Epoch: 27, Steps: 29 | Train Loss: 0.5565655 Vali Loss: 1.3010539 Test Loss: 0.4500442
Epoch: 28 cost time: 2.035905122756958
Epoch: 28, Steps: 29 | Train Loss: 0.5304378 Vali Loss: 1.3103741 Test Loss: 0.4569561
Epoch: 29 cost time: 1.9744884967803955
Epoch: 29, Steps: 29 | Train Loss: 0.5543873 Vali Loss: 1.3031328 Test Loss: 0.4516961
Epoch: 30 cost time: 2.0315113067626953
Epoch: 30, Steps: 29 | Train Loss: 0.5333708 Vali Loss: 1.3095967 Test Loss: 0.4553406
>>>>>>>testing : ETTh1_720_336_SparseTSF_ETTh1_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.4539022147655487, mae:0.47074323892593384, rse:0.641406238079071
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_720', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_720_SparseTSF_ETTh1_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
Epoch: 1 cost time: 3.623939037322998
Epoch: 1, Steps: 28 | Train Loss: 0.7248601 Vali Loss: 1.5774292 Test Loss: 0.4779463
Epoch: 2 cost time: 2.673015832901001
Epoch: 2, Steps: 28 | Train Loss: 0.6899746 Vali Loss: 1.6068609 Test Loss: 0.4776596
Epoch: 3 cost time: 2.3678934574127197
Epoch: 3, Steps: 28 | Train Loss: 0.7199692 Vali Loss: 1.5921559 Test Loss: 0.4788395
Epoch: 4 cost time: 2.4698939323425293
Epoch: 4, Steps: 28 | Train Loss: 0.6554114 Vali Loss: 1.5334659 Test Loss: 0.4754039
Epoch: 5 cost time: 2.347440719604492
Epoch: 5, Steps: 28 | Train Loss: 0.6697588 Vali Loss: 1.5221151 Test Loss: 0.4763601
Epoch: 6 cost time: 2.414217472076416
Epoch: 6, Steps: 28 | Train Loss: 0.6849747 Vali Loss: 1.5675955 Test Loss: 0.5308954
Epoch: 7 cost time: 2.4176714420318604
Epoch: 7, Steps: 28 | Train Loss: 0.6381631 Vali Loss: 1.5275483 Test Loss: 0.4739292
Epoch: 8 cost time: 2.4725632667541504
Epoch: 8, Steps: 28 | Train Loss: 0.6538639 Vali Loss: 1.5249195 Test Loss: 0.4745123
Epoch: 9 cost time: 2.485306978225708
Epoch: 9, Steps: 28 | Train Loss: 0.6981658 Vali Loss: 1.5362463 Test Loss: 0.4972873
Epoch: 10 cost time: 2.4778034687042236
Epoch: 10, Steps: 28 | Train Loss: 0.6548011 Vali Loss: 1.5295517 Test Loss: 0.4783517
Epoch: 11 cost time: 2.4086427688598633
Epoch: 11, Steps: 28 | Train Loss: 0.6470370 Vali Loss: 1.5310967 Test Loss: 0.4747003
Epoch: 12 cost time: 2.533198118209839
Epoch: 12, Steps: 28 | Train Loss: 0.6975769 Vali Loss: 1.5337324 Test Loss: 0.4970588
Epoch: 13 cost time: 2.506728172302246
Epoch: 13, Steps: 28 | Train Loss: 0.6534379 Vali Loss: 1.5323570 Test Loss: 0.4743906
Epoch: 14 cost time: 2.470784902572632
Epoch: 14, Steps: 28 | Train Loss: 0.6561887 Vali Loss: 1.5302786 Test Loss: 0.4727577
Epoch: 15 cost time: 2.4909491539001465
Epoch: 15, Steps: 28 | Train Loss: 0.7113323 Vali Loss: 1.5249095 Test Loss: 0.4712170
Epoch: 16 cost time: 2.44423770904541
Epoch: 16, Steps: 28 | Train Loss: 0.6582903 Vali Loss: 1.5388298 Test Loss: 0.4785920
Epoch: 17 cost time: 2.383439540863037
Epoch: 17, Steps: 28 | Train Loss: 0.6398421 Vali Loss: 1.5456425 Test Loss: 0.4695054
Epoch: 18 cost time: 2.456231117248535
Epoch: 18, Steps: 28 | Train Loss: 0.6801776 Vali Loss: 1.5631990 Test Loss: 0.5177134
Epoch: 19 cost time: 2.530150890350342
Epoch: 19, Steps: 28 | Train Loss: 0.6370382 Vali Loss: 1.5195460 Test Loss: 0.4647074
Epoch: 20 cost time: 2.4493777751922607
Epoch: 20, Steps: 28 | Train Loss: 0.6619772 Vali Loss: 1.5179275 Test Loss: 0.4722761
Epoch: 21 cost time: 2.525472640991211
Epoch: 21, Steps: 28 | Train Loss: 0.6985957 Vali Loss: 1.5269246 Test Loss: 0.4854212
Epoch: 22 cost time: 2.447748899459839
Epoch: 22, Steps: 28 | Train Loss: 0.6562356 Vali Loss: 1.5268440 Test Loss: 0.4807308
Epoch: 23 cost time: 2.4189937114715576
Epoch: 23, Steps: 28 | Train Loss: 0.6373321 Vali Loss: 1.5292006 Test Loss: 0.4741036
Epoch: 24 cost time: 2.4083590507507324
Epoch: 24, Steps: 28 | Train Loss: 0.6825768 Vali Loss: 1.5583737 Test Loss: 0.5210361
Epoch: 25 cost time: 2.4435410499572754
Epoch: 25, Steps: 28 | Train Loss: 0.6369776 Vali Loss: 1.5150764 Test Loss: 0.4637522
Epoch: 26 cost time: 2.3674793243408203
Epoch: 26, Steps: 28 | Train Loss: 0.6612831 Vali Loss: 1.5195853 Test Loss: 0.4736677
Epoch: 27 cost time: 2.4401566982269287
Epoch: 27, Steps: 28 | Train Loss: 0.7025911 Vali Loss: 1.5182248 Test Loss: 0.4739422
Epoch: 28 cost time: 2.5955889225006104
Epoch: 28, Steps: 28 | Train Loss: 0.6577255 Vali Loss: 1.5283108 Test Loss: 0.4814582
Epoch: 29 cost time: 2.4103188514709473
Epoch: 29, Steps: 28 | Train Loss: 0.6349421 Vali Loss: 1.5285900 Test Loss: 0.4725088
Epoch: 30 cost time: 2.2352535724639893
Epoch: 30, Steps: 28 | Train Loss: 0.6779018 Vali Loss: 1.5510404 Test Loss: 0.5126596
>>>>>>>testing : ETTh1_720_720_SparseTSF_ETTh1_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.5063149929046631, mae:0.5010069608688354, rse:0.6811807751655579
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_96', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_96_SparseTSF_ETTh2_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Epoch: 1 cost time: 2.5567686557769775
Epoch: 1, Steps: 30 | Train Loss: 0.5741982 Vali Loss: 0.2795583 Test Loss: 0.3402581
Epoch: 2 cost time: 1.8051931858062744
Epoch: 2, Steps: 30 | Train Loss: 0.5418669 Vali Loss: 0.2942421 Test Loss: 0.3423862
Epoch: 3 cost time: 1.8931963443756104
Epoch: 3, Steps: 30 | Train Loss: 0.4932356 Vali Loss: 0.2758760 Test Loss: 0.3447649
Epoch: 4 cost time: 2.015573263168335
Epoch: 4, Steps: 30 | Train Loss: 0.5133677 Vali Loss: 0.2739346 Test Loss: 0.3663024
Epoch: 5 cost time: 1.9943392276763916
Epoch: 5, Steps: 30 | Train Loss: 0.5680813 Vali Loss: 0.2437165 Test Loss: 0.3113148
Epoch: 6 cost time: 1.8344905376434326
Epoch: 6, Steps: 30 | Train Loss: 0.6099649 Vali Loss: 0.2837830 Test Loss: 0.3245035
Epoch: 7 cost time: 1.9933481216430664
Epoch: 7, Steps: 30 | Train Loss: 0.4966005 Vali Loss: 0.2423653 Test Loss: 0.3325070
Epoch: 8 cost time: 1.8630452156066895
Epoch: 8, Steps: 30 | Train Loss: 0.4833425 Vali Loss: 0.2713208 Test Loss: 0.3365660
Epoch: 9 cost time: 1.9017014503479004
Epoch: 9, Steps: 30 | Train Loss: 0.4698143 Vali Loss: 0.2577918 Test Loss: 0.3304897
Epoch: 10 cost time: 1.9720704555511475
Epoch: 10, Steps: 30 | Train Loss: 0.4752554 Vali Loss: 0.2574793 Test Loss: 0.3712866
Epoch: 11 cost time: 1.8961224555969238
Epoch: 11, Steps: 30 | Train Loss: 0.4810595 Vali Loss: 0.2574588 Test Loss: 0.3598622
Epoch: 12 cost time: 1.8541061878204346
Epoch: 12, Steps: 30 | Train Loss: 0.4835670 Vali Loss: 0.2469442 Test Loss: 0.3441596
Epoch: 13 cost time: 1.8669805526733398
Epoch: 13, Steps: 30 | Train Loss: 0.4901238 Vali Loss: 0.2834732 Test Loss: 0.3832271
Epoch: 14 cost time: 1.908639669418335
Epoch: 14, Steps: 30 | Train Loss: 0.4891327 Vali Loss: 0.2402970 Test Loss: 0.3373415
Epoch: 15 cost time: 1.8290934562683105
Epoch: 15, Steps: 30 | Train Loss: 0.4965068 Vali Loss: 0.2809266 Test Loss: 0.3715497
Epoch: 16 cost time: 1.9082956314086914
Epoch: 16, Steps: 30 | Train Loss: 0.5217991 Vali Loss: 0.2334943 Test Loss: 0.3266067
Epoch: 17 cost time: 1.9172019958496094
Epoch: 17, Steps: 30 | Train Loss: 0.5121338 Vali Loss: 0.2464411 Test Loss: 0.3178234
Epoch: 18 cost time: 2.0017149448394775
Epoch: 18, Steps: 30 | Train Loss: 0.4938539 Vali Loss: 0.2464461 Test Loss: 0.3165881
Epoch: 19 cost time: 1.860384225845337
Epoch: 19, Steps: 30 | Train Loss: 0.4754700 Vali Loss: 0.2696502 Test Loss: 0.3323370
Epoch: 20 cost time: 1.862657070159912
Epoch: 20, Steps: 30 | Train Loss: 0.4671705 Vali Loss: 0.2478037 Test Loss: 0.3162847
Epoch: 21 cost time: 1.8093466758728027
Epoch: 21, Steps: 30 | Train Loss: 0.4699186 Vali Loss: 0.2554844 Test Loss: 0.3511407
Epoch: 22 cost time: 1.875779390335083
Epoch: 22, Steps: 30 | Train Loss: 0.5023134 Vali Loss: 0.2709913 Test Loss: 0.3881931
Epoch: 23 cost time: 1.958059549331665
Epoch: 23, Steps: 30 | Train Loss: 0.6057134 Vali Loss: 0.4238104 Test Loss: 0.3963529
Epoch: 24 cost time: 1.947192668914795
Epoch: 24, Steps: 30 | Train Loss: 0.5264997 Vali Loss: 0.2767120 Test Loss: 0.3327656
Epoch: 25 cost time: 1.9625418186187744
Epoch: 25, Steps: 30 | Train Loss: 0.5474073 Vali Loss: 0.3282492 Test Loss: 0.3900707
Epoch: 26 cost time: 1.8746724128723145
Epoch: 26, Steps: 30 | Train Loss: 0.5216172 Vali Loss: 0.2394647 Test Loss: 0.3116772
Epoch: 27 cost time: 1.9044685363769531
Epoch: 27, Steps: 30 | Train Loss: 0.5343940 Vali Loss: 0.3276316 Test Loss: 0.3262026
Epoch: 28 cost time: 1.9596951007843018
Epoch: 28, Steps: 30 | Train Loss: 0.4741484 Vali Loss: 0.2598580 Test Loss: 0.3235588
Epoch: 29 cost time: 1.8140900135040283
Epoch: 29, Steps: 30 | Train Loss: 0.4645694 Vali Loss: 0.2501729 Test Loss: 0.3505662
Epoch: 30 cost time: 1.9585347175598145
Epoch: 30, Steps: 30 | Train Loss: 0.4699096 Vali Loss: 0.2432797 Test Loss: 0.3411252
>>>>>>>testing : ETTh2_720_96_SparseTSF_ETTh2_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.33779647946357727, mae:0.37438511848449707, rse:0.4683913588523865
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_192', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_192_SparseTSF_ETTh2_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2689
test 2689
Epoch: 1 cost time: 2.8133785724639893
Epoch: 1, Steps: 30 | Train Loss: 0.6252142 Vali Loss: 0.3568133 Test Loss: 0.4234554
Epoch: 2 cost time: 2.131260871887207
Epoch: 2, Steps: 30 | Train Loss: 0.6212046 Vali Loss: 0.3588193 Test Loss: 0.4615283
Epoch: 3 cost time: 2.081888198852539
Epoch: 3, Steps: 30 | Train Loss: 0.7312695 Vali Loss: 0.4005648 Test Loss: 0.4402638
Epoch: 4 cost time: 2.0258305072784424
Epoch: 4, Steps: 30 | Train Loss: 0.6988770 Vali Loss: 0.3205196 Test Loss: 0.3747460
Epoch: 5 cost time: 1.9835684299468994
Epoch: 5, Steps: 30 | Train Loss: 0.6063815 Vali Loss: 0.3524989 Test Loss: 0.4042225
Epoch: 6 cost time: 1.794053316116333
Epoch: 6, Steps: 30 | Train Loss: 0.5893736 Vali Loss: 0.3244407 Test Loss: 0.4565820
Epoch: 7 cost time: 1.81959867477417
Epoch: 7, Steps: 30 | Train Loss: 0.7422324 Vali Loss: 0.4113752 Test Loss: 0.3741332
Epoch: 8 cost time: 1.9176056385040283
Epoch: 8, Steps: 30 | Train Loss: 0.6175061 Vali Loss: 0.2907719 Test Loss: 0.3824374
Epoch: 9 cost time: 1.8820984363555908
Epoch: 9, Steps: 30 | Train Loss: 0.6543511 Vali Loss: 0.4065922 Test Loss: 0.4163988
Epoch: 10 cost time: 1.8952584266662598
Epoch: 10, Steps: 30 | Train Loss: 0.6614658 Vali Loss: 0.4921803 Test Loss: 0.4640555
Epoch: 11 cost time: 2.04667329788208
Epoch: 11, Steps: 30 | Train Loss: 0.6442612 Vali Loss: 0.3771822 Test Loss: 0.4143940
Epoch: 12 cost time: 2.0031864643096924
Epoch: 12, Steps: 30 | Train Loss: 0.6004269 Vali Loss: 0.3274803 Test Loss: 0.4045699
Epoch: 13 cost time: 1.9017164707183838
Epoch: 13, Steps: 30 | Train Loss: 0.5811808 Vali Loss: 0.3220114 Test Loss: 0.4027643
Epoch: 14 cost time: 1.9349799156188965
Epoch: 14, Steps: 30 | Train Loss: 0.6291903 Vali Loss: 0.3591537 Test Loss: 0.5053877
Epoch: 15 cost time: 1.9158759117126465
Epoch: 15, Steps: 30 | Train Loss: 0.6477420 Vali Loss: 0.3114861 Test Loss: 0.3959388
Epoch: 16 cost time: 2.445343017578125
Epoch: 16, Steps: 30 | Train Loss: 0.5988218 Vali Loss: 0.3173768 Test Loss: 0.4788980
Epoch: 17 cost time: 2.0124871730804443
Epoch: 17, Steps: 30 | Train Loss: 0.6803132 Vali Loss: 0.4100317 Test Loss: 0.4963200
Epoch: 18 cost time: 2.00578236579895
Epoch: 18, Steps: 30 | Train Loss: 0.6547470 Vali Loss: 0.4178356 Test Loss: 0.5293127
Epoch: 19 cost time: 1.9042329788208008
Epoch: 19, Steps: 30 | Train Loss: 0.6738066 Vali Loss: 0.3378472 Test Loss: 0.3696103
Epoch: 20 cost time: 1.8751139640808105
Epoch: 20, Steps: 30 | Train Loss: 0.7138491 Vali Loss: 0.3381209 Test Loss: 0.3808495
Epoch: 21 cost time: 1.8316240310668945
Epoch: 21, Steps: 30 | Train Loss: 0.7042904 Vali Loss: 0.4660026 Test Loss: 0.4617305
Epoch: 22 cost time: 2.1174511909484863
Epoch: 22, Steps: 30 | Train Loss: 0.7525788 Vali Loss: 0.4210897 Test Loss: 0.3924584
Epoch: 23 cost time: 2.0690460205078125
Epoch: 23, Steps: 30 | Train Loss: 0.7293214 Vali Loss: 0.5012726 Test Loss: 0.4537610
Epoch: 24 cost time: 2.000716209411621
Epoch: 24, Steps: 30 | Train Loss: 0.6703064 Vali Loss: 0.3454335 Test Loss: 0.4558270
Epoch: 25 cost time: 1.942678451538086
Epoch: 25, Steps: 30 | Train Loss: 0.7119271 Vali Loss: 0.4267495 Test Loss: 0.3819146
Epoch: 26 cost time: 1.9036288261413574
Epoch: 26, Steps: 30 | Train Loss: 0.5810591 Vali Loss: 0.3167432 Test Loss: 0.4679828
Epoch: 27 cost time: 2.0162768363952637
Epoch: 27, Steps: 30 | Train Loss: 0.6198860 Vali Loss: 0.3615339 Test Loss: 0.4332983
Epoch: 28 cost time: 1.9094290733337402
Epoch: 28, Steps: 30 | Train Loss: 0.6262335 Vali Loss: 0.3054038 Test Loss: 0.3814783
Epoch: 29 cost time: 2.0256214141845703
Epoch: 29, Steps: 30 | Train Loss: 0.5861748 Vali Loss: 0.3083760 Test Loss: 0.4520026
Epoch: 30 cost time: 1.8356812000274658
Epoch: 30, Steps: 30 | Train Loss: 0.6062123 Vali Loss: 0.3406193 Test Loss: 0.4125606
>>>>>>>testing : ETTh2_720_192_SparseTSF_ETTh2_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.3898484706878662, mae:0.40376800298690796, rse:0.5007128715515137
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_336', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 3.0003528594970703
Epoch: 1, Steps: 29 | Train Loss: 0.7556563 Vali Loss: 0.4761322 Test Loss: 0.4176778
Epoch: 2 cost time: 2.346489429473877
Epoch: 2, Steps: 29 | Train Loss: 0.7701066 Vali Loss: 0.4463924 Test Loss: 0.3829872
Epoch: 3 cost time: 2.468825578689575
Epoch: 3, Steps: 29 | Train Loss: 0.7605547 Vali Loss: 0.4634879 Test Loss: 0.3544042
Epoch: 4 cost time: 2.324974775314331
Epoch: 4, Steps: 29 | Train Loss: 0.7632164 Vali Loss: 0.5273986 Test Loss: 0.3883513
Epoch: 5 cost time: 2.3318119049072266
Epoch: 5, Steps: 29 | Train Loss: 0.6956277 Vali Loss: 0.4183815 Test Loss: 0.3948360
Epoch: 6 cost time: 2.3739192485809326
Epoch: 6, Steps: 29 | Train Loss: 0.7071228 Vali Loss: 0.4521785 Test Loss: 0.4506940
Epoch: 7 cost time: 2.2960190773010254
Epoch: 7, Steps: 29 | Train Loss: 0.7983894 Vali Loss: 0.5546718 Test Loss: 0.3723889
Epoch: 8 cost time: 2.316879987716675
Epoch: 8, Steps: 29 | Train Loss: 0.7695682 Vali Loss: 0.4461267 Test Loss: 0.3798781
Epoch: 9 cost time: 2.55456805229187
Epoch: 9, Steps: 29 | Train Loss: 0.8536351 Vali Loss: 0.5383645 Test Loss: 0.3759146
Epoch: 10 cost time: 2.427233934402466
Epoch: 10, Steps: 29 | Train Loss: 0.8425475 Vali Loss: 0.5576314 Test Loss: 0.3720008
Epoch: 11 cost time: 2.312020778656006
Epoch: 11, Steps: 29 | Train Loss: 0.7258108 Vali Loss: 0.5602339 Test Loss: 0.4857227
Epoch: 12 cost time: 2.381927967071533
Epoch: 12, Steps: 29 | Train Loss: 0.7705871 Vali Loss: 0.4183973 Test Loss: 0.4155761
Epoch: 13 cost time: 2.3298394680023193
Epoch: 13, Steps: 29 | Train Loss: 0.7810605 Vali Loss: 0.4231746 Test Loss: 0.3497982
Epoch: 14 cost time: 2.4917287826538086
Epoch: 14, Steps: 29 | Train Loss: 0.7015432 Vali Loss: 0.4307024 Test Loss: 0.3531642
Epoch: 15 cost time: 2.414924383163452
Epoch: 15, Steps: 29 | Train Loss: 0.6829054 Vali Loss: 0.4258488 Test Loss: 0.3792080
Epoch: 16 cost time: 2.2919607162475586
Epoch: 16, Steps: 29 | Train Loss: 0.6510969 Vali Loss: 0.4368794 Test Loss: 0.4364111
Epoch: 17 cost time: 2.3838837146759033
Epoch: 17, Steps: 29 | Train Loss: 0.6678779 Vali Loss: 0.5011018 Test Loss: 0.5338367
Epoch: 18 cost time: 2.362381935119629
Epoch: 18, Steps: 29 | Train Loss: 0.8006138 Vali Loss: 0.5493873 Test Loss: 0.3754260
Epoch: 19 cost time: 2.248326301574707
Epoch: 19, Steps: 29 | Train Loss: 0.6634184 Vali Loss: 0.4162856 Test Loss: 0.3783189
Epoch: 20 cost time: 2.3058974742889404
Epoch: 20, Steps: 29 | Train Loss: 0.6788431 Vali Loss: 0.4931319 Test Loss: 0.5012229
Epoch: 21 cost time: 2.417360782623291
Epoch: 21, Steps: 29 | Train Loss: 0.7735698 Vali Loss: 0.4336740 Test Loss: 0.3520795
Epoch: 22 cost time: 2.49428391456604
Epoch: 22, Steps: 29 | Train Loss: 0.7335400 Vali Loss: 0.4295107 Test Loss: 0.3654471
Epoch: 23 cost time: 2.419325828552246
Epoch: 23, Steps: 29 | Train Loss: 0.6790996 Vali Loss: 0.4522996 Test Loss: 0.4471447
Epoch: 24 cost time: 2.2381186485290527
Epoch: 24, Steps: 29 | Train Loss: 0.6566709 Vali Loss: 0.4872412 Test Loss: 0.5048711
Epoch: 25 cost time: 2.3975114822387695
Epoch: 25, Steps: 29 | Train Loss: 0.7249259 Vali Loss: 0.4268823 Test Loss: 0.4430293
Epoch: 26 cost time: 2.47406005859375
Epoch: 26, Steps: 29 | Train Loss: 0.8188744 Vali Loss: 0.4524400 Test Loss: 0.3800631
Epoch: 27 cost time: 2.366901159286499
Epoch: 27, Steps: 29 | Train Loss: 0.7227255 Vali Loss: 0.4422176 Test Loss: 0.3601931
Epoch: 28 cost time: 2.4316041469573975
Epoch: 28, Steps: 29 | Train Loss: 0.7415404 Vali Loss: 0.6333914 Test Loss: 0.6463686
Epoch: 29 cost time: 2.226898431777954
Epoch: 29, Steps: 29 | Train Loss: 0.7181121 Vali Loss: 0.5367798 Test Loss: 0.5684095
Epoch: 30 cost time: 2.3088300228118896
Epoch: 30, Steps: 29 | Train Loss: 0.8231775 Vali Loss: 0.5511739 Test Loss: 0.3740368
>>>>>>>testing : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.37119999527931213, mae:0.4149992763996124, rse:0.48712843656539917
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_720', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_720_SparseTSF_ETTh2_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
Epoch: 1 cost time: 3.732410192489624
Epoch: 1, Steps: 28 | Train Loss: 0.9468126 Vali Loss: 0.7227762 Test Loss: 0.4150753
Epoch: 2 cost time: 2.9370360374450684
Epoch: 2, Steps: 28 | Train Loss: 0.9720576 Vali Loss: 0.7389739 Test Loss: 0.4255534
Epoch: 3 cost time: 2.6169087886810303
Epoch: 3, Steps: 28 | Train Loss: 0.9273489 Vali Loss: 0.6698235 Test Loss: 0.4201518
Epoch: 4 cost time: 2.5068418979644775
Epoch: 4, Steps: 28 | Train Loss: 0.9297701 Vali Loss: 0.7544861 Test Loss: 0.4234208
Epoch: 5 cost time: 2.4092490673065186
Epoch: 5, Steps: 28 | Train Loss: 0.8781033 Vali Loss: 0.7252153 Test Loss: 0.4552219
Epoch: 6 cost time: 2.4892024993896484
Epoch: 6, Steps: 28 | Train Loss: 0.9387465 Vali Loss: 0.7571945 Test Loss: 0.4226316
Epoch: 7 cost time: 2.406554698944092
Epoch: 7, Steps: 28 | Train Loss: 0.8904423 Vali Loss: 0.6984481 Test Loss: 0.4170157
Epoch: 8 cost time: 2.461761951446533
Epoch: 8, Steps: 28 | Train Loss: 0.8743463 Vali Loss: 0.6712421 Test Loss: 0.3983358
Epoch: 9 cost time: 2.4013125896453857
Epoch: 9, Steps: 28 | Train Loss: 0.9644017 Vali Loss: 0.7982317 Test Loss: 0.4341198
Epoch: 10 cost time: 2.5074985027313232
Epoch: 10, Steps: 28 | Train Loss: 0.9294123 Vali Loss: 0.7406022 Test Loss: 0.4367658
Epoch: 11 cost time: 2.3762145042419434
Epoch: 11, Steps: 28 | Train Loss: 0.9264691 Vali Loss: 0.7596589 Test Loss: 0.4345510
Epoch: 12 cost time: 2.52734375
Epoch: 12, Steps: 28 | Train Loss: 0.8884997 Vali Loss: 0.6791104 Test Loss: 0.4297870
Epoch: 13 cost time: 2.3459482192993164
Epoch: 13, Steps: 28 | Train Loss: 1.0070261 Vali Loss: 0.7184620 Test Loss: 0.4118505
Epoch: 14 cost time: 2.3849899768829346
Epoch: 14, Steps: 28 | Train Loss: 0.9760066 Vali Loss: 0.7511425 Test Loss: 0.4173471
Epoch: 15 cost time: 2.401970148086548
Epoch: 15, Steps: 28 | Train Loss: 0.9336299 Vali Loss: 0.7245981 Test Loss: 0.4581136
Epoch: 16 cost time: 2.5190584659576416
Epoch: 16, Steps: 28 | Train Loss: 1.1352506 Vali Loss: 0.7573377 Test Loss: 0.4059313
Epoch: 17 cost time: 2.2413458824157715
Epoch: 17, Steps: 28 | Train Loss: 1.2192208 Vali Loss: 0.7114905 Test Loss: 0.4084804
Epoch: 18 cost time: 2.4508957862854004
Epoch: 18, Steps: 28 | Train Loss: 0.8745004 Vali Loss: 0.7134677 Test Loss: 0.4543492
Epoch: 19 cost time: 2.5964090824127197
Epoch: 19, Steps: 28 | Train Loss: 0.9126390 Vali Loss: 0.6861259 Test Loss: 0.4146979
Epoch: 20 cost time: 2.451409101486206
Epoch: 20, Steps: 28 | Train Loss: 0.8764514 Vali Loss: 0.6589693 Test Loss: 0.4090318
Epoch: 21 cost time: 2.508349657058716
Epoch: 21, Steps: 28 | Train Loss: 1.0207950 Vali Loss: 0.7400545 Test Loss: 0.4137107
Epoch: 22 cost time: 2.3164119720458984
Epoch: 22, Steps: 28 | Train Loss: 0.9136004 Vali Loss: 0.6878483 Test Loss: 0.4174516
Epoch: 23 cost time: 2.385716438293457
Epoch: 23, Steps: 28 | Train Loss: 0.9180833 Vali Loss: 0.6956472 Test Loss: 0.4580925
Epoch: 24 cost time: 2.5053765773773193
Epoch: 24, Steps: 28 | Train Loss: 0.9878731 Vali Loss: 0.7147505 Test Loss: 0.4075903
Epoch: 25 cost time: 2.5385913848876953
Epoch: 25, Steps: 28 | Train Loss: 0.8718394 Vali Loss: 0.7595872 Test Loss: 0.4820614
Epoch: 26 cost time: 2.3768765926361084
Epoch: 26, Steps: 28 | Train Loss: 0.8890422 Vali Loss: 0.7414557 Test Loss: 0.4741940
Epoch: 27 cost time: 2.304337978363037
Epoch: 27, Steps: 28 | Train Loss: 1.0188423 Vali Loss: 0.7721788 Test Loss: 0.4242605
Epoch: 28 cost time: 2.3118698596954346
Epoch: 28, Steps: 28 | Train Loss: 0.9279996 Vali Loss: 0.6952084 Test Loss: 0.4000821
Epoch: 29 cost time: 2.4702866077423096
Epoch: 29, Steps: 28 | Train Loss: 0.8767089 Vali Loss: 0.7089007 Test Loss: 0.4430565
Epoch: 30 cost time: 2.4762957096099854
Epoch: 30, Steps: 28 | Train Loss: 0.9253818 Vali Loss: 0.7416039 Test Loss: 0.4175900
>>>>>>>testing : ETTh2_720_720_SparseTSF_ETTh2_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.40149882435798645, mae:0.44240155816078186, rse:0.5064631700515747
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_96', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6589780
	speed: 0.1174s/iter; left time: 449.6971s
Epoch: 1 cost time: 7.796763181686401
Epoch: 1, Steps: 131 | Train Loss: 0.3599530 Vali Loss: 0.5022938 Test Loss: 0.4047187
	iters: 100, epoch: 2 | loss: 0.6595510
	speed: 0.1203s/iter; left time: 444.9774s
Epoch: 2 cost time: 7.060128688812256
Epoch: 2, Steps: 131 | Train Loss: 0.3341143 Vali Loss: 0.5063021 Test Loss: 0.4159591
	iters: 100, epoch: 3 | loss: 0.6682824
	speed: 0.1156s/iter; left time: 412.7334s
Epoch: 3 cost time: 7.082286596298218
Epoch: 3, Steps: 131 | Train Loss: 0.3280939 Vali Loss: 0.4899949 Test Loss: 0.4027717
	iters: 100, epoch: 4 | loss: 0.7018257
	speed: 0.1126s/iter; left time: 387.2331s
Epoch: 4 cost time: 6.6364686489105225
Epoch: 4, Steps: 131 | Train Loss: 0.3217445 Vali Loss: 0.4643811 Test Loss: 0.3807974
	iters: 100, epoch: 5 | loss: 0.7618881
	speed: 0.1144s/iter; left time: 378.2077s
Epoch: 5 cost time: 7.150387763977051
Epoch: 5, Steps: 131 | Train Loss: 0.3168752 Vali Loss: 0.4414860 Test Loss: 0.3644475
	iters: 100, epoch: 6 | loss: 0.8037145
	speed: 0.1130s/iter; left time: 358.9792s
Epoch: 6 cost time: 6.847201347351074
Epoch: 6, Steps: 131 | Train Loss: 0.3117815 Vali Loss: 0.4283134 Test Loss: 0.3575522
	iters: 100, epoch: 7 | loss: 0.8066769
	speed: 0.1142s/iter; left time: 347.8730s
Epoch: 7 cost time: 6.786661386489868
Epoch: 7, Steps: 131 | Train Loss: 0.3065696 Vali Loss: 0.4217454 Test Loss: 0.3545221
	iters: 100, epoch: 8 | loss: 0.7838617
	speed: 0.1224s/iter; left time: 356.7987s
Epoch: 8 cost time: 7.540186405181885
Epoch: 8, Steps: 131 | Train Loss: 0.3024630 Vali Loss: 0.4168725 Test Loss: 0.3502262
	iters: 100, epoch: 9 | loss: 0.7573794
	speed: 0.1174s/iter; left time: 326.7868s
Epoch: 9 cost time: 6.7737743854522705
Epoch: 9, Steps: 131 | Train Loss: 0.2995112 Vali Loss: 0.4128822 Test Loss: 0.3450741
	iters: 100, epoch: 10 | loss: 0.7408853
	speed: 0.1154s/iter; left time: 306.1036s
Epoch: 10 cost time: 7.003323793411255
Epoch: 10, Steps: 131 | Train Loss: 0.2977279 Vali Loss: 0.4104955 Test Loss: 0.3413995
	iters: 100, epoch: 11 | loss: 0.7326876
	speed: 0.1121s/iter; left time: 282.5128s
Epoch: 11 cost time: 6.706843137741089
Epoch: 11, Steps: 131 | Train Loss: 0.2967610 Vali Loss: 0.4092022 Test Loss: 0.3392648
	iters: 100, epoch: 12 | loss: 0.7286261
	speed: 0.1154s/iter; left time: 275.8289s
Epoch: 12 cost time: 7.238250732421875
Epoch: 12, Steps: 131 | Train Loss: 0.2961923 Vali Loss: 0.4084601 Test Loss: 0.3380107
	iters: 100, epoch: 13 | loss: 0.7265724
	speed: 0.1139s/iter; left time: 257.3918s
Epoch: 13 cost time: 6.8320512771606445
Epoch: 13, Steps: 131 | Train Loss: 0.2958227 Vali Loss: 0.4079925 Test Loss: 0.3372116
	iters: 100, epoch: 14 | loss: 0.7255626
	speed: 0.1152s/iter; left time: 245.0484s
Epoch: 14 cost time: 7.016849994659424
Epoch: 14, Steps: 131 | Train Loss: 0.2955661 Vali Loss: 0.4076673 Test Loss: 0.3366487
	iters: 100, epoch: 15 | loss: 0.7251405
	speed: 0.1172s/iter; left time: 234.0863s
Epoch: 15 cost time: 7.147707223892212
Epoch: 15, Steps: 131 | Train Loss: 0.2953821 Vali Loss: 0.4074213 Test Loss: 0.3362119
	iters: 100, epoch: 16 | loss: 0.7250779
	speed: 0.1153s/iter; left time: 215.1150s
Epoch: 16 cost time: 6.884438514709473
Epoch: 16, Steps: 131 | Train Loss: 0.2952497 Vali Loss: 0.4072244 Test Loss: 0.3358475
	iters: 100, epoch: 17 | loss: 0.7252506
	speed: 0.1128s/iter; left time: 195.7202s
Epoch: 17 cost time: 6.92385196685791
Epoch: 17, Steps: 131 | Train Loss: 0.2951568 Vali Loss: 0.4070611 Test Loss: 0.3355284
	iters: 100, epoch: 18 | loss: 0.7255870
	speed: 0.1152s/iter; left time: 184.8175s
Epoch: 18 cost time: 7.092162609100342
Epoch: 18, Steps: 131 | Train Loss: 0.2950956 Vali Loss: 0.4069233 Test Loss: 0.3352411
	iters: 100, epoch: 19 | loss: 0.7260399
	speed: 0.1144s/iter; left time: 168.5502s
Epoch: 19 cost time: 6.7200891971588135
Epoch: 19, Steps: 131 | Train Loss: 0.2950598 Vali Loss: 0.4068059 Test Loss: 0.3349787
	iters: 100, epoch: 20 | loss: 0.7265753
	speed: 0.1153s/iter; left time: 154.7504s
Epoch: 20 cost time: 6.903250217437744
Epoch: 20, Steps: 131 | Train Loss: 0.2950444 Vali Loss: 0.4067053 Test Loss: 0.3347375
	iters: 100, epoch: 21 | loss: 0.7271668
	speed: 0.1122s/iter; left time: 135.8949s
Epoch: 21 cost time: 6.687666416168213
Epoch: 21, Steps: 131 | Train Loss: 0.2950450 Vali Loss: 0.4066189 Test Loss: 0.3345152
	iters: 100, epoch: 22 | loss: 0.7277936
	speed: 0.1143s/iter; left time: 123.4744s
Epoch: 22 cost time: 6.87646484375
Epoch: 22, Steps: 131 | Train Loss: 0.2950579 Vali Loss: 0.4065445 Test Loss: 0.3343106
	iters: 100, epoch: 23 | loss: 0.7284387
	speed: 0.1176s/iter; left time: 111.6416s
Epoch: 23 cost time: 7.136020183563232
Epoch: 23, Steps: 131 | Train Loss: 0.2950799 Vali Loss: 0.4064804 Test Loss: 0.3341222
	iters: 100, epoch: 24 | loss: 0.7290888
	speed: 0.1175s/iter; left time: 96.1454s
Epoch: 24 cost time: 7.076192378997803
Epoch: 24, Steps: 131 | Train Loss: 0.2951085 Vali Loss: 0.4064252 Test Loss: 0.3339496
	iters: 100, epoch: 25 | loss: 0.7297323
	speed: 0.1164s/iter; left time: 79.9727s
Epoch: 25 cost time: 7.09316873550415
Epoch: 25, Steps: 131 | Train Loss: 0.2951415 Vali Loss: 0.4063775 Test Loss: 0.3337911
	iters: 100, epoch: 26 | loss: 0.7303606
	speed: 0.1120s/iter; left time: 62.2872s
Epoch: 26 cost time: 6.734112024307251
Epoch: 26, Steps: 131 | Train Loss: 0.2951772 Vali Loss: 0.4063361 Test Loss: 0.3336461
	iters: 100, epoch: 27 | loss: 0.7309669
	speed: 0.1125s/iter; left time: 47.8011s
Epoch: 27 cost time: 6.648632287979126
Epoch: 27, Steps: 131 | Train Loss: 0.2952141 Vali Loss: 0.4063002 Test Loss: 0.3335137
	iters: 100, epoch: 28 | loss: 0.7315471
	speed: 0.1131s/iter; left time: 33.2427s
Epoch: 28 cost time: 6.865283012390137
Epoch: 28, Steps: 131 | Train Loss: 0.2952514 Vali Loss: 0.4062689 Test Loss: 0.3333926
	iters: 100, epoch: 29 | loss: 0.7320981
	speed: 0.1140s/iter; left time: 18.5789s
Epoch: 29 cost time: 6.740397930145264
Epoch: 29, Steps: 131 | Train Loss: 0.2952881 Vali Loss: 0.4062412 Test Loss: 0.3332820
	iters: 100, epoch: 30 | loss: 0.7326172
	speed: 0.1161s/iter; left time: 3.7150s
Epoch: 30 cost time: 7.798099040985107
Epoch: 30, Steps: 131 | Train Loss: 0.2953237 Vali Loss: 0.4062171 Test Loss: 0.3331811
>>>>>>>testing : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.33282631635665894, mae:0.36755648255348206, rse:0.5489600300788879
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_192', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_192_SparseTSF_ETTm1_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.7412019
	speed: 0.1274s/iter; left time: 488.2286s
Epoch: 1 cost time: 8.496733665466309
Epoch: 1, Steps: 131 | Train Loss: 0.4029292 Vali Loss: 0.6012672 Test Loss: 0.4139555
	iters: 100, epoch: 2 | loss: 0.6867952
	speed: 0.1317s/iter; left time: 487.3416s
Epoch: 2 cost time: 7.613087892532349
Epoch: 2, Steps: 131 | Train Loss: 0.3831422 Vali Loss: 0.6132023 Test Loss: 0.4361408
	iters: 100, epoch: 3 | loss: 0.6928056
	speed: 0.1276s/iter; left time: 455.4963s
Epoch: 3 cost time: 7.864904165267944
Epoch: 3, Steps: 131 | Train Loss: 0.3772921 Vali Loss: 0.5938232 Test Loss: 0.4196636
	iters: 100, epoch: 4 | loss: 0.7063170
	speed: 0.1251s/iter; left time: 429.9339s
Epoch: 4 cost time: 7.462172031402588
Epoch: 4, Steps: 131 | Train Loss: 0.3722057 Vali Loss: 0.5815793 Test Loss: 0.4086964
	iters: 100, epoch: 5 | loss: 0.7145866
	speed: 0.1255s/iter; left time: 414.9069s
Epoch: 5 cost time: 7.468443393707275
Epoch: 5, Steps: 131 | Train Loss: 0.3676497 Vali Loss: 0.5772504 Test Loss: 0.4067614
	iters: 100, epoch: 6 | loss: 0.7219025
	speed: 0.1238s/iter; left time: 393.2501s
Epoch: 6 cost time: 7.426504373550415
Epoch: 6, Steps: 131 | Train Loss: 0.3628253 Vali Loss: 0.5747976 Test Loss: 0.4065627
	iters: 100, epoch: 7 | loss: 0.7312789
	speed: 0.1245s/iter; left time: 379.2366s
Epoch: 7 cost time: 7.47049617767334
Epoch: 7, Steps: 131 | Train Loss: 0.3581325 Vali Loss: 0.5722011 Test Loss: 0.4055695
	iters: 100, epoch: 8 | loss: 0.7411531
	speed: 0.1281s/iter; left time: 373.2082s
Epoch: 8 cost time: 7.818707466125488
Epoch: 8, Steps: 131 | Train Loss: 0.3538320 Vali Loss: 0.5693892 Test Loss: 0.4039752
	iters: 100, epoch: 9 | loss: 0.7486003
	speed: 0.1240s/iter; left time: 345.2083s
Epoch: 9 cost time: 7.452483415603638
Epoch: 9, Steps: 131 | Train Loss: 0.3498652 Vali Loss: 0.5666919 Test Loss: 0.4024521
	iters: 100, epoch: 10 | loss: 0.7528217
	speed: 0.1256s/iter; left time: 333.0917s
Epoch: 10 cost time: 7.560466527938843
Epoch: 10, Steps: 131 | Train Loss: 0.3463742 Vali Loss: 0.5640540 Test Loss: 0.4010330
	iters: 100, epoch: 11 | loss: 0.7549791
	speed: 0.1254s/iter; left time: 316.0963s
Epoch: 11 cost time: 7.596000671386719
Epoch: 11, Steps: 131 | Train Loss: 0.3435080 Vali Loss: 0.5612479 Test Loss: 0.3992905
	iters: 100, epoch: 12 | loss: 0.7558857
	speed: 0.1245s/iter; left time: 297.4369s
Epoch: 12 cost time: 7.498577356338501
Epoch: 12, Steps: 131 | Train Loss: 0.3412834 Vali Loss: 0.5584174 Test Loss: 0.3972168
	iters: 100, epoch: 13 | loss: 0.7558994
	speed: 0.1241s/iter; left time: 280.3838s
Epoch: 13 cost time: 7.426928758621216
Epoch: 13, Steps: 131 | Train Loss: 0.3396346 Vali Loss: 0.5558534 Test Loss: 0.3951131
	iters: 100, epoch: 14 | loss: 0.7553411
	speed: 0.1280s/iter; left time: 272.4005s
Epoch: 14 cost time: 7.9971699714660645
Epoch: 14, Steps: 131 | Train Loss: 0.3384475 Vali Loss: 0.5536694 Test Loss: 0.3931693
	iters: 100, epoch: 15 | loss: 0.7545297
	speed: 0.1264s/iter; left time: 252.5103s
Epoch: 15 cost time: 7.637725353240967
Epoch: 15, Steps: 131 | Train Loss: 0.3375926 Vali Loss: 0.5518069 Test Loss: 0.3913924
	iters: 100, epoch: 16 | loss: 0.7536784
	speed: 0.1249s/iter; left time: 232.9960s
Epoch: 16 cost time: 7.582202911376953
Epoch: 16, Steps: 131 | Train Loss: 0.3369563 Vali Loss: 0.5501651 Test Loss: 0.3897213
	iters: 100, epoch: 17 | loss: 0.7528846
	speed: 0.1277s/iter; left time: 221.5847s
Epoch: 17 cost time: 7.74521017074585
Epoch: 17, Steps: 131 | Train Loss: 0.3364587 Vali Loss: 0.5486728 Test Loss: 0.3881118
	iters: 100, epoch: 18 | loss: 0.7521800
	speed: 0.1259s/iter; left time: 201.8733s
Epoch: 18 cost time: 7.548517227172852
Epoch: 18, Steps: 131 | Train Loss: 0.3360530 Vali Loss: 0.5472978 Test Loss: 0.3865531
	iters: 100, epoch: 19 | loss: 0.7515689
	speed: 0.1250s/iter; left time: 184.0872s
Epoch: 19 cost time: 7.66650652885437
Epoch: 19, Steps: 131 | Train Loss: 0.3357148 Vali Loss: 0.5460328 Test Loss: 0.3850565
	iters: 100, epoch: 20 | loss: 0.7510464
	speed: 0.1253s/iter; left time: 168.1021s
Epoch: 20 cost time: 7.689372777938843
Epoch: 20, Steps: 131 | Train Loss: 0.3354317 Vali Loss: 0.5448803 Test Loss: 0.3836408
	iters: 100, epoch: 21 | loss: 0.7506037
	speed: 0.1263s/iter; left time: 152.9893s
Epoch: 21 cost time: 7.644801616668701
Epoch: 21, Steps: 131 | Train Loss: 0.3351966 Vali Loss: 0.5438433 Test Loss: 0.3823235
	iters: 100, epoch: 22 | loss: 0.7502310
	speed: 0.1255s/iter; left time: 135.5587s
Epoch: 22 cost time: 7.558793544769287
Epoch: 22, Steps: 131 | Train Loss: 0.3350042 Vali Loss: 0.5429215 Test Loss: 0.3811166
	iters: 100, epoch: 23 | loss: 0.7499188
	speed: 0.1248s/iter; left time: 118.4255s
Epoch: 23 cost time: 7.650249719619751
Epoch: 23, Steps: 131 | Train Loss: 0.3348494 Vali Loss: 0.5421104 Test Loss: 0.3800249
	iters: 100, epoch: 24 | loss: 0.7496589
	speed: 0.1281s/iter; left time: 104.7945s
Epoch: 24 cost time: 7.746341705322266
Epoch: 24, Steps: 131 | Train Loss: 0.3347269 Vali Loss: 0.5414021 Test Loss: 0.3790470
	iters: 100, epoch: 25 | loss: 0.7494434
	speed: 0.1259s/iter; left time: 86.4923s
Epoch: 25 cost time: 7.6593177318573
Epoch: 25, Steps: 131 | Train Loss: 0.3346322 Vali Loss: 0.5407864 Test Loss: 0.3781775
	iters: 100, epoch: 26 | loss: 0.7492665
	speed: 0.1260s/iter; left time: 70.0428s
Epoch: 26 cost time: 7.745326280593872
Epoch: 26, Steps: 131 | Train Loss: 0.3345605 Vali Loss: 0.5402529 Test Loss: 0.3774082
	iters: 100, epoch: 27 | loss: 0.7491223
	speed: 0.1272s/iter; left time: 54.0678s
Epoch: 27 cost time: 7.6579909324646
Epoch: 27, Steps: 131 | Train Loss: 0.3345076 Vali Loss: 0.5397909 Test Loss: 0.3767292
	iters: 100, epoch: 28 | loss: 0.7490063
	speed: 0.1263s/iter; left time: 37.1253s
Epoch: 28 cost time: 7.529079437255859
Epoch: 28, Steps: 131 | Train Loss: 0.3344698 Vali Loss: 0.5393903 Test Loss: 0.3761307
	iters: 100, epoch: 29 | loss: 0.7489141
	speed: 0.1277s/iter; left time: 20.8144s
Epoch: 29 cost time: 7.682058334350586
Epoch: 29, Steps: 131 | Train Loss: 0.3344441 Vali Loss: 0.5390425 Test Loss: 0.3756028
	iters: 100, epoch: 30 | loss: 0.7488416
	speed: 0.1278s/iter; left time: 4.0894s
Epoch: 30 cost time: 7.689608097076416
Epoch: 30, Steps: 131 | Train Loss: 0.3344277 Vali Loss: 0.5387400 Test Loss: 0.3751369
>>>>>>>testing : ETTm1_720_192_SparseTSF_ETTm1_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3731345236301422, mae:0.3888683617115021, rse:0.5814792513847351
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_336', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_336_SparseTSF_ETTm1_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6717774
	speed: 0.1431s/iter; left time: 544.0721s
Epoch: 1 cost time: 9.408827066421509
Epoch: 1, Steps: 130 | Train Loss: 0.4262187 Vali Loss: 0.7685916 Test Loss: 0.4759889
	iters: 100, epoch: 2 | loss: 0.6514256
	speed: 0.1475s/iter; left time: 541.3331s
Epoch: 2 cost time: 8.771411895751953
Epoch: 2, Steps: 130 | Train Loss: 0.4254991 Vali Loss: 0.7529225 Test Loss: 0.4544335
	iters: 100, epoch: 3 | loss: 0.6464080
	speed: 0.1432s/iter; left time: 507.1403s
Epoch: 3 cost time: 8.518457412719727
Epoch: 3, Steps: 130 | Train Loss: 0.4199991 Vali Loss: 0.7450031 Test Loss: 0.4511883
	iters: 100, epoch: 4 | loss: 0.7010748
	speed: 0.1460s/iter; left time: 498.0005s
Epoch: 4 cost time: 8.654850006103516
Epoch: 4, Steps: 130 | Train Loss: 0.4108081 Vali Loss: 0.7252011 Test Loss: 0.4217017
	iters: 100, epoch: 5 | loss: 0.6995788
	speed: 0.1404s/iter; left time: 460.6415s
Epoch: 5 cost time: 8.486013412475586
Epoch: 5, Steps: 130 | Train Loss: 0.4037482 Vali Loss: 0.7335302 Test Loss: 0.4337198
	iters: 100, epoch: 6 | loss: 0.7000015
	speed: 0.1426s/iter; left time: 449.2737s
Epoch: 6 cost time: 8.544670581817627
Epoch: 6, Steps: 130 | Train Loss: 0.3971407 Vali Loss: 0.7538179 Test Loss: 0.4559040
	iters: 100, epoch: 7 | loss: 0.7015833
	speed: 0.1392s/iter; left time: 420.6170s
Epoch: 7 cost time: 8.40603232383728
Epoch: 7, Steps: 130 | Train Loss: 0.3918643 Vali Loss: 0.7762407 Test Loss: 0.4805180
	iters: 100, epoch: 8 | loss: 0.7041893
	speed: 0.1427s/iter; left time: 412.5779s
Epoch: 8 cost time: 8.589848756790161
Epoch: 8, Steps: 130 | Train Loss: 0.3875773 Vali Loss: 0.7824349 Test Loss: 0.4899806
	iters: 100, epoch: 9 | loss: 0.7044117
	speed: 0.1425s/iter; left time: 393.5749s
Epoch: 9 cost time: 8.55831003189087
Epoch: 9, Steps: 130 | Train Loss: 0.3840614 Vali Loss: 0.7764460 Test Loss: 0.4863615
	iters: 100, epoch: 10 | loss: 0.7035899
	speed: 0.1375s/iter; left time: 361.6914s
Epoch: 10 cost time: 8.14798903465271
Epoch: 10, Steps: 130 | Train Loss: 0.3813117 Vali Loss: 0.7651671 Test Loss: 0.4744554
	iters: 100, epoch: 11 | loss: 0.7072842
	speed: 0.1376s/iter; left time: 344.1752s
Epoch: 11 cost time: 8.41289210319519
Epoch: 11, Steps: 130 | Train Loss: 0.3799337 Vali Loss: 0.7472568 Test Loss: 0.4520243
	iters: 100, epoch: 12 | loss: 0.7203182
	speed: 0.1424s/iter; left time: 337.6124s
Epoch: 12 cost time: 8.552002668380737
Epoch: 12, Steps: 130 | Train Loss: 0.3807364 Vali Loss: 0.7230781 Test Loss: 0.4226884
	iters: 100, epoch: 13 | loss: 0.7301295
	speed: 0.1400s/iter; left time: 313.7986s
Epoch: 13 cost time: 8.539908409118652
Epoch: 13, Steps: 130 | Train Loss: 0.3817154 Vali Loss: 0.7113189 Test Loss: 0.4092750
	iters: 100, epoch: 14 | loss: 0.7364486
	speed: 0.1424s/iter; left time: 300.5186s
Epoch: 14 cost time: 8.833179235458374
Epoch: 14, Steps: 130 | Train Loss: 0.3821273 Vali Loss: 0.7061077 Test Loss: 0.4036618
	iters: 100, epoch: 15 | loss: 0.7402465
	speed: 0.1443s/iter; left time: 285.7716s
Epoch: 15 cost time: 8.554077863693237
Epoch: 15, Steps: 130 | Train Loss: 0.3822026 Vali Loss: 0.7032321 Test Loss: 0.4010377
	iters: 100, epoch: 16 | loss: 0.7421021
	speed: 0.1427s/iter; left time: 264.1200s
Epoch: 16 cost time: 8.639729499816895
Epoch: 16, Steps: 130 | Train Loss: 0.3820529 Vali Loss: 0.7014215 Test Loss: 0.3999746
	iters: 100, epoch: 17 | loss: 0.7429212
	speed: 0.1407s/iter; left time: 242.2018s
Epoch: 17 cost time: 8.534668684005737
Epoch: 17, Steps: 130 | Train Loss: 0.3818078 Vali Loss: 0.7001233 Test Loss: 0.3997147
	iters: 100, epoch: 18 | loss: 0.7432091
	speed: 0.1405s/iter; left time: 223.4778s
Epoch: 18 cost time: 8.387738704681396
Epoch: 18, Steps: 130 | Train Loss: 0.3815377 Vali Loss: 0.6991213 Test Loss: 0.3999838
	iters: 100, epoch: 19 | loss: 0.7431553
	speed: 0.1421s/iter; left time: 207.6675s
Epoch: 19 cost time: 8.657841205596924
Epoch: 19, Steps: 130 | Train Loss: 0.3812590 Vali Loss: 0.6983569 Test Loss: 0.4007616
	iters: 100, epoch: 20 | loss: 0.7427698
	speed: 0.1422s/iter; left time: 189.3164s
Epoch: 20 cost time: 8.753706216812134
Epoch: 20, Steps: 130 | Train Loss: 0.3809582 Vali Loss: 0.6978725 Test Loss: 0.4021586
	iters: 100, epoch: 21 | loss: 0.7419689
	speed: 0.1442s/iter; left time: 173.1828s
Epoch: 21 cost time: 8.51268458366394
Epoch: 21, Steps: 130 | Train Loss: 0.3806075 Vali Loss: 0.6978038 Test Loss: 0.4043576
	iters: 100, epoch: 22 | loss: 0.7406126
	speed: 0.1418s/iter; left time: 151.9115s
Epoch: 22 cost time: 8.639275312423706
Epoch: 22, Steps: 130 | Train Loss: 0.3801712 Vali Loss: 0.6984121 Test Loss: 0.4076081
	iters: 100, epoch: 23 | loss: 0.7385371
	speed: 0.1378s/iter; left time: 129.6521s
Epoch: 23 cost time: 8.351697206497192
Epoch: 23, Steps: 130 | Train Loss: 0.3796114 Vali Loss: 0.7001547 Test Loss: 0.4122721
	iters: 100, epoch: 24 | loss: 0.7356025
	speed: 0.1478s/iter; left time: 119.8543s
Epoch: 24 cost time: 8.797087907791138
Epoch: 24, Steps: 130 | Train Loss: 0.3788937 Vali Loss: 0.7037906 Test Loss: 0.4189457
	iters: 100, epoch: 25 | loss: 0.7317810
	speed: 0.1412s/iter; left time: 96.1608s
Epoch: 25 cost time: 8.30905556678772
Epoch: 25, Steps: 130 | Train Loss: 0.3779964 Vali Loss: 0.7103959 Test Loss: 0.4285320
	iters: 100, epoch: 26 | loss: 0.7272766
	speed: 0.1421s/iter; left time: 78.2717s
Epoch: 26 cost time: 8.764921188354492
Epoch: 26, Steps: 130 | Train Loss: 0.3769188 Vali Loss: 0.7207829 Test Loss: 0.4416962
	iters: 100, epoch: 27 | loss: 0.7226390
	speed: 0.1393s/iter; left time: 58.6402s
Epoch: 27 cost time: 8.360797643661499
Epoch: 27, Steps: 130 | Train Loss: 0.3756971 Vali Loss: 0.7338068 Test Loss: 0.4571401
	iters: 100, epoch: 28 | loss: 0.7187899
	speed: 0.1400s/iter; left time: 40.7395s
Epoch: 28 cost time: 8.344966411590576
Epoch: 28, Steps: 130 | Train Loss: 0.3744548 Vali Loss: 0.7451742 Test Loss: 0.4703830
	iters: 100, epoch: 29 | loss: 0.7167246
	speed: 0.1422s/iter; left time: 22.9021s
Epoch: 29 cost time: 8.489984035491943
Epoch: 29, Steps: 130 | Train Loss: 0.3734540 Vali Loss: 0.7502728 Test Loss: 0.4763369
	iters: 100, epoch: 30 | loss: 0.7168431
	speed: 0.1437s/iter; left time: 4.4538s
Epoch: 30 cost time: 8.876069068908691
Epoch: 30, Steps: 130 | Train Loss: 0.3730144 Vali Loss: 0.7485579 Test Loss: 0.4726970
>>>>>>>testing : ETTm1_720_336_SparseTSF_ETTm1_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4720191955566406, mae:0.4486290514469147, rse:0.6537747979164124
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_720', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_720_SparseTSF_ETTm1_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5463569
	speed: 0.1944s/iter; left time: 733.0373s
Epoch: 1 cost time: 13.312297582626343
Epoch: 1, Steps: 129 | Train Loss: 0.5085519 Vali Loss: 1.0618079 Test Loss: 0.5323495
	iters: 100, epoch: 2 | loss: 0.5295401
	speed: 0.1893s/iter; left time: 689.3411s
Epoch: 2 cost time: 11.196028232574463
Epoch: 2, Steps: 129 | Train Loss: 0.4832660 Vali Loss: 1.1046532 Test Loss: 0.5679604
	iters: 100, epoch: 3 | loss: 0.5356770
	speed: 0.1853s/iter; left time: 650.9143s
Epoch: 3 cost time: 11.185685157775879
Epoch: 3, Steps: 129 | Train Loss: 0.4733475 Vali Loss: 1.0655674 Test Loss: 0.5267869
	iters: 100, epoch: 4 | loss: 0.5636365
	speed: 0.1837s/iter; left time: 621.7220s
Epoch: 4 cost time: 11.209538459777832
Epoch: 4, Steps: 129 | Train Loss: 0.4629795 Vali Loss: 1.0511210 Test Loss: 0.5058512
	iters: 100, epoch: 5 | loss: 0.5702854
	speed: 0.1845s/iter; left time: 600.4147s
Epoch: 5 cost time: 11.156233787536621
Epoch: 5, Steps: 129 | Train Loss: 0.4540794 Vali Loss: 1.0627261 Test Loss: 0.5087966
	iters: 100, epoch: 6 | loss: 0.5413927
	speed: 0.1868s/iter; left time: 583.8454s
Epoch: 6 cost time: 11.490910768508911
Epoch: 6, Steps: 129 | Train Loss: 0.4454469 Vali Loss: 1.0555925 Test Loss: 0.4990080
	iters: 100, epoch: 7 | loss: 0.5153200
	speed: 0.1860s/iter; left time: 557.3945s
Epoch: 7 cost time: 11.040134906768799
Epoch: 7, Steps: 129 | Train Loss: 0.4416209 Vali Loss: 1.0810273 Test Loss: 0.5107294
	iters: 100, epoch: 8 | loss: 0.5355574
	speed: 0.1861s/iter; left time: 533.5940s
Epoch: 8 cost time: 11.240644454956055
Epoch: 8, Steps: 129 | Train Loss: 0.4395359 Vali Loss: 1.0583651 Test Loss: 0.4801863
	iters: 100, epoch: 9 | loss: 0.5277093
	speed: 0.1839s/iter; left time: 503.7474s
Epoch: 9 cost time: 11.007778406143188
Epoch: 9, Steps: 129 | Train Loss: 0.4356786 Vali Loss: 1.0672294 Test Loss: 0.4925307
	iters: 100, epoch: 10 | loss: 0.5218078
	speed: 0.1901s/iter; left time: 496.2159s
Epoch: 10 cost time: 11.295305252075195
Epoch: 10, Steps: 129 | Train Loss: 0.4340470 Vali Loss: 1.0728878 Test Loss: 0.4992127
	iters: 100, epoch: 11 | loss: 0.5203466
	speed: 0.1883s/iter; left time: 467.2089s
Epoch: 11 cost time: 11.456807851791382
Epoch: 11, Steps: 129 | Train Loss: 0.4326373 Vali Loss: 1.0722538 Test Loss: 0.4996837
	iters: 100, epoch: 12 | loss: 0.5193886
	speed: 0.1871s/iter; left time: 440.0402s
Epoch: 12 cost time: 11.269721031188965
Epoch: 12, Steps: 129 | Train Loss: 0.4318130 Vali Loss: 1.0713552 Test Loss: 0.4993753
	iters: 100, epoch: 13 | loss: 0.5191308
	speed: 0.1922s/iter; left time: 427.2754s
Epoch: 13 cost time: 11.56057357788086
Epoch: 13, Steps: 129 | Train Loss: 0.4312647 Vali Loss: 1.0698041 Test Loss: 0.4980915
	iters: 100, epoch: 14 | loss: 0.5191998
	speed: 0.1829s/iter; left time: 383.0910s
Epoch: 14 cost time: 11.094480991363525
Epoch: 14, Steps: 129 | Train Loss: 0.4308961 Vali Loss: 1.0682024 Test Loss: 0.4965047
	iters: 100, epoch: 15 | loss: 0.5195298
	speed: 0.1851s/iter; left time: 363.6443s
Epoch: 15 cost time: 11.32283353805542
Epoch: 15, Steps: 129 | Train Loss: 0.4306309 Vali Loss: 1.0665720 Test Loss: 0.4947078
	iters: 100, epoch: 16 | loss: 0.5200102
	speed: 0.1835s/iter; left time: 336.8944s
Epoch: 16 cost time: 10.978798627853394
Epoch: 16, Steps: 129 | Train Loss: 0.4304345 Vali Loss: 1.0650072 Test Loss: 0.4928423
	iters: 100, epoch: 17 | loss: 0.5205904
	speed: 0.1840s/iter; left time: 314.0718s
Epoch: 17 cost time: 11.136293411254883
Epoch: 17, Steps: 129 | Train Loss: 0.4302861 Vali Loss: 1.0635160 Test Loss: 0.4909540
	iters: 100, epoch: 18 | loss: 0.5212356
	speed: 0.1879s/iter; left time: 296.4753s
Epoch: 18 cost time: 11.522416114807129
Epoch: 18, Steps: 129 | Train Loss: 0.4301739 Vali Loss: 1.0621003 Test Loss: 0.4890759
	iters: 100, epoch: 19 | loss: 0.5219246
	speed: 0.1862s/iter; left time: 269.7732s
Epoch: 19 cost time: 11.008280038833618
Epoch: 19, Steps: 129 | Train Loss: 0.4300902 Vali Loss: 1.0607531 Test Loss: 0.4872282
	iters: 100, epoch: 20 | loss: 0.5226424
	speed: 0.1851s/iter; left time: 244.2747s
Epoch: 20 cost time: 11.540335893630981
Epoch: 20, Steps: 129 | Train Loss: 0.4300295 Vali Loss: 1.0594677 Test Loss: 0.4854253
	iters: 100, epoch: 21 | loss: 0.5233768
	speed: 0.1884s/iter; left time: 224.3996s
Epoch: 21 cost time: 11.129558801651001
Epoch: 21, Steps: 129 | Train Loss: 0.4299872 Vali Loss: 1.0582367 Test Loss: 0.4836778
	iters: 100, epoch: 22 | loss: 0.5241181
	speed: 0.1852s/iter; left time: 196.6815s
Epoch: 22 cost time: 11.077264547348022
Epoch: 22, Steps: 129 | Train Loss: 0.4299601 Vali Loss: 1.0570560 Test Loss: 0.4819939
	iters: 100, epoch: 23 | loss: 0.5248583
	speed: 0.1875s/iter; left time: 174.9838s
Epoch: 23 cost time: 11.505337715148926
Epoch: 23, Steps: 129 | Train Loss: 0.4299448 Vali Loss: 1.0559205 Test Loss: 0.4803778
	iters: 100, epoch: 24 | loss: 0.5255919
	speed: 0.1852s/iter; left time: 148.9389s
Epoch: 24 cost time: 11.26286005973816
Epoch: 24, Steps: 129 | Train Loss: 0.4299388 Vali Loss: 1.0548280 Test Loss: 0.4788323
	iters: 100, epoch: 25 | loss: 0.5263140
	speed: 0.1897s/iter; left time: 128.0413s
Epoch: 25 cost time: 11.546411275863647
Epoch: 25, Steps: 129 | Train Loss: 0.4299402 Vali Loss: 1.0537766 Test Loss: 0.4773568
	iters: 100, epoch: 26 | loss: 0.5270247
	speed: 0.1861s/iter; left time: 101.6165s
Epoch: 26 cost time: 11.265510082244873
Epoch: 26, Steps: 129 | Train Loss: 0.4299473 Vali Loss: 1.0527623 Test Loss: 0.4759478
	iters: 100, epoch: 27 | loss: 0.5277209
	speed: 0.2001s/iter; left time: 83.4394s
Epoch: 27 cost time: 12.31977367401123
Epoch: 27, Steps: 129 | Train Loss: 0.4299589 Vali Loss: 1.0517855 Test Loss: 0.4746040
	iters: 100, epoch: 28 | loss: 0.5284045
	speed: 0.1838s/iter; left time: 52.9348s
Epoch: 28 cost time: 11.37116026878357
Epoch: 28, Steps: 129 | Train Loss: 0.4299743 Vali Loss: 1.0508442 Test Loss: 0.4733208
	iters: 100, epoch: 29 | loss: 0.5290753
	speed: 0.1846s/iter; left time: 29.3469s
Epoch: 29 cost time: 11.01066541671753
Epoch: 29, Steps: 129 | Train Loss: 0.4299927 Vali Loss: 1.0499367 Test Loss: 0.4720941
	iters: 100, epoch: 30 | loss: 0.5297347
	speed: 0.1860s/iter; left time: 5.5790s
Epoch: 30 cost time: 11.300228834152222
Epoch: 30, Steps: 129 | Train Loss: 0.4300138 Vali Loss: 1.0490631 Test Loss: 0.4709212
>>>>>>>testing : ETTm1_720_720_SparseTSF_ETTm1_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4664352536201477, mae:0.4461958110332489, rse:0.6497801542282104
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_96', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_96_SparseTSF_ETTm2_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1078935
	speed: 0.1183s/iter; left time: 453.2293s
Epoch: 1 cost time: 7.876664161682129
Epoch: 1, Steps: 131 | Train Loss: 0.3380517 Vali Loss: 0.2719788 Test Loss: 0.3310323
	iters: 100, epoch: 2 | loss: 0.1165895
	speed: 0.1191s/iter; left time: 440.8065s
Epoch: 2 cost time: 6.690350294113159
Epoch: 2, Steps: 131 | Train Loss: 0.3248064 Vali Loss: 0.2058311 Test Loss: 0.2663886
	iters: 100, epoch: 3 | loss: 0.1108922
	speed: 0.1135s/iter; left time: 405.1922s
Epoch: 3 cost time: 7.002402067184448
Epoch: 3, Steps: 131 | Train Loss: 0.3953692 Vali Loss: 0.3316383 Test Loss: 0.4132190
	iters: 100, epoch: 4 | loss: 0.1065289
	speed: 0.1165s/iter; left time: 400.4079s
Epoch: 4 cost time: 7.008610010147095
Epoch: 4, Steps: 131 | Train Loss: 0.3948982 Vali Loss: 0.2234726 Test Loss: 0.2794976
	iters: 100, epoch: 5 | loss: 0.1308986
	speed: 0.1129s/iter; left time: 373.2741s
Epoch: 5 cost time: 6.9611499309539795
Epoch: 5, Steps: 131 | Train Loss: 0.2964115 Vali Loss: 0.1688042 Test Loss: 0.2245594
	iters: 100, epoch: 6 | loss: 0.0990347
	speed: 0.1171s/iter; left time: 371.8086s
Epoch: 6 cost time: 7.142174005508423
Epoch: 6, Steps: 131 | Train Loss: 0.3725005 Vali Loss: 0.2737576 Test Loss: 0.3809032
	iters: 100, epoch: 7 | loss: 0.1183566
	speed: 0.1170s/iter; left time: 356.2554s
Epoch: 7 cost time: 7.059229135513306
Epoch: 7, Steps: 131 | Train Loss: 0.2849820 Vali Loss: 0.1652407 Test Loss: 0.2190036
	iters: 100, epoch: 8 | loss: 0.0930312
	speed: 0.1158s/iter; left time: 337.5131s
Epoch: 8 cost time: 7.016330003738403
Epoch: 8, Steps: 131 | Train Loss: 0.3541252 Vali Loss: 0.2830016 Test Loss: 0.3813610
	iters: 100, epoch: 9 | loss: 0.1131978
	speed: 0.1170s/iter; left time: 325.6697s
Epoch: 9 cost time: 7.100996971130371
Epoch: 9, Steps: 131 | Train Loss: 0.2772928 Vali Loss: 0.1558269 Test Loss: 0.2087258
	iters: 100, epoch: 10 | loss: 0.0965403
	speed: 0.1169s/iter; left time: 310.1452s
Epoch: 10 cost time: 7.163604259490967
Epoch: 10, Steps: 131 | Train Loss: 0.2986852 Vali Loss: 0.2238291 Test Loss: 0.2964496
	iters: 100, epoch: 11 | loss: 0.1101421
	speed: 0.1172s/iter; left time: 295.3606s
Epoch: 11 cost time: 6.9110496044158936
Epoch: 11, Steps: 131 | Train Loss: 0.2676201 Vali Loss: 0.1661663 Test Loss: 0.2166609
	iters: 100, epoch: 12 | loss: 0.1085759
	speed: 0.1124s/iter; left time: 268.5674s
Epoch: 12 cost time: 6.85557222366333
Epoch: 12, Steps: 131 | Train Loss: 0.2670014 Vali Loss: 0.1870146 Test Loss: 0.2419145
	iters: 100, epoch: 13 | loss: 0.1068927
	speed: 0.1151s/iter; left time: 259.9089s
Epoch: 13 cost time: 6.96825909614563
Epoch: 13, Steps: 131 | Train Loss: 0.2625741 Vali Loss: 0.1849369 Test Loss: 0.2391517
	iters: 100, epoch: 14 | loss: 0.1052198
	speed: 0.1158s/iter; left time: 246.4753s
Epoch: 14 cost time: 6.928132772445679
Epoch: 14, Steps: 131 | Train Loss: 0.2617016 Vali Loss: 0.1899082 Test Loss: 0.2458992
	iters: 100, epoch: 15 | loss: 0.1031085
	speed: 0.1149s/iter; left time: 229.3702s
Epoch: 15 cost time: 6.915614366531372
Epoch: 15, Steps: 131 | Train Loss: 0.2615784 Vali Loss: 0.1904082 Test Loss: 0.2470779
	iters: 100, epoch: 16 | loss: 0.1015098
	speed: 0.1180s/iter; left time: 220.2530s
Epoch: 16 cost time: 7.253018140792847
Epoch: 16, Steps: 131 | Train Loss: 0.2607218 Vali Loss: 0.1874025 Test Loss: 0.2440113
	iters: 100, epoch: 17 | loss: 0.0991476
	speed: 0.1187s/iter; left time: 205.9146s
Epoch: 17 cost time: 7.21695351600647
Epoch: 17, Steps: 131 | Train Loss: 0.2574148 Vali Loss: 0.1802495 Test Loss: 0.2354349
	iters: 100, epoch: 18 | loss: 0.0948829
	speed: 0.1130s/iter; left time: 181.2814s
Epoch: 18 cost time: 6.775334119796753
Epoch: 18, Steps: 131 | Train Loss: 0.2502293 Vali Loss: 0.1672005 Test Loss: 0.2195741
	iters: 100, epoch: 19 | loss: 0.0884482
	speed: 0.1174s/iter; left time: 172.9401s
Epoch: 19 cost time: 6.921847820281982
Epoch: 19, Steps: 131 | Train Loss: 0.2369069 Vali Loss: 0.1470534 Test Loss: 0.1954250
	iters: 100, epoch: 20 | loss: 0.0873178
	speed: 0.1153s/iter; left time: 154.7969s
Epoch: 20 cost time: 6.796378135681152
Epoch: 20, Steps: 131 | Train Loss: 0.2332669 Vali Loss: 0.1433323 Test Loss: 0.1913050
	iters: 100, epoch: 21 | loss: 0.0889122
	speed: 0.1153s/iter; left time: 139.6468s
Epoch: 21 cost time: 7.115406036376953
Epoch: 21, Steps: 131 | Train Loss: 0.2324222 Vali Loss: 0.1395368 Test Loss: 0.1871808
	iters: 100, epoch: 22 | loss: 0.0913437
	speed: 0.1171s/iter; left time: 126.4178s
Epoch: 22 cost time: 6.938881158828735
Epoch: 22, Steps: 131 | Train Loss: 0.2317895 Vali Loss: 0.1362990 Test Loss: 0.1833600
	iters: 100, epoch: 23 | loss: 0.0935578
	speed: 0.1152s/iter; left time: 109.3382s
Epoch: 23 cost time: 6.975580453872681
Epoch: 23, Steps: 131 | Train Loss: 0.2321404 Vali Loss: 0.1350161 Test Loss: 0.1818215
	iters: 100, epoch: 24 | loss: 0.0937819
	speed: 0.1145s/iter; left time: 93.6370s
Epoch: 24 cost time: 6.872331857681274
Epoch: 24, Steps: 131 | Train Loss: 0.2333767 Vali Loss: 0.1343410 Test Loss: 0.1811804
	iters: 100, epoch: 25 | loss: 0.0931193
	speed: 0.1107s/iter; left time: 76.0638s
Epoch: 25 cost time: 6.6500842571258545
Epoch: 25, Steps: 131 | Train Loss: 0.2342754 Vali Loss: 0.1338676 Test Loss: 0.1807891
	iters: 100, epoch: 26 | loss: 0.0923578
	speed: 0.1145s/iter; left time: 63.6810s
Epoch: 26 cost time: 6.965977668762207
Epoch: 26, Steps: 131 | Train Loss: 0.2348550 Vali Loss: 0.1338057 Test Loss: 0.1808186
	iters: 100, epoch: 27 | loss: 0.0914751
	speed: 0.1156s/iter; left time: 49.1183s
Epoch: 27 cost time: 7.052880525588989
Epoch: 27, Steps: 131 | Train Loss: 0.2350454 Vali Loss: 0.1342947 Test Loss: 0.1814113
	iters: 100, epoch: 28 | loss: 0.0900962
	speed: 0.1153s/iter; left time: 33.9096s
Epoch: 28 cost time: 6.8975279331207275
Epoch: 28, Steps: 131 | Train Loss: 0.2344101 Vali Loss: 0.1358314 Test Loss: 0.1830916
	iters: 100, epoch: 29 | loss: 0.0877897
	speed: 0.1136s/iter; left time: 18.5246s
Epoch: 29 cost time: 6.908265829086304
Epoch: 29, Steps: 131 | Train Loss: 0.2325559 Vali Loss: 0.1399165 Test Loss: 0.1873799
	iters: 100, epoch: 30 | loss: 0.0868731
	speed: 0.1135s/iter; left time: 3.6318s
Epoch: 30 cost time: 7.1004319190979
Epoch: 30, Steps: 131 | Train Loss: 0.2316706 Vali Loss: 0.1428453 Test Loss: 0.1905758
>>>>>>>testing : ETTm2_720_96_SparseTSF_ETTm2_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.19141492247581482, mae:0.2847227454185486, rse:0.3547186851501465
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_192', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_192_SparseTSF_ETTm2_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.1240907
	speed: 0.1285s/iter; left time: 492.3991s
Epoch: 1 cost time: 8.523776054382324
Epoch: 1, Steps: 131 | Train Loss: 0.4253787 Vali Loss: 0.3606178 Test Loss: 0.4367266
	iters: 100, epoch: 2 | loss: 0.1364021
	speed: 0.1295s/iter; left time: 479.0394s
Epoch: 2 cost time: 7.561656951904297
Epoch: 2, Steps: 131 | Train Loss: 0.4381148 Vali Loss: 0.4861443 Test Loss: 0.6797135
	iters: 100, epoch: 3 | loss: 0.1047916
	speed: 0.1297s/iter; left time: 462.9891s
Epoch: 3 cost time: 7.870462894439697
Epoch: 3, Steps: 131 | Train Loss: 0.4468356 Vali Loss: 0.2684212 Test Loss: 0.3406225
	iters: 100, epoch: 4 | loss: 0.1279166
	speed: 0.1258s/iter; left time: 432.3479s
Epoch: 4 cost time: 7.628723621368408
Epoch: 4, Steps: 131 | Train Loss: 0.3853023 Vali Loss: 0.2878738 Test Loss: 0.3656345
	iters: 100, epoch: 5 | loss: 0.1302428
	speed: 0.1245s/iter; left time: 411.8078s
Epoch: 5 cost time: 7.515175819396973
Epoch: 5, Steps: 131 | Train Loss: 0.3898027 Vali Loss: 0.2596301 Test Loss: 0.3237689
	iters: 100, epoch: 6 | loss: 0.1132131
	speed: 0.1255s/iter; left time: 398.6824s
Epoch: 6 cost time: 7.772836208343506
Epoch: 6, Steps: 131 | Train Loss: 0.4440447 Vali Loss: 0.4520416 Test Loss: 0.6829713
	iters: 100, epoch: 7 | loss: 0.1262609
	speed: 0.1258s/iter; left time: 383.0683s
Epoch: 7 cost time: 7.646769285202026
Epoch: 7, Steps: 131 | Train Loss: 0.4484445 Vali Loss: 0.2221398 Test Loss: 0.2909834
	iters: 100, epoch: 8 | loss: 0.1204436
	speed: 0.1252s/iter; left time: 364.9320s
Epoch: 8 cost time: 7.559225082397461
Epoch: 8, Steps: 131 | Train Loss: 0.3922904 Vali Loss: 0.2873641 Test Loss: 0.3684590
	iters: 100, epoch: 9 | loss: 0.1280725
	speed: 0.1262s/iter; left time: 351.2451s
Epoch: 9 cost time: 7.506446361541748
Epoch: 9, Steps: 131 | Train Loss: 0.3850083 Vali Loss: 0.2357032 Test Loss: 0.2951406
	iters: 100, epoch: 10 | loss: 0.1248119
	speed: 0.1265s/iter; left time: 335.5506s
Epoch: 10 cost time: 7.722600936889648
Epoch: 10, Steps: 131 | Train Loss: 0.3619931 Vali Loss: 0.2435665 Test Loss: 0.3112894
	iters: 100, epoch: 11 | loss: 0.1156089
	speed: 0.1266s/iter; left time: 319.2369s
Epoch: 11 cost time: 7.5893542766571045
Epoch: 11, Steps: 131 | Train Loss: 0.3611595 Vali Loss: 0.1961454 Test Loss: 0.2531797
	iters: 100, epoch: 12 | loss: 0.1187515
	speed: 0.1256s/iter; left time: 300.1188s
Epoch: 12 cost time: 7.741919994354248
Epoch: 12, Steps: 131 | Train Loss: 0.3433917 Vali Loss: 0.2131128 Test Loss: 0.2731837
	iters: 100, epoch: 13 | loss: 0.1216739
	speed: 0.1269s/iter; left time: 286.6880s
Epoch: 13 cost time: 7.623172998428345
Epoch: 13, Steps: 131 | Train Loss: 0.3493089 Vali Loss: 0.1792514 Test Loss: 0.2358876
	iters: 100, epoch: 14 | loss: 0.1106228
	speed: 0.1259s/iter; left time: 267.9133s
Epoch: 14 cost time: 7.536194562911987
Epoch: 14, Steps: 131 | Train Loss: 0.3404174 Vali Loss: 0.1910028 Test Loss: 0.2489974
	iters: 100, epoch: 15 | loss: 0.1175827
	speed: 0.1250s/iter; left time: 249.5635s
Epoch: 15 cost time: 7.483298063278198
Epoch: 15, Steps: 131 | Train Loss: 0.3452524 Vali Loss: 0.1889290 Test Loss: 0.2489514
	iters: 100, epoch: 16 | loss: 0.1124880
	speed: 0.1257s/iter; left time: 234.5483s
Epoch: 16 cost time: 7.70489501953125
Epoch: 16, Steps: 131 | Train Loss: 0.3400890 Vali Loss: 0.2057358 Test Loss: 0.2679653
	iters: 100, epoch: 17 | loss: 0.1173735
	speed: 0.1254s/iter; left time: 217.6219s
Epoch: 17 cost time: 7.556927442550659
Epoch: 17, Steps: 131 | Train Loss: 0.3540452 Vali Loss: 0.1674508 Test Loss: 0.2260758
	iters: 100, epoch: 18 | loss: 0.1076966
	speed: 0.1275s/iter; left time: 204.5838s
Epoch: 18 cost time: 7.683928966522217
Epoch: 18, Steps: 131 | Train Loss: 0.3361435 Vali Loss: 0.1872476 Test Loss: 0.2453093
	iters: 100, epoch: 19 | loss: 0.1315653
	speed: 0.1251s/iter; left time: 184.2188s
Epoch: 19 cost time: 7.784213304519653
Epoch: 19, Steps: 131 | Train Loss: 0.3377814 Vali Loss: 0.1832893 Test Loss: 0.2407523
	iters: 100, epoch: 20 | loss: 0.1203209
	speed: 0.1309s/iter; left time: 175.6477s
Epoch: 20 cost time: 7.549825429916382
Epoch: 20, Steps: 131 | Train Loss: 0.3483909 Vali Loss: 0.1737002 Test Loss: 0.2326016
	iters: 100, epoch: 21 | loss: 0.1095147
	speed: 0.1251s/iter; left time: 151.5025s
Epoch: 21 cost time: 7.544717788696289
Epoch: 21, Steps: 131 | Train Loss: 0.3599854 Vali Loss: 0.2230090 Test Loss: 0.2943109
	iters: 100, epoch: 22 | loss: 0.1084619
	speed: 0.1256s/iter; left time: 135.6788s
Epoch: 22 cost time: 7.544600486755371
Epoch: 22, Steps: 131 | Train Loss: 0.3526036 Vali Loss: 0.1834861 Test Loss: 0.2462584
	iters: 100, epoch: 23 | loss: 0.1104318
	speed: 0.1248s/iter; left time: 118.3959s
Epoch: 23 cost time: 7.601680040359497
Epoch: 23, Steps: 131 | Train Loss: 0.3458436 Vali Loss: 0.1853806 Test Loss: 0.2462930
	iters: 100, epoch: 24 | loss: 0.1102622
	speed: 0.1284s/iter; left time: 105.0275s
Epoch: 24 cost time: 7.762556076049805
Epoch: 24, Steps: 131 | Train Loss: 0.3460856 Vali Loss: 0.1830975 Test Loss: 0.2438668
	iters: 100, epoch: 25 | loss: 0.1106859
	speed: 0.1267s/iter; left time: 87.0670s
Epoch: 25 cost time: 7.701914310455322
Epoch: 25, Steps: 131 | Train Loss: 0.3475153 Vali Loss: 0.1832937 Test Loss: 0.2446840
	iters: 100, epoch: 26 | loss: 0.1117430
	speed: 0.1271s/iter; left time: 70.6478s
Epoch: 26 cost time: 7.673513650894165
Epoch: 26, Steps: 131 | Train Loss: 0.3475071 Vali Loss: 0.1829273 Test Loss: 0.2444553
	iters: 100, epoch: 27 | loss: 0.1114809
	speed: 0.1270s/iter; left time: 53.9766s
Epoch: 27 cost time: 7.838654279708862
Epoch: 27, Steps: 131 | Train Loss: 0.3474008 Vali Loss: 0.1834245 Test Loss: 0.2449447
	iters: 100, epoch: 28 | loss: 0.1113787
	speed: 0.1269s/iter; left time: 37.3066s
Epoch: 28 cost time: 7.538296937942505
Epoch: 28, Steps: 131 | Train Loss: 0.3468181 Vali Loss: 0.1835871 Test Loss: 0.2448878
	iters: 100, epoch: 29 | loss: 0.1111886
	speed: 0.1261s/iter; left time: 20.5595s
Epoch: 29 cost time: 7.52306866645813
Epoch: 29, Steps: 131 | Train Loss: 0.3466188 Vali Loss: 0.1840746 Test Loss: 0.2453394
	iters: 100, epoch: 30 | loss: 0.1111201
	speed: 0.1258s/iter; left time: 4.0247s
Epoch: 30 cost time: 8.515589475631714
Epoch: 30, Steps: 131 | Train Loss: 0.3463959 Vali Loss: 0.1844910 Test Loss: 0.2456935
>>>>>>>testing : ETTm2_720_192_SparseTSF_ETTm2_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2477937489748001, mae:0.3211197555065155, rse:0.40293988585472107
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_336', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_336_SparseTSF_ETTm2_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.1335675
	speed: 0.1456s/iter; left time: 553.5843s
Epoch: 1 cost time: 9.582308769226074
Epoch: 1, Steps: 130 | Train Loss: 0.5200197 Vali Loss: 0.2781527 Test Loss: 0.3657074
	iters: 100, epoch: 2 | loss: 0.1350290
	speed: 0.1454s/iter; left time: 533.7683s
Epoch: 2 cost time: 8.618089199066162
Epoch: 2, Steps: 130 | Train Loss: 0.4859453 Vali Loss: 0.2669024 Test Loss: 0.3476411
	iters: 100, epoch: 3 | loss: 0.1435365
	speed: 0.1408s/iter; left time: 498.7413s
Epoch: 3 cost time: 8.363961935043335
Epoch: 3, Steps: 130 | Train Loss: 0.4973433 Vali Loss: 0.3677467 Test Loss: 0.4429639
	iters: 100, epoch: 4 | loss: 0.1473708
	speed: 0.1396s/iter; left time: 476.2239s
Epoch: 4 cost time: 8.422636270523071
Epoch: 4, Steps: 130 | Train Loss: 0.4873015 Vali Loss: 0.2456315 Test Loss: 0.3273233
	iters: 100, epoch: 5 | loss: 0.1460955
	speed: 0.1412s/iter; left time: 463.1781s
Epoch: 5 cost time: 8.47505259513855
Epoch: 5, Steps: 130 | Train Loss: 0.4756213 Vali Loss: 0.2514514 Test Loss: 0.3283853
	iters: 100, epoch: 6 | loss: 0.1435571
	speed: 0.1407s/iter; left time: 443.2940s
Epoch: 6 cost time: 8.519073009490967
Epoch: 6, Steps: 130 | Train Loss: 0.4807212 Vali Loss: 0.2370657 Test Loss: 0.3160011
	iters: 100, epoch: 7 | loss: 0.1425271
	speed: 0.1463s/iter; left time: 441.8299s
Epoch: 7 cost time: 8.834006786346436
Epoch: 7, Steps: 130 | Train Loss: 0.4723143 Vali Loss: 0.2393717 Test Loss: 0.3127971
	iters: 100, epoch: 8 | loss: 0.1376108
	speed: 0.1438s/iter; left time: 415.6246s
Epoch: 8 cost time: 8.780562162399292
Epoch: 8, Steps: 130 | Train Loss: 0.4738120 Vali Loss: 0.2326533 Test Loss: 0.3099002
	iters: 100, epoch: 9 | loss: 0.1339568
	speed: 0.1398s/iter; left time: 386.0423s
Epoch: 9 cost time: 8.571466207504272
Epoch: 9, Steps: 130 | Train Loss: 0.4686704 Vali Loss: 0.2391306 Test Loss: 0.3115528
	iters: 100, epoch: 10 | loss: 0.1297644
	speed: 0.1409s/iter; left time: 370.6135s
Epoch: 10 cost time: 8.722763299942017
Epoch: 10, Steps: 130 | Train Loss: 0.4685793 Vali Loss: 0.2324815 Test Loss: 0.3080053
	iters: 100, epoch: 11 | loss: 0.1202607
	speed: 0.1415s/iter; left time: 353.9243s
Epoch: 11 cost time: 8.325300931930542
Epoch: 11, Steps: 130 | Train Loss: 0.4676813 Vali Loss: 0.2512770 Test Loss: 0.3339339
	iters: 100, epoch: 12 | loss: 0.1123451
	speed: 0.1428s/iter; left time: 338.6371s
Epoch: 12 cost time: 8.759089708328247
Epoch: 12, Steps: 130 | Train Loss: 0.4786426 Vali Loss: 0.2717819 Test Loss: 0.3513797
	iters: 100, epoch: 13 | loss: 0.1110339
	speed: 0.1421s/iter; left time: 318.3868s
Epoch: 13 cost time: 8.501983165740967
Epoch: 13, Steps: 130 | Train Loss: 0.4902484 Vali Loss: 0.2760790 Test Loss: 0.3625748
	iters: 100, epoch: 14 | loss: 0.1249044
	speed: 0.1411s/iter; left time: 297.9058s
Epoch: 14 cost time: 8.67228078842163
Epoch: 14, Steps: 130 | Train Loss: 0.4491472 Vali Loss: 0.2583476 Test Loss: 0.3394023
	iters: 100, epoch: 15 | loss: 0.1292427
	speed: 0.1418s/iter; left time: 280.9004s
Epoch: 15 cost time: 8.615508556365967
Epoch: 15, Steps: 130 | Train Loss: 0.4400199 Vali Loss: 0.2348034 Test Loss: 0.3114024
	iters: 100, epoch: 16 | loss: 0.1139688
	speed: 0.1391s/iter; left time: 257.3935s
Epoch: 16 cost time: 8.344610691070557
Epoch: 16, Steps: 130 | Train Loss: 0.4554372 Vali Loss: 0.2750129 Test Loss: 0.3640065
	iters: 100, epoch: 17 | loss: 0.1239065
	speed: 0.1410s/iter; left time: 242.6635s
Epoch: 17 cost time: 8.561081409454346
Epoch: 17, Steps: 130 | Train Loss: 0.5191533 Vali Loss: 0.2355324 Test Loss: 0.3169775
	iters: 100, epoch: 18 | loss: 0.1272411
	speed: 0.1398s/iter; left time: 222.4956s
Epoch: 18 cost time: 8.338186025619507
Epoch: 18, Steps: 130 | Train Loss: 0.4412187 Vali Loss: 0.3827862 Test Loss: 0.5272775
	iters: 100, epoch: 19 | loss: 0.1036715
	speed: 0.1421s/iter; left time: 207.6283s
Epoch: 19 cost time: 8.685435056686401
Epoch: 19, Steps: 130 | Train Loss: 0.4670822 Vali Loss: 0.2222109 Test Loss: 0.2981653
	iters: 100, epoch: 20 | loss: 0.1072312
	speed: 0.1429s/iter; left time: 190.2619s
Epoch: 20 cost time: 8.574919939041138
Epoch: 20, Steps: 130 | Train Loss: 0.4668072 Vali Loss: 0.7003792 Test Loss: 0.9575861
	iters: 100, epoch: 21 | loss: 0.1219862
	speed: 0.1425s/iter; left time: 171.0993s
Epoch: 21 cost time: 8.539783000946045
Epoch: 21, Steps: 130 | Train Loss: 0.5070101 Vali Loss: 0.2177580 Test Loss: 0.2962149
	iters: 100, epoch: 22 | loss: 0.1238635
	speed: 0.1387s/iter; left time: 148.5603s
Epoch: 22 cost time: 8.452197313308716
Epoch: 22, Steps: 130 | Train Loss: 0.4285097 Vali Loss: 0.2300134 Test Loss: 0.3070571
	iters: 100, epoch: 23 | loss: 0.1179632
	speed: 0.1460s/iter; left time: 137.3415s
Epoch: 23 cost time: 8.97029972076416
Epoch: 23, Steps: 130 | Train Loss: 0.4297943 Vali Loss: 0.2064621 Test Loss: 0.2791492
	iters: 100, epoch: 24 | loss: 0.1197118
	speed: 0.1439s/iter; left time: 116.6866s
Epoch: 24 cost time: 9.024622201919556
Epoch: 24, Steps: 130 | Train Loss: 0.4191448 Vali Loss: 0.2332608 Test Loss: 0.3113012
	iters: 100, epoch: 25 | loss: 0.1237946
	speed: 0.1403s/iter; left time: 95.5159s
Epoch: 25 cost time: 8.455058813095093
Epoch: 25, Steps: 130 | Train Loss: 0.4285327 Vali Loss: 0.2946864 Test Loss: 0.3959612
	iters: 100, epoch: 26 | loss: 0.1213348
	speed: 0.1399s/iter; left time: 77.0658s
Epoch: 26 cost time: 8.490209579467773
Epoch: 26, Steps: 130 | Train Loss: 0.4418424 Vali Loss: 0.2109790 Test Loss: 0.2823349
	iters: 100, epoch: 27 | loss: 0.1171808
	speed: 0.1429s/iter; left time: 60.1476s
Epoch: 27 cost time: 8.858535289764404
Epoch: 27, Steps: 130 | Train Loss: 0.4374215 Vali Loss: 0.2358562 Test Loss: 0.3167149
	iters: 100, epoch: 28 | loss: 0.1147405
	speed: 0.1438s/iter; left time: 41.8498s
Epoch: 28 cost time: 8.493223428726196
Epoch: 28, Steps: 130 | Train Loss: 0.4181942 Vali Loss: 0.2112653 Test Loss: 0.2846231
	iters: 100, epoch: 29 | loss: 0.1202061
	speed: 0.1412s/iter; left time: 22.7339s
Epoch: 29 cost time: 8.796157598495483
Epoch: 29, Steps: 130 | Train Loss: 0.4176268 Vali Loss: 0.2407995 Test Loss: 0.3221336
	iters: 100, epoch: 30 | loss: 0.1203643
	speed: 0.1444s/iter; left time: 4.4765s
Epoch: 30 cost time: 8.533941984176636
Epoch: 30, Steps: 130 | Train Loss: 0.4229234 Vali Loss: 0.2135770 Test Loss: 0.2867403
>>>>>>>testing : ETTm2_720_336_SparseTSF_ETTm2_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2875891923904419, mae:0.34386253356933594, rse:0.43315860629081726
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_720', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_720_SparseTSF_ETTm2_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2682465
	speed: 0.1888s/iter; left time: 711.9710s
Epoch: 1 cost time: 12.687203407287598
Epoch: 1, Steps: 129 | Train Loss: 0.6174601 Vali Loss: 0.3298711 Test Loss: 0.4326568
	iters: 100, epoch: 2 | loss: 0.2727618
	speed: 0.1853s/iter; left time: 674.8908s
Epoch: 2 cost time: 11.001111268997192
Epoch: 2, Steps: 129 | Train Loss: 0.5853769 Vali Loss: 0.3974139 Test Loss: 0.4926549
	iters: 100, epoch: 3 | loss: 0.2646630
	speed: 0.1841s/iter; left time: 646.6890s
Epoch: 3 cost time: 10.862874507904053
Epoch: 3, Steps: 129 | Train Loss: 0.6037566 Vali Loss: 0.4790303 Test Loss: 0.5878958
	iters: 100, epoch: 4 | loss: 0.2895586
	speed: 0.1888s/iter; left time: 639.0116s
Epoch: 4 cost time: 11.832499742507935
Epoch: 4, Steps: 129 | Train Loss: 0.6190739 Vali Loss: 0.3268814 Test Loss: 0.4372200
	iters: 100, epoch: 5 | loss: 0.2878112
	speed: 0.1858s/iter; left time: 604.7338s
Epoch: 5 cost time: 11.114710330963135
Epoch: 5, Steps: 129 | Train Loss: 0.6050929 Vali Loss: 0.3348188 Test Loss: 0.4401748
	iters: 100, epoch: 6 | loss: 0.2925541
	speed: 0.1830s/iter; left time: 571.9838s
Epoch: 6 cost time: 10.992680072784424
Epoch: 6, Steps: 129 | Train Loss: 0.5842688 Vali Loss: 0.3042800 Test Loss: 0.4078644
	iters: 100, epoch: 7 | loss: 0.2843532
	speed: 0.1849s/iter; left time: 554.1955s
Epoch: 7 cost time: 11.182927370071411
Epoch: 7, Steps: 129 | Train Loss: 0.5707591 Vali Loss: 0.3715953 Test Loss: 0.4744595
	iters: 100, epoch: 8 | loss: 0.2730412
	speed: 0.1801s/iter; left time: 516.3860s
Epoch: 8 cost time: 11.187291383743286
Epoch: 8, Steps: 129 | Train Loss: 0.5892476 Vali Loss: 0.3510766 Test Loss: 0.4500173
	iters: 100, epoch: 9 | loss: 0.2834128
	speed: 0.1845s/iter; left time: 505.3653s
Epoch: 9 cost time: 10.999080181121826
Epoch: 9, Steps: 129 | Train Loss: 0.5829191 Vali Loss: 0.3094471 Test Loss: 0.4205653
	iters: 100, epoch: 10 | loss: 0.2933339
	speed: 0.1829s/iter; left time: 477.3131s
Epoch: 10 cost time: 11.270766973495483
Epoch: 10, Steps: 129 | Train Loss: 0.5515371 Vali Loss: 0.3292846 Test Loss: 0.4248415
	iters: 100, epoch: 11 | loss: 0.2824057
	speed: 0.1852s/iter; left time: 459.3576s
Epoch: 11 cost time: 11.481444120407104
Epoch: 11, Steps: 129 | Train Loss: 0.5825342 Vali Loss: 0.5334439 Test Loss: 0.6556031
	iters: 100, epoch: 12 | loss: 0.2721239
	speed: 0.1908s/iter; left time: 448.7453s
Epoch: 12 cost time: 11.672717332839966
Epoch: 12, Steps: 129 | Train Loss: 0.5626175 Vali Loss: 0.3037444 Test Loss: 0.4018304
	iters: 100, epoch: 13 | loss: 0.2832470
	speed: 0.1883s/iter; left time: 418.5500s
Epoch: 13 cost time: 11.743732690811157
Epoch: 13, Steps: 129 | Train Loss: 0.5554206 Vali Loss: 0.3030927 Test Loss: 0.4015644
	iters: 100, epoch: 14 | loss: 0.2841167
	speed: 0.1874s/iter; left time: 392.3716s
Epoch: 14 cost time: 11.49645185470581
Epoch: 14, Steps: 129 | Train Loss: 0.5805974 Vali Loss: 0.2830933 Test Loss: 0.3888740
	iters: 100, epoch: 15 | loss: 0.2797299
	speed: 0.1818s/iter; left time: 357.1900s
Epoch: 15 cost time: 10.99078369140625
Epoch: 15, Steps: 129 | Train Loss: 0.5372686 Vali Loss: 0.3229060 Test Loss: 0.4186845
	iters: 100, epoch: 16 | loss: 0.2910507
	speed: 0.1850s/iter; left time: 339.6395s
Epoch: 16 cost time: 11.313883304595947
Epoch: 16, Steps: 129 | Train Loss: 0.6020229 Vali Loss: 0.2834001 Test Loss: 0.3914467
	iters: 100, epoch: 17 | loss: 0.2606645
	speed: 0.1849s/iter; left time: 315.6776s
Epoch: 17 cost time: 11.300801753997803
Epoch: 17, Steps: 129 | Train Loss: 0.5400051 Vali Loss: 0.2980214 Test Loss: 0.4124744
	iters: 100, epoch: 18 | loss: 0.2832828
	speed: 0.1859s/iter; left time: 293.2883s
Epoch: 18 cost time: 11.463652849197388
Epoch: 18, Steps: 129 | Train Loss: 0.5373362 Vali Loss: 0.2878563 Test Loss: 0.3951643
	iters: 100, epoch: 19 | loss: 0.2690187
	speed: 0.1873s/iter; left time: 271.3742s
Epoch: 19 cost time: 11.467552185058594
Epoch: 19, Steps: 129 | Train Loss: 0.5554199 Vali Loss: 0.2827519 Test Loss: 0.3843043
	iters: 100, epoch: 20 | loss: 0.2768272
	speed: 0.1881s/iter; left time: 248.3219s
Epoch: 20 cost time: 11.313144445419312
Epoch: 20, Steps: 129 | Train Loss: 0.5684844 Vali Loss: 0.3181880 Test Loss: 0.4138684
	iters: 100, epoch: 21 | loss: 0.2781945
	speed: 0.1850s/iter; left time: 220.3043s
Epoch: 21 cost time: 11.231717348098755
Epoch: 21, Steps: 129 | Train Loss: 0.6020916 Vali Loss: 0.3015692 Test Loss: 0.4056010
	iters: 100, epoch: 22 | loss: 0.2585302
	speed: 0.1855s/iter; left time: 197.0014s
Epoch: 22 cost time: 11.416366577148438
Epoch: 22, Steps: 129 | Train Loss: 0.5540127 Vali Loss: 0.2942793 Test Loss: 0.3994904
	iters: 100, epoch: 23 | loss: 0.2832314
	speed: 0.1850s/iter; left time: 172.6405s
Epoch: 23 cost time: 11.160764217376709
Epoch: 23, Steps: 129 | Train Loss: 0.5452959 Vali Loss: 0.3287435 Test Loss: 0.4375189
	iters: 100, epoch: 24 | loss: 0.2408378
	speed: 0.1817s/iter; left time: 146.0572s
Epoch: 24 cost time: 10.982645273208618
Epoch: 24, Steps: 129 | Train Loss: 0.5674939 Vali Loss: 0.2775577 Test Loss: 0.3766808
	iters: 100, epoch: 25 | loss: 0.2833133
	speed: 0.1820s/iter; left time: 122.8502s
Epoch: 25 cost time: 11.188432693481445
Epoch: 25, Steps: 129 | Train Loss: 0.5466661 Vali Loss: 0.5205455 Test Loss: 0.6500008
	iters: 100, epoch: 26 | loss: 0.2672872
	speed: 0.1827s/iter; left time: 99.7512s
Epoch: 26 cost time: 11.146987676620483
Epoch: 26, Steps: 129 | Train Loss: 0.5576989 Vali Loss: 0.3531823 Test Loss: 0.4594317
	iters: 100, epoch: 27 | loss: 0.2412034
	speed: 0.1807s/iter; left time: 75.3462s
Epoch: 27 cost time: 11.030000448226929
Epoch: 27, Steps: 129 | Train Loss: 0.5674851 Vali Loss: 0.2973218 Test Loss: 0.4019401
	iters: 100, epoch: 28 | loss: 0.2842537
	speed: 0.1835s/iter; left time: 52.8500s
Epoch: 28 cost time: 11.264196872711182
Epoch: 28, Steps: 129 | Train Loss: 0.5420652 Vali Loss: 0.3001142 Test Loss: 0.4116631
	iters: 100, epoch: 29 | loss: 0.2558741
	speed: 0.1847s/iter; left time: 29.3672s
Epoch: 29 cost time: 11.406270503997803
Epoch: 29, Steps: 129 | Train Loss: 0.5854161 Vali Loss: 0.3158434 Test Loss: 0.4214593
	iters: 100, epoch: 30 | loss: 0.2777293
	speed: 0.1857s/iter; left time: 5.5723s
Epoch: 30 cost time: 11.432003259658813
Epoch: 30, Steps: 129 | Train Loss: 0.5957840 Vali Loss: 0.3388868 Test Loss: 0.4426588
>>>>>>>testing : ETTm2_720_720_SparseTSF_ETTm2_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.43006646633148193, mae:0.44095635414123535, rse:0.5271232724189758
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_96', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_96_SparseTSF_ETTh1_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Epoch: 1 cost time: 2.54243540763855
Epoch: 1, Steps: 30 | Train Loss: 0.4787085 Vali Loss: 0.9947834 Test Loss: 0.4005520
Epoch: 2 cost time: 1.8421859741210938
Epoch: 2, Steps: 30 | Train Loss: 0.4092841 Vali Loss: 0.8829373 Test Loss: 0.3871351
Epoch: 3 cost time: 1.7339153289794922
Epoch: 3, Steps: 30 | Train Loss: 0.3728871 Vali Loss: 0.7833111 Test Loss: 0.3716554
Epoch: 4 cost time: 2.2168519496917725
Epoch: 4, Steps: 30 | Train Loss: 0.3682732 Vali Loss: 0.8351892 Test Loss: 0.3782333
Epoch: 5 cost time: 1.7632372379302979
Epoch: 5, Steps: 30 | Train Loss: 0.3659340 Vali Loss: 0.8089378 Test Loss: 0.3748807
Epoch: 6 cost time: 1.8023791313171387
Epoch: 6, Steps: 30 | Train Loss: 0.3661785 Vali Loss: 0.8190299 Test Loss: 0.3761048
Epoch: 7 cost time: 1.8510560989379883
Epoch: 7, Steps: 30 | Train Loss: 0.3655201 Vali Loss: 0.8172212 Test Loss: 0.3768365
Epoch: 8 cost time: 1.7695183753967285
Epoch: 8, Steps: 30 | Train Loss: 0.3656684 Vali Loss: 0.8171737 Test Loss: 0.3770051
Epoch: 9 cost time: 1.7564289569854736
Epoch: 9, Steps: 30 | Train Loss: 0.3656379 Vali Loss: 0.8188226 Test Loss: 0.3778815
Epoch: 10 cost time: 1.9656429290771484
Epoch: 10, Steps: 30 | Train Loss: 0.3657347 Vali Loss: 0.8188753 Test Loss: 0.3783140
Epoch: 11 cost time: 2.04719614982605
Epoch: 11, Steps: 30 | Train Loss: 0.3657790 Vali Loss: 0.8194143 Test Loss: 0.3786943
Epoch: 12 cost time: 1.904472827911377
Epoch: 12, Steps: 30 | Train Loss: 0.3658595 Vali Loss: 0.8198905 Test Loss: 0.3790975
Epoch: 13 cost time: 1.8375282287597656
Epoch: 13, Steps: 30 | Train Loss: 0.3659075 Vali Loss: 0.8201419 Test Loss: 0.3793549
Epoch: 14 cost time: 1.8139855861663818
Epoch: 14, Steps: 30 | Train Loss: 0.3659583 Vali Loss: 0.8204335 Test Loss: 0.3795979
Epoch: 15 cost time: 1.7691516876220703
Epoch: 15, Steps: 30 | Train Loss: 0.3660024 Vali Loss: 0.8206552 Test Loss: 0.3797989
Epoch: 16 cost time: 1.7839114665985107
Epoch: 16, Steps: 30 | Train Loss: 0.3660391 Vali Loss: 0.8208426 Test Loss: 0.3799632
Epoch: 17 cost time: 1.6447813510894775
Epoch: 17, Steps: 30 | Train Loss: 0.3660727 Vali Loss: 0.8210055 Test Loss: 0.3801054
Epoch: 18 cost time: 1.6571452617645264
Epoch: 18, Steps: 30 | Train Loss: 0.3661018 Vali Loss: 0.8211452 Test Loss: 0.3802260
Epoch: 19 cost time: 1.8323583602905273
Epoch: 19, Steps: 30 | Train Loss: 0.3661276 Vali Loss: 0.8212667 Test Loss: 0.3803292
Epoch: 20 cost time: 1.6667535305023193
Epoch: 20, Steps: 30 | Train Loss: 0.3661508 Vali Loss: 0.8213735 Test Loss: 0.3804186
Epoch: 21 cost time: 1.8551084995269775
Epoch: 21, Steps: 30 | Train Loss: 0.3661715 Vali Loss: 0.8214676 Test Loss: 0.3804961
Epoch: 22 cost time: 1.6997342109680176
Epoch: 22, Steps: 30 | Train Loss: 0.3661901 Vali Loss: 0.8215513 Test Loss: 0.3805639
Epoch: 23 cost time: 1.6800694465637207
Epoch: 23, Steps: 30 | Train Loss: 0.3662070 Vali Loss: 0.8216263 Test Loss: 0.3806235
Epoch: 24 cost time: 1.648653268814087
Epoch: 24, Steps: 30 | Train Loss: 0.3662224 Vali Loss: 0.8216939 Test Loss: 0.3806763
Epoch: 25 cost time: 1.76643967628479
Epoch: 25, Steps: 30 | Train Loss: 0.3662364 Vali Loss: 0.8217551 Test Loss: 0.3807231
Epoch: 26 cost time: 1.8705112934112549
Epoch: 26, Steps: 30 | Train Loss: 0.3662492 Vali Loss: 0.8218107 Test Loss: 0.3807651
Epoch: 27 cost time: 1.8858332633972168
Epoch: 27, Steps: 30 | Train Loss: 0.3662611 Vali Loss: 0.8218616 Test Loss: 0.3808026
Epoch: 28 cost time: 1.747422456741333
Epoch: 28, Steps: 30 | Train Loss: 0.3662721 Vali Loss: 0.8219085 Test Loss: 0.3808366
Epoch: 29 cost time: 1.7468292713165283
Epoch: 29, Steps: 30 | Train Loss: 0.3662823 Vali Loss: 0.8219515 Test Loss: 0.3808673
Epoch: 30 cost time: 1.6526052951812744
Epoch: 30, Steps: 30 | Train Loss: 0.3662917 Vali Loss: 0.8219913 Test Loss: 0.3808952
>>>>>>>testing : ETTh1_720_96_SparseTSF_ETTh1_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38008734583854675, mae:0.40228673815727234, rse:0.5855979919433594
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_192', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_192_SparseTSF_ETTh1_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2689
test 2689
Epoch: 1 cost time: 2.946842670440674
Epoch: 1, Steps: 30 | Train Loss: 0.5418727 Vali Loss: 1.2023872 Test Loss: 0.5074036
Epoch: 2 cost time: 2.0147271156311035
Epoch: 2, Steps: 30 | Train Loss: 0.5044188 Vali Loss: 1.2136468 Test Loss: 0.5162278
Epoch: 3 cost time: 1.8782761096954346
Epoch: 3, Steps: 30 | Train Loss: 0.4958620 Vali Loss: 1.1728799 Test Loss: 0.5079073
Epoch: 4 cost time: 1.9378688335418701
Epoch: 4, Steps: 30 | Train Loss: 0.4975044 Vali Loss: 1.2097503 Test Loss: 0.5092274
Epoch: 5 cost time: 2.069317579269409
Epoch: 5, Steps: 30 | Train Loss: 0.4890156 Vali Loss: 1.1387248 Test Loss: 0.4902476
Epoch: 6 cost time: 1.9894294738769531
Epoch: 6, Steps: 30 | Train Loss: 0.4878426 Vali Loss: 1.2009041 Test Loss: 0.4965182
Epoch: 7 cost time: 1.8956937789916992
Epoch: 7, Steps: 30 | Train Loss: 0.4816521 Vali Loss: 1.1115841 Test Loss: 0.4707577
Epoch: 8 cost time: 1.981668472290039
Epoch: 8, Steps: 30 | Train Loss: 0.4780580 Vali Loss: 1.1894466 Test Loss: 0.4800916
Epoch: 9 cost time: 1.9387567043304443
Epoch: 9, Steps: 30 | Train Loss: 0.4772619 Vali Loss: 1.0940125 Test Loss: 0.4593709
Epoch: 10 cost time: 1.8987152576446533
Epoch: 10, Steps: 30 | Train Loss: 0.4720894 Vali Loss: 1.1834191 Test Loss: 0.4714195
Epoch: 11 cost time: 1.902405023574829
Epoch: 11, Steps: 30 | Train Loss: 0.4772248 Vali Loss: 1.0892985 Test Loss: 0.4579261
Epoch: 12 cost time: 1.888902187347412
Epoch: 12, Steps: 30 | Train Loss: 0.4689243 Vali Loss: 1.1718119 Test Loss: 0.4664161
Epoch: 13 cost time: 1.897125482559204
Epoch: 13, Steps: 30 | Train Loss: 0.4733356 Vali Loss: 1.0969465 Test Loss: 0.4659545
Epoch: 14 cost time: 1.8463866710662842
Epoch: 14, Steps: 30 | Train Loss: 0.4684553 Vali Loss: 1.1688716 Test Loss: 0.4658211
Epoch: 15 cost time: 1.954909324645996
Epoch: 15, Steps: 30 | Train Loss: 0.4716071 Vali Loss: 1.1005639 Test Loss: 0.4680764
Epoch: 16 cost time: 1.9258925914764404
Epoch: 16, Steps: 30 | Train Loss: 0.4694007 Vali Loss: 1.1730020 Test Loss: 0.4669306
Epoch: 17 cost time: 2.039578437805176
Epoch: 17, Steps: 30 | Train Loss: 0.4729315 Vali Loss: 1.1003795 Test Loss: 0.4680693
Epoch: 18 cost time: 2.078305959701538
Epoch: 18, Steps: 30 | Train Loss: 0.4698689 Vali Loss: 1.1722171 Test Loss: 0.4678443
Epoch: 19 cost time: 1.9313757419586182
Epoch: 19, Steps: 30 | Train Loss: 0.4723501 Vali Loss: 1.1010154 Test Loss: 0.4690625
Epoch: 20 cost time: 1.9326622486114502
Epoch: 20, Steps: 30 | Train Loss: 0.4701048 Vali Loss: 1.1731430 Test Loss: 0.4681551
Epoch: 21 cost time: 1.9873771667480469
Epoch: 21, Steps: 30 | Train Loss: 0.4728936 Vali Loss: 1.1018672 Test Loss: 0.4695621
Epoch: 22 cost time: 1.9661362171173096
Epoch: 22, Steps: 30 | Train Loss: 0.4703446 Vali Loss: 1.1729786 Test Loss: 0.4684977
Epoch: 23 cost time: 1.9704716205596924
Epoch: 23, Steps: 30 | Train Loss: 0.4728042 Vali Loss: 1.1022707 Test Loss: 0.4700835
Epoch: 24 cost time: 2.0977942943573
Epoch: 24, Steps: 30 | Train Loss: 0.4705001 Vali Loss: 1.1733203 Test Loss: 0.4686966
Epoch: 25 cost time: 1.864992618560791
Epoch: 25, Steps: 30 | Train Loss: 0.4731089 Vali Loss: 1.1027795 Test Loss: 0.4704268
Epoch: 26 cost time: 1.960219383239746
Epoch: 26, Steps: 30 | Train Loss: 0.4706248 Vali Loss: 1.1732222 Test Loss: 0.4688660
Epoch: 27 cost time: 2.0085623264312744
Epoch: 27, Steps: 30 | Train Loss: 0.4731515 Vali Loss: 1.1031368 Test Loss: 0.4707754
Epoch: 28 cost time: 1.9055352210998535
Epoch: 28, Steps: 30 | Train Loss: 0.4707110 Vali Loss: 1.1732931 Test Loss: 0.4689730
Epoch: 29 cost time: 1.9242117404937744
Epoch: 29, Steps: 30 | Train Loss: 0.4733170 Vali Loss: 1.1034963 Test Loss: 0.4710271
Epoch: 30 cost time: 1.9802753925323486
Epoch: 30, Steps: 30 | Train Loss: 0.4707893 Vali Loss: 1.1732486 Test Loss: 0.4690673
>>>>>>>testing : ETTh1_720_192_SparseTSF_ETTh1_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.45666268467903137, mae:0.4676980972290039, rse:0.6417340636253357
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_336', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_336_SparseTSF_ETTh1_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 3.130919933319092
Epoch: 1, Steps: 29 | Train Loss: 0.6007696 Vali Loss: 1.4389833 Test Loss: 0.5011001
Epoch: 2 cost time: 2.184796094894409
Epoch: 2, Steps: 29 | Train Loss: 0.6525562 Vali Loss: 1.6192011 Test Loss: 0.6945750
Epoch: 3 cost time: 2.0913796424865723
Epoch: 3, Steps: 29 | Train Loss: 0.5189712 Vali Loss: 1.3408847 Test Loss: 0.4477300
Epoch: 4 cost time: 2.097579002380371
Epoch: 4, Steps: 29 | Train Loss: 0.5281867 Vali Loss: 1.3419538 Test Loss: 0.4674721
Epoch: 5 cost time: 1.9585151672363281
Epoch: 5, Steps: 29 | Train Loss: 0.5275463 Vali Loss: 1.3794278 Test Loss: 0.4819783
Epoch: 6 cost time: 1.9846596717834473
Epoch: 6, Steps: 29 | Train Loss: 0.5368915 Vali Loss: 1.3597600 Test Loss: 0.4854839
Epoch: 7 cost time: 1.9736113548278809
Epoch: 7, Steps: 29 | Train Loss: 0.5651081 Vali Loss: 1.3690876 Test Loss: 0.4874435
Epoch: 8 cost time: 1.9587557315826416
Epoch: 8, Steps: 29 | Train Loss: 0.5754812 Vali Loss: 1.2858164 Test Loss: 0.4379199
Epoch: 9 cost time: 1.939234733581543
Epoch: 9, Steps: 29 | Train Loss: 0.5436772 Vali Loss: 1.4004248 Test Loss: 0.5008559
Epoch: 10 cost time: 2.008126735687256
Epoch: 10, Steps: 29 | Train Loss: 0.5714356 Vali Loss: 1.3056474 Test Loss: 0.4568265
Epoch: 11 cost time: 2.0156493186950684
Epoch: 11, Steps: 29 | Train Loss: 0.5278143 Vali Loss: 1.3593776 Test Loss: 0.4808324
Epoch: 12 cost time: 2.0946481227874756
Epoch: 12, Steps: 29 | Train Loss: 0.5647557 Vali Loss: 1.3038026 Test Loss: 0.4522883
Epoch: 13 cost time: 1.8899776935577393
Epoch: 13, Steps: 29 | Train Loss: 0.5466494 Vali Loss: 1.3007815 Test Loss: 0.4503064
Epoch: 14 cost time: 2.0408782958984375
Epoch: 14, Steps: 29 | Train Loss: 0.5658187 Vali Loss: 1.2992300 Test Loss: 0.4468819
Epoch: 15 cost time: 2.0157628059387207
Epoch: 15, Steps: 29 | Train Loss: 0.5278835 Vali Loss: 1.3222578 Test Loss: 0.4654004
Epoch: 16 cost time: 1.9895570278167725
Epoch: 16, Steps: 29 | Train Loss: 0.5615209 Vali Loss: 1.3112870 Test Loss: 0.4557632
Epoch: 17 cost time: 2.0080032348632812
Epoch: 17, Steps: 29 | Train Loss: 0.5342635 Vali Loss: 1.3208606 Test Loss: 0.4611785
Epoch: 18 cost time: 1.9504683017730713
Epoch: 18, Steps: 29 | Train Loss: 0.5613055 Vali Loss: 1.3028011 Test Loss: 0.4521429
Epoch: 19 cost time: 2.0472540855407715
Epoch: 19, Steps: 29 | Train Loss: 0.5289821 Vali Loss: 1.3218719 Test Loss: 0.4619920
Epoch: 20 cost time: 1.9469282627105713
Epoch: 20, Steps: 29 | Train Loss: 0.5585027 Vali Loss: 1.3027352 Test Loss: 0.4501244
Epoch: 21 cost time: 1.9758234024047852
Epoch: 21, Steps: 29 | Train Loss: 0.5355043 Vali Loss: 1.3107219 Test Loss: 0.4568962
Epoch: 22 cost time: 1.9560861587524414
Epoch: 22, Steps: 29 | Train Loss: 0.5616440 Vali Loss: 1.3057002 Test Loss: 0.4539387
Epoch: 23 cost time: 1.966949224472046
Epoch: 23, Steps: 29 | Train Loss: 0.5222664 Vali Loss: 1.3236190 Test Loss: 0.4636248
Epoch: 24 cost time: 2.1488606929779053
Epoch: 24, Steps: 29 | Train Loss: 0.5470204 Vali Loss: 1.3157402 Test Loss: 0.4583811
Epoch: 25 cost time: 2.1371047496795654
Epoch: 25, Steps: 29 | Train Loss: 0.5557210 Vali Loss: 1.2968372 Test Loss: 0.4507042
Epoch: 26 cost time: 2.0468921661376953
Epoch: 26, Steps: 29 | Train Loss: 0.5296661 Vali Loss: 1.3349005 Test Loss: 0.4669603
Epoch: 27 cost time: 2.0521414279937744
Epoch: 27, Steps: 29 | Train Loss: 0.5454799 Vali Loss: 1.3111356 Test Loss: 0.4588264
Epoch: 28 cost time: 2.0774590969085693
Epoch: 28, Steps: 29 | Train Loss: 0.5563522 Vali Loss: 1.3000154 Test Loss: 0.4515274
Epoch: 29 cost time: 2.0004382133483887
Epoch: 29, Steps: 29 | Train Loss: 0.5254318 Vali Loss: 1.3394300 Test Loss: 0.4696356
Epoch: 30 cost time: 1.948859691619873
Epoch: 30, Steps: 29 | Train Loss: 0.5366531 Vali Loss: 1.3179976 Test Loss: 0.4634315
>>>>>>>testing : ETTh1_720_336_SparseTSF_ETTh1_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.461963951587677, mae:0.47664743661880493, rse:0.6470771431922913
Args in experiment:
Namespace(is_training=1, model_id='ETTh1_720_720', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh1_720_720_SparseTSF_ETTh1_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
Epoch: 1 cost time: 3.686941146850586
Epoch: 1, Steps: 28 | Train Loss: 0.7248601 Vali Loss: 1.5774292 Test Loss: 0.4779463
Epoch: 2 cost time: 2.70835280418396
Epoch: 2, Steps: 28 | Train Loss: 0.6899746 Vali Loss: 1.6068609 Test Loss: 0.4776596
Epoch: 3 cost time: 2.548694372177124
Epoch: 3, Steps: 28 | Train Loss: 0.7199691 Vali Loss: 1.5921557 Test Loss: 0.4788393
Epoch: 4 cost time: 2.433846950531006
Epoch: 4, Steps: 28 | Train Loss: 0.6554114 Vali Loss: 1.5334659 Test Loss: 0.4754039
Epoch: 5 cost time: 2.686014413833618
Epoch: 5, Steps: 28 | Train Loss: 0.6697588 Vali Loss: 1.5221151 Test Loss: 0.4763601
Epoch: 6 cost time: 2.7003931999206543
Epoch: 6, Steps: 28 | Train Loss: 0.6849747 Vali Loss: 1.5675955 Test Loss: 0.5308954
Epoch: 7 cost time: 2.7031843662261963
Epoch: 7, Steps: 28 | Train Loss: 0.6381631 Vali Loss: 1.5275483 Test Loss: 0.4739292
Epoch: 8 cost time: 2.7703633308410645
Epoch: 8, Steps: 28 | Train Loss: 0.6538639 Vali Loss: 1.5249195 Test Loss: 0.4745123
Epoch: 9 cost time: 2.5593085289001465
Epoch: 9, Steps: 28 | Train Loss: 0.6981658 Vali Loss: 1.5362463 Test Loss: 0.4972873
Epoch: 10 cost time: 2.590172529220581
Epoch: 10, Steps: 28 | Train Loss: 0.6548011 Vali Loss: 1.5295517 Test Loss: 0.4783517
Epoch: 11 cost time: 2.656627893447876
Epoch: 11, Steps: 28 | Train Loss: 0.6470369 Vali Loss: 1.5310966 Test Loss: 0.4747003
Epoch: 12 cost time: 2.52315616607666
Epoch: 12, Steps: 28 | Train Loss: 0.6975767 Vali Loss: 1.5337329 Test Loss: 0.4970593
Epoch: 13 cost time: 2.6931846141815186
Epoch: 13, Steps: 28 | Train Loss: 0.6534377 Vali Loss: 1.5323569 Test Loss: 0.4743905
Epoch: 14 cost time: 2.668339729309082
Epoch: 14, Steps: 28 | Train Loss: 0.6561888 Vali Loss: 1.5302784 Test Loss: 0.4727577
Epoch: 15 cost time: 2.5679125785827637
Epoch: 15, Steps: 28 | Train Loss: 0.7113322 Vali Loss: 1.5249093 Test Loss: 0.4712169
Epoch: 16 cost time: 2.5248312950134277
Epoch: 16, Steps: 28 | Train Loss: 0.6582903 Vali Loss: 1.5388296 Test Loss: 0.4785921
Epoch: 17 cost time: 2.6386141777038574
Epoch: 17, Steps: 28 | Train Loss: 0.6398420 Vali Loss: 1.5456424 Test Loss: 0.4695054
Epoch: 18 cost time: 2.672138214111328
Epoch: 18, Steps: 28 | Train Loss: 0.6801773 Vali Loss: 1.5631986 Test Loss: 0.5177132
Epoch: 19 cost time: 2.559138059616089
Epoch: 19, Steps: 28 | Train Loss: 0.6370382 Vali Loss: 1.5195458 Test Loss: 0.4647074
Epoch: 20 cost time: 2.4363210201263428
Epoch: 20, Steps: 28 | Train Loss: 0.6619773 Vali Loss: 1.5179274 Test Loss: 0.4722761
Epoch: 21 cost time: 2.5661392211914062
Epoch: 21, Steps: 28 | Train Loss: 0.6985954 Vali Loss: 1.5269253 Test Loss: 0.4854220
Epoch: 22 cost time: 2.4621901512145996
Epoch: 22, Steps: 28 | Train Loss: 0.6562354 Vali Loss: 1.5268438 Test Loss: 0.4807306
Epoch: 23 cost time: 2.5201103687286377
Epoch: 23, Steps: 28 | Train Loss: 0.6373323 Vali Loss: 1.5292006 Test Loss: 0.4741037
Epoch: 24 cost time: 2.609896421432495
Epoch: 24, Steps: 28 | Train Loss: 0.6825771 Vali Loss: 1.5583739 Test Loss: 0.5210365
Epoch: 25 cost time: 2.5798451900482178
Epoch: 25, Steps: 28 | Train Loss: 0.6369776 Vali Loss: 1.5150768 Test Loss: 0.4637524
Epoch: 26 cost time: 2.484475612640381
Epoch: 26, Steps: 28 | Train Loss: 0.6612831 Vali Loss: 1.5195854 Test Loss: 0.4736676
Epoch: 27 cost time: 2.5442910194396973
Epoch: 27, Steps: 28 | Train Loss: 0.7025912 Vali Loss: 1.5182247 Test Loss: 0.4739420
Epoch: 28 cost time: 2.5761654376983643
Epoch: 28, Steps: 28 | Train Loss: 0.6577256 Vali Loss: 1.5283109 Test Loss: 0.4814583
Epoch: 29 cost time: 2.5724599361419678
Epoch: 29, Steps: 28 | Train Loss: 0.6349421 Vali Loss: 1.5285898 Test Loss: 0.4725088
Epoch: 30 cost time: 2.4642038345336914
Epoch: 30, Steps: 28 | Train Loss: 0.6779016 Vali Loss: 1.5510401 Test Loss: 0.5126591
>>>>>>>testing : ETTh1_720_720_SparseTSF_ETTh1_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.5063143968582153, mae:0.5010067820549011, rse:0.6811802983283997
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_96', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_96_SparseTSF_ETTh2_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Epoch: 1 cost time: 2.5838449001312256
Epoch: 1, Steps: 30 | Train Loss: 0.5741982 Vali Loss: 0.2795583 Test Loss: 0.3402581
Epoch: 2 cost time: 1.707815408706665
Epoch: 2, Steps: 30 | Train Loss: 0.5418669 Vali Loss: 0.2942421 Test Loss: 0.3423861
Epoch: 3 cost time: 1.8356735706329346
Epoch: 3, Steps: 30 | Train Loss: 0.4932356 Vali Loss: 0.2758760 Test Loss: 0.3447649
Epoch: 4 cost time: 1.799466609954834
Epoch: 4, Steps: 30 | Train Loss: 0.5133677 Vali Loss: 0.2739346 Test Loss: 0.3663024
Epoch: 5 cost time: 1.8462588787078857
Epoch: 5, Steps: 30 | Train Loss: 0.5680813 Vali Loss: 0.2437165 Test Loss: 0.3113148
Epoch: 6 cost time: 1.8567430973052979
Epoch: 6, Steps: 30 | Train Loss: 0.6099649 Vali Loss: 0.2837830 Test Loss: 0.3245035
Epoch: 7 cost time: 1.8970887660980225
Epoch: 7, Steps: 30 | Train Loss: 0.4966005 Vali Loss: 0.2423653 Test Loss: 0.3325070
Epoch: 8 cost time: 1.8747799396514893
Epoch: 8, Steps: 30 | Train Loss: 0.4833425 Vali Loss: 0.2713208 Test Loss: 0.3365660
Epoch: 9 cost time: 1.8557476997375488
Epoch: 9, Steps: 30 | Train Loss: 0.4698143 Vali Loss: 0.2577918 Test Loss: 0.3304897
Epoch: 10 cost time: 1.8381993770599365
Epoch: 10, Steps: 30 | Train Loss: 0.4752554 Vali Loss: 0.2574793 Test Loss: 0.3712866
Epoch: 11 cost time: 1.953899621963501
Epoch: 11, Steps: 30 | Train Loss: 0.4810595 Vali Loss: 0.2574588 Test Loss: 0.3598621
Epoch: 12 cost time: 1.905372142791748
Epoch: 12, Steps: 30 | Train Loss: 0.4835670 Vali Loss: 0.2469441 Test Loss: 0.3441595
Epoch: 13 cost time: 1.9536371231079102
Epoch: 13, Steps: 30 | Train Loss: 0.4901239 Vali Loss: 0.2834733 Test Loss: 0.3832271
Epoch: 14 cost time: 1.9385688304901123
Epoch: 14, Steps: 30 | Train Loss: 0.4891328 Vali Loss: 0.2402970 Test Loss: 0.3373416
Epoch: 15 cost time: 1.9278035163879395
Epoch: 15, Steps: 30 | Train Loss: 0.4965068 Vali Loss: 0.2809265 Test Loss: 0.3715496
Epoch: 16 cost time: 1.8406057357788086
Epoch: 16, Steps: 30 | Train Loss: 0.5217993 Vali Loss: 0.2334943 Test Loss: 0.3266067
Epoch: 17 cost time: 1.9067282676696777
Epoch: 17, Steps: 30 | Train Loss: 0.5121339 Vali Loss: 0.2464413 Test Loss: 0.3178236
Epoch: 18 cost time: 1.8551476001739502
Epoch: 18, Steps: 30 | Train Loss: 0.4938536 Vali Loss: 0.2464459 Test Loss: 0.3165880
Epoch: 19 cost time: 2.1188290119171143
Epoch: 19, Steps: 30 | Train Loss: 0.4754700 Vali Loss: 0.2696503 Test Loss: 0.3323371
Epoch: 20 cost time: 1.872567892074585
Epoch: 20, Steps: 30 | Train Loss: 0.4671703 Vali Loss: 0.2478036 Test Loss: 0.3162848
Epoch: 21 cost time: 1.8464529514312744
Epoch: 21, Steps: 30 | Train Loss: 0.4699186 Vali Loss: 0.2554843 Test Loss: 0.3511406
Epoch: 22 cost time: 1.9208412170410156
Epoch: 22, Steps: 30 | Train Loss: 0.5023131 Vali Loss: 0.2709908 Test Loss: 0.3881928
Epoch: 23 cost time: 1.8724913597106934
Epoch: 23, Steps: 30 | Train Loss: 0.6057116 Vali Loss: 0.4238196 Test Loss: 0.3963562
Epoch: 24 cost time: 1.8076386451721191
Epoch: 24, Steps: 30 | Train Loss: 0.5264985 Vali Loss: 0.2767097 Test Loss: 0.3327667
Epoch: 25 cost time: 1.8302290439605713
Epoch: 25, Steps: 30 | Train Loss: 0.5474167 Vali Loss: 0.3282760 Test Loss: 0.3900745
Epoch: 26 cost time: 1.8517155647277832
Epoch: 26, Steps: 30 | Train Loss: 0.5215973 Vali Loss: 0.2394632 Test Loss: 0.3116717
Epoch: 27 cost time: 1.861259937286377
Epoch: 27, Steps: 30 | Train Loss: 0.5343870 Vali Loss: 0.3277385 Test Loss: 0.3262401
Epoch: 28 cost time: 1.8323817253112793
Epoch: 28, Steps: 30 | Train Loss: 0.4741384 Vali Loss: 0.2598692 Test Loss: 0.3235560
Epoch: 29 cost time: 1.8057529926300049
Epoch: 29, Steps: 30 | Train Loss: 0.4645303 Vali Loss: 0.2501341 Test Loss: 0.3505268
Epoch: 30 cost time: 1.8888154029846191
Epoch: 30, Steps: 30 | Train Loss: 0.4698468 Vali Loss: 0.2431986 Test Loss: 0.3409452
>>>>>>>testing : ETTh2_720_96_SparseTSF_ETTh2_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.337619423866272, mae:0.3742738664150238, rse:0.46826857328414917
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_192', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_192_SparseTSF_ETTh2_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2689
test 2689
Epoch: 1 cost time: 2.818028211593628
Epoch: 1, Steps: 30 | Train Loss: 0.6252142 Vali Loss: 0.3568133 Test Loss: 0.4234553
Epoch: 2 cost time: 1.9094736576080322
Epoch: 2, Steps: 30 | Train Loss: 0.6212046 Vali Loss: 0.3588193 Test Loss: 0.4615282
Epoch: 3 cost time: 1.8591911792755127
Epoch: 3, Steps: 30 | Train Loss: 0.7312695 Vali Loss: 0.4005647 Test Loss: 0.4402638
Epoch: 4 cost time: 1.7854371070861816
Epoch: 4, Steps: 30 | Train Loss: 0.6988770 Vali Loss: 0.3205197 Test Loss: 0.3747459
Epoch: 5 cost time: 1.7992455959320068
Epoch: 5, Steps: 30 | Train Loss: 0.6063813 Vali Loss: 0.3524991 Test Loss: 0.4042227
Epoch: 6 cost time: 1.8718881607055664
Epoch: 6, Steps: 30 | Train Loss: 0.5893728 Vali Loss: 0.3244404 Test Loss: 0.4565830
Epoch: 7 cost time: 1.6959450244903564
Epoch: 7, Steps: 30 | Train Loss: 0.7422311 Vali Loss: 0.4113688 Test Loss: 0.3741325
Epoch: 8 cost time: 1.7212576866149902
Epoch: 8, Steps: 30 | Train Loss: 0.6174917 Vali Loss: 0.2907625 Test Loss: 0.3824640
Epoch: 9 cost time: 1.8569872379302979
Epoch: 9, Steps: 30 | Train Loss: 0.6543378 Vali Loss: 0.4065997 Test Loss: 0.4164006
Epoch: 10 cost time: 2.01250958442688
Epoch: 10, Steps: 30 | Train Loss: 0.6614485 Vali Loss: 0.4923139 Test Loss: 0.4641368
Epoch: 11 cost time: 1.7984569072723389
Epoch: 11, Steps: 30 | Train Loss: 0.6441375 Vali Loss: 0.3768761 Test Loss: 0.4142608
Epoch: 12 cost time: 1.7848548889160156
Epoch: 12, Steps: 30 | Train Loss: 0.6008366 Vali Loss: 0.3279555 Test Loss: 0.4041715
Epoch: 13 cost time: 1.9834628105163574
Epoch: 13, Steps: 30 | Train Loss: 0.5794649 Vali Loss: 0.3221614 Test Loss: 0.4028879
Epoch: 14 cost time: 1.9356656074523926
Epoch: 14, Steps: 30 | Train Loss: 0.6238785 Vali Loss: 0.3596946 Test Loss: 0.5212082
Epoch: 15 cost time: 1.9387545585632324
Epoch: 15, Steps: 30 | Train Loss: 0.6638869 Vali Loss: 0.3132526 Test Loss: 0.3933262
Epoch: 16 cost time: 2.211106300354004
Epoch: 16, Steps: 30 | Train Loss: 0.5922329 Vali Loss: 0.3005168 Test Loss: 0.4538284
Epoch: 17 cost time: 1.9450128078460693
Epoch: 17, Steps: 30 | Train Loss: 0.6806142 Vali Loss: 0.4366156 Test Loss: 0.5196130
Epoch: 18 cost time: 1.8253886699676514
Epoch: 18, Steps: 30 | Train Loss: 0.6689017 Vali Loss: 0.4637526 Test Loss: 0.5256758
Epoch: 19 cost time: 1.8424222469329834
Epoch: 19, Steps: 30 | Train Loss: 0.6624537 Vali Loss: 0.3335389 Test Loss: 0.4432214
Epoch: 20 cost time: 1.9732301235198975
Epoch: 20, Steps: 30 | Train Loss: 0.7576440 Vali Loss: 0.4508192 Test Loss: 0.4020330
Epoch: 21 cost time: 1.8517630100250244
Epoch: 21, Steps: 30 | Train Loss: 0.7655245 Vali Loss: 0.5543277 Test Loss: 0.4391720
Epoch: 22 cost time: 1.8457708358764648
Epoch: 22, Steps: 30 | Train Loss: 0.5877922 Vali Loss: 0.3560202 Test Loss: 0.4505421
Epoch: 23 cost time: 1.9872121810913086
Epoch: 23, Steps: 30 | Train Loss: 0.6110164 Vali Loss: 0.3733706 Test Loss: 0.4326583
Epoch: 24 cost time: 1.9458050727844238
Epoch: 24, Steps: 30 | Train Loss: 0.6305131 Vali Loss: 0.3123795 Test Loss: 0.3870655
Epoch: 25 cost time: 1.811680555343628
Epoch: 25, Steps: 30 | Train Loss: 0.5982501 Vali Loss: 0.2964573 Test Loss: 0.4105111
Epoch: 26 cost time: 2.0404231548309326
Epoch: 26, Steps: 30 | Train Loss: 0.5834640 Vali Loss: 0.3136270 Test Loss: 0.4273444
Epoch: 27 cost time: 1.7069039344787598
Epoch: 27, Steps: 30 | Train Loss: 0.6119183 Vali Loss: 0.2980137 Test Loss: 0.3798755
Epoch: 28 cost time: 1.9729101657867432
Epoch: 28, Steps: 30 | Train Loss: 0.6272068 Vali Loss: 0.3630719 Test Loss: 0.4338689
Epoch: 29 cost time: 1.8123819828033447
Epoch: 29, Steps: 30 | Train Loss: 0.5992081 Vali Loss: 0.3705153 Test Loss: 0.4852169
Epoch: 30 cost time: 1.9647436141967773
Epoch: 30, Steps: 30 | Train Loss: 0.6203135 Vali Loss: 0.4208578 Test Loss: 0.4736959
>>>>>>>testing : ETTh2_720_192_SparseTSF_ETTh2_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.44588005542755127, mae:0.43397051095962524, rse:0.5354881882667542
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_336', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 3.0369086265563965
Epoch: 1, Steps: 29 | Train Loss: 0.7556563 Vali Loss: 0.4761322 Test Loss: 0.4176778
Epoch: 2 cost time: 2.173469305038452
Epoch: 2, Steps: 29 | Train Loss: 0.7701066 Vali Loss: 0.4463924 Test Loss: 0.3829872
Epoch: 3 cost time: 1.9834682941436768
Epoch: 3, Steps: 29 | Train Loss: 0.7605547 Vali Loss: 0.4634879 Test Loss: 0.3544042
Epoch: 4 cost time: 2.024527072906494
Epoch: 4, Steps: 29 | Train Loss: 0.7632164 Vali Loss: 0.5273987 Test Loss: 0.3883513
Epoch: 5 cost time: 2.2097063064575195
Epoch: 5, Steps: 29 | Train Loss: 0.6956277 Vali Loss: 0.4183815 Test Loss: 0.3948359
Epoch: 6 cost time: 2.1406280994415283
Epoch: 6, Steps: 29 | Train Loss: 0.7071226 Vali Loss: 0.4521786 Test Loss: 0.4506941
Epoch: 7 cost time: 2.104400157928467
Epoch: 7, Steps: 29 | Train Loss: 0.7983894 Vali Loss: 0.5546718 Test Loss: 0.3723889
Epoch: 8 cost time: 2.1852710247039795
Epoch: 8, Steps: 29 | Train Loss: 0.7695683 Vali Loss: 0.4461266 Test Loss: 0.3798780
Epoch: 9 cost time: 2.0900661945343018
Epoch: 9, Steps: 29 | Train Loss: 0.8536354 Vali Loss: 0.5383646 Test Loss: 0.3759145
Epoch: 10 cost time: 2.029722213745117
Epoch: 10, Steps: 29 | Train Loss: 0.8425489 Vali Loss: 0.5576318 Test Loss: 0.3720009
Epoch: 11 cost time: 1.9853312969207764
Epoch: 11, Steps: 29 | Train Loss: 0.7258103 Vali Loss: 0.5602344 Test Loss: 0.4857222
Epoch: 12 cost time: 2.1291444301605225
Epoch: 12, Steps: 29 | Train Loss: 0.7705879 Vali Loss: 0.4183974 Test Loss: 0.4155748
Epoch: 13 cost time: 2.077838182449341
Epoch: 13, Steps: 29 | Train Loss: 0.7810599 Vali Loss: 0.4231743 Test Loss: 0.3497980
Epoch: 14 cost time: 1.978419303894043
Epoch: 14, Steps: 29 | Train Loss: 0.7015423 Vali Loss: 0.4307020 Test Loss: 0.3531647
Epoch: 15 cost time: 2.0392398834228516
Epoch: 15, Steps: 29 | Train Loss: 0.6829071 Vali Loss: 0.4258508 Test Loss: 0.3792134
Epoch: 16 cost time: 1.9710655212402344
Epoch: 16, Steps: 29 | Train Loss: 0.6510975 Vali Loss: 0.4368871 Test Loss: 0.4364220
Epoch: 17 cost time: 2.0787243843078613
Epoch: 17, Steps: 29 | Train Loss: 0.6678845 Vali Loss: 0.5010915 Test Loss: 0.5338279
Epoch: 18 cost time: 2.1307857036590576
Epoch: 18, Steps: 29 | Train Loss: 0.8006231 Vali Loss: 0.5493948 Test Loss: 0.3754259
Epoch: 19 cost time: 1.9922852516174316
Epoch: 19, Steps: 29 | Train Loss: 0.6634228 Vali Loss: 0.4162912 Test Loss: 0.3783186
Epoch: 20 cost time: 1.9249563217163086
Epoch: 20, Steps: 29 | Train Loss: 0.6788336 Vali Loss: 0.4931610 Test Loss: 0.5012435
Epoch: 21 cost time: 2.1015400886535645
Epoch: 21, Steps: 29 | Train Loss: 0.7735423 Vali Loss: 0.4336759 Test Loss: 0.3520704
Epoch: 22 cost time: 1.9267292022705078
Epoch: 22, Steps: 29 | Train Loss: 0.7335258 Vali Loss: 0.4295172 Test Loss: 0.3654345
Epoch: 23 cost time: 1.902684211730957
Epoch: 23, Steps: 29 | Train Loss: 0.6791056 Vali Loss: 0.4522410 Test Loss: 0.4470412
Epoch: 24 cost time: 2.003568410873413
Epoch: 24, Steps: 29 | Train Loss: 0.6566525 Vali Loss: 0.4872317 Test Loss: 0.5048343
Epoch: 25 cost time: 2.1963958740234375
Epoch: 25, Steps: 29 | Train Loss: 0.7248253 Vali Loss: 0.4270183 Test Loss: 0.4432011
Epoch: 26 cost time: 2.012805461883545
Epoch: 26, Steps: 29 | Train Loss: 0.8188291 Vali Loss: 0.4523935 Test Loss: 0.3800085
Epoch: 27 cost time: 2.202237129211426
Epoch: 27, Steps: 29 | Train Loss: 0.7227591 Vali Loss: 0.4421766 Test Loss: 0.3602025
Epoch: 28 cost time: 2.081907033920288
Epoch: 28, Steps: 29 | Train Loss: 0.7413866 Vali Loss: 0.6332033 Test Loss: 0.6462326
Epoch: 29 cost time: 1.9192407131195068
Epoch: 29, Steps: 29 | Train Loss: 0.7178292 Vali Loss: 0.5368364 Test Loss: 0.5684521
Epoch: 30 cost time: 1.933664083480835
Epoch: 30, Steps: 29 | Train Loss: 0.8230564 Vali Loss: 0.5522923 Test Loss: 0.3741769
>>>>>>>testing : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.3713405728340149, mae:0.41512203216552734, rse:0.48722073435783386
Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_720', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTh2_720_720_SparseTSF_ETTh2_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
Epoch: 1 cost time: 3.633631944656372
Epoch: 1, Steps: 28 | Train Loss: 0.9468126 Vali Loss: 0.7227762 Test Loss: 0.4150753
Epoch: 2 cost time: 2.7407784461975098
Epoch: 2, Steps: 28 | Train Loss: 0.9720576 Vali Loss: 0.7389739 Test Loss: 0.4255534
Epoch: 3 cost time: 3.033045530319214
Epoch: 3, Steps: 28 | Train Loss: 0.9273489 Vali Loss: 0.6698235 Test Loss: 0.4201518
Epoch: 4 cost time: 2.9059345722198486
Epoch: 4, Steps: 28 | Train Loss: 0.9297701 Vali Loss: 0.7544861 Test Loss: 0.4234208
Epoch: 5 cost time: 2.905785322189331
Epoch: 5, Steps: 28 | Train Loss: 0.8781033 Vali Loss: 0.7252153 Test Loss: 0.4552219
Epoch: 6 cost time: 3.0140631198883057
Epoch: 6, Steps: 28 | Train Loss: 0.9387465 Vali Loss: 0.7571945 Test Loss: 0.4226316
Epoch: 7 cost time: 3.0302670001983643
Epoch: 7, Steps: 28 | Train Loss: 0.8904423 Vali Loss: 0.6984481 Test Loss: 0.4170157
Epoch: 8 cost time: 3.05244779586792
Epoch: 8, Steps: 28 | Train Loss: 0.8743463 Vali Loss: 0.6712421 Test Loss: 0.3983358
Epoch: 9 cost time: 2.7829439640045166
Epoch: 9, Steps: 28 | Train Loss: 0.9644017 Vali Loss: 0.7982317 Test Loss: 0.4341198
Epoch: 10 cost time: 2.9419143199920654
Epoch: 10, Steps: 28 | Train Loss: 0.9294123 Vali Loss: 0.7406022 Test Loss: 0.4367658
Epoch: 11 cost time: 3.072890281677246
Epoch: 11, Steps: 28 | Train Loss: 0.9264691 Vali Loss: 0.7596589 Test Loss: 0.4345510
Epoch: 12 cost time: 2.918243885040283
Epoch: 12, Steps: 28 | Train Loss: 0.8884997 Vali Loss: 0.6791104 Test Loss: 0.4297870
Epoch: 13 cost time: 2.8681745529174805
Epoch: 13, Steps: 28 | Train Loss: 1.0070261 Vali Loss: 0.7184620 Test Loss: 0.4118505
Epoch: 14 cost time: 3.023864507675171
Epoch: 14, Steps: 28 | Train Loss: 0.9760066 Vali Loss: 0.7511425 Test Loss: 0.4173471
Epoch: 15 cost time: 2.954399585723877
Epoch: 15, Steps: 28 | Train Loss: 0.9336299 Vali Loss: 0.7245981 Test Loss: 0.4581136
Epoch: 16 cost time: 2.8813886642456055
Epoch: 16, Steps: 28 | Train Loss: 1.1352506 Vali Loss: 0.7573377 Test Loss: 0.4059313
Epoch: 17 cost time: 2.845742702484131
Epoch: 17, Steps: 28 | Train Loss: 1.2192208 Vali Loss: 0.7114905 Test Loss: 0.4084804
Epoch: 18 cost time: 3.095926284790039
Epoch: 18, Steps: 28 | Train Loss: 0.8745004 Vali Loss: 0.7134677 Test Loss: 0.4543492
Epoch: 19 cost time: 3.157601833343506
Epoch: 19, Steps: 28 | Train Loss: 0.9126390 Vali Loss: 0.6861259 Test Loss: 0.4146979
Epoch: 20 cost time: 3.0286977291107178
Epoch: 20, Steps: 28 | Train Loss: 0.8764514 Vali Loss: 0.6589693 Test Loss: 0.4090318
Epoch: 21 cost time: 3.0938992500305176
Epoch: 21, Steps: 28 | Train Loss: 1.0207950 Vali Loss: 0.7400545 Test Loss: 0.4137107
Epoch: 22 cost time: 3.081587553024292
Epoch: 22, Steps: 28 | Train Loss: 0.9136004 Vali Loss: 0.6878483 Test Loss: 0.4174516
Epoch: 23 cost time: 3.0168521404266357
Epoch: 23, Steps: 28 | Train Loss: 0.9180833 Vali Loss: 0.6956472 Test Loss: 0.4580925
Epoch: 24 cost time: 2.889503002166748
Epoch: 24, Steps: 28 | Train Loss: 0.9878731 Vali Loss: 0.7147505 Test Loss: 0.4075903
Epoch: 25 cost time: 2.9694628715515137
Epoch: 25, Steps: 28 | Train Loss: 0.8718394 Vali Loss: 0.7595872 Test Loss: 0.4820614
Epoch: 26 cost time: 2.8611698150634766
Epoch: 26, Steps: 28 | Train Loss: 0.8890422 Vali Loss: 0.7414557 Test Loss: 0.4741940
Epoch: 27 cost time: 2.9843690395355225
Epoch: 27, Steps: 28 | Train Loss: 1.0188423 Vali Loss: 0.7721788 Test Loss: 0.4242605
Epoch: 28 cost time: 2.922607183456421
Epoch: 28, Steps: 28 | Train Loss: 0.9279996 Vali Loss: 0.6952084 Test Loss: 0.4000821
Epoch: 29 cost time: 2.967449426651001
Epoch: 29, Steps: 28 | Train Loss: 0.8767089 Vali Loss: 0.7089007 Test Loss: 0.4430565
Epoch: 30 cost time: 3.0495612621307373
Epoch: 30, Steps: 28 | Train Loss: 0.9253818 Vali Loss: 0.7416039 Test Loss: 0.4175900
>>>>>>>testing : ETTh2_720_720_SparseTSF_ETTh2_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.40149882435798645, mae:0.44240155816078186, rse:0.5064631700515747
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_96', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6589780
	speed: 0.1338s/iter; left time: 512.5695s
Epoch: 1 cost time: 9.345412731170654
Epoch: 1, Steps: 131 | Train Loss: 0.3599530 Vali Loss: 0.5022938 Test Loss: 0.4047187
	iters: 100, epoch: 2 | loss: 0.6595509
	speed: 0.1246s/iter; left time: 460.9216s
Epoch: 2 cost time: 7.1938982009887695
Epoch: 2, Steps: 131 | Train Loss: 0.3341143 Vali Loss: 0.5063021 Test Loss: 0.4159591
	iters: 100, epoch: 3 | loss: 0.6682825
	speed: 0.1192s/iter; left time: 425.2998s
Epoch: 3 cost time: 7.508049249649048
Epoch: 3, Steps: 131 | Train Loss: 0.3280939 Vali Loss: 0.4899949 Test Loss: 0.4027717
	iters: 100, epoch: 4 | loss: 0.7018257
	speed: 0.1170s/iter; left time: 402.1953s
Epoch: 4 cost time: 7.166223526000977
Epoch: 4, Steps: 131 | Train Loss: 0.3217445 Vali Loss: 0.4643812 Test Loss: 0.3807974
	iters: 100, epoch: 5 | loss: 0.7618882
	speed: 0.1192s/iter; left time: 394.2646s
Epoch: 5 cost time: 7.198301315307617
Epoch: 5, Steps: 131 | Train Loss: 0.3168752 Vali Loss: 0.4414860 Test Loss: 0.3644475
	iters: 100, epoch: 6 | loss: 0.8037142
	speed: 0.1150s/iter; left time: 365.2480s
Epoch: 6 cost time: 7.08667254447937
Epoch: 6, Steps: 131 | Train Loss: 0.3117815 Vali Loss: 0.4283134 Test Loss: 0.3575523
	iters: 100, epoch: 7 | loss: 0.8066770
	speed: 0.1182s/iter; left time: 359.8924s
Epoch: 7 cost time: 7.042925834655762
Epoch: 7, Steps: 131 | Train Loss: 0.3065696 Vali Loss: 0.4217454 Test Loss: 0.3545222
	iters: 100, epoch: 8 | loss: 0.7838616
	speed: 0.1164s/iter; left time: 339.2413s
Epoch: 8 cost time: 6.99415397644043
Epoch: 8, Steps: 131 | Train Loss: 0.3024630 Vali Loss: 0.4168726 Test Loss: 0.3502263
	iters: 100, epoch: 9 | loss: 0.7573794
	speed: 0.1143s/iter; left time: 318.2220s
Epoch: 9 cost time: 6.902962923049927
Epoch: 9, Steps: 131 | Train Loss: 0.2995112 Vali Loss: 0.4128822 Test Loss: 0.3450741
	iters: 100, epoch: 10 | loss: 0.7408853
	speed: 0.1161s/iter; left time: 307.8781s
Epoch: 10 cost time: 7.164750337600708
Epoch: 10, Steps: 131 | Train Loss: 0.2977279 Vali Loss: 0.4104955 Test Loss: 0.3413995
	iters: 100, epoch: 11 | loss: 0.7326877
	speed: 0.1195s/iter; left time: 301.3289s
Epoch: 11 cost time: 7.248844861984253
Epoch: 11, Steps: 131 | Train Loss: 0.2967610 Vali Loss: 0.4092022 Test Loss: 0.3392648
	iters: 100, epoch: 12 | loss: 0.7286261
	speed: 0.1154s/iter; left time: 275.8015s
Epoch: 12 cost time: 7.0661468505859375
Epoch: 12, Steps: 131 | Train Loss: 0.2961923 Vali Loss: 0.4084601 Test Loss: 0.3380107
	iters: 100, epoch: 13 | loss: 0.7265726
	speed: 0.1151s/iter; left time: 259.9663s
Epoch: 13 cost time: 6.887506484985352
Epoch: 13, Steps: 131 | Train Loss: 0.2958227 Vali Loss: 0.4079926 Test Loss: 0.3372118
	iters: 100, epoch: 14 | loss: 0.7255627
	speed: 0.1156s/iter; left time: 246.0147s
Epoch: 14 cost time: 6.901411771774292
Epoch: 14, Steps: 131 | Train Loss: 0.2955661 Vali Loss: 0.4076674 Test Loss: 0.3366487
	iters: 100, epoch: 15 | loss: 0.7251406
	speed: 0.1154s/iter; left time: 230.3895s
Epoch: 15 cost time: 7.104573726654053
Epoch: 15, Steps: 131 | Train Loss: 0.2953821 Vali Loss: 0.4074214 Test Loss: 0.3362120
	iters: 100, epoch: 16 | loss: 0.7250777
	speed: 0.1166s/iter; left time: 217.6369s
Epoch: 16 cost time: 6.988592624664307
Epoch: 16, Steps: 131 | Train Loss: 0.2952497 Vali Loss: 0.4072244 Test Loss: 0.3358475
	iters: 100, epoch: 17 | loss: 0.7252506
	speed: 0.1170s/iter; left time: 202.9859s
Epoch: 17 cost time: 7.206918239593506
Epoch: 17, Steps: 131 | Train Loss: 0.2951569 Vali Loss: 0.4070611 Test Loss: 0.3355284
	iters: 100, epoch: 18 | loss: 0.7255870
	speed: 0.1140s/iter; left time: 182.8521s
Epoch: 18 cost time: 6.839090585708618
Epoch: 18, Steps: 131 | Train Loss: 0.2950956 Vali Loss: 0.4069233 Test Loss: 0.3352411
	iters: 100, epoch: 19 | loss: 0.7260401
	speed: 0.1180s/iter; left time: 173.8041s
Epoch: 19 cost time: 7.3103296756744385
Epoch: 19, Steps: 131 | Train Loss: 0.2950598 Vali Loss: 0.4068059 Test Loss: 0.3349787
	iters: 100, epoch: 20 | loss: 0.7265753
	speed: 0.1159s/iter; left time: 155.4835s
Epoch: 20 cost time: 7.059693813323975
Epoch: 20, Steps: 131 | Train Loss: 0.2950444 Vali Loss: 0.4067053 Test Loss: 0.3347374
	iters: 100, epoch: 21 | loss: 0.7271668
	speed: 0.1184s/iter; left time: 143.3638s
Epoch: 21 cost time: 7.169772624969482
Epoch: 21, Steps: 131 | Train Loss: 0.2950450 Vali Loss: 0.4066188 Test Loss: 0.3345152
	iters: 100, epoch: 22 | loss: 0.7277935
	speed: 0.1166s/iter; left time: 125.9373s
Epoch: 22 cost time: 7.158904552459717
Epoch: 22, Steps: 131 | Train Loss: 0.2950579 Vali Loss: 0.4065445 Test Loss: 0.3343105
	iters: 100, epoch: 23 | loss: 0.7284389
	speed: 0.1175s/iter; left time: 111.5175s
Epoch: 23 cost time: 7.118764877319336
Epoch: 23, Steps: 131 | Train Loss: 0.2950799 Vali Loss: 0.4064805 Test Loss: 0.3341223
	iters: 100, epoch: 24 | loss: 0.7290887
	speed: 0.1130s/iter; left time: 92.4183s
Epoch: 24 cost time: 6.89591121673584
Epoch: 24, Steps: 131 | Train Loss: 0.2951085 Vali Loss: 0.4064252 Test Loss: 0.3339495
	iters: 100, epoch: 25 | loss: 0.7297326
	speed: 0.1216s/iter; left time: 83.5622s
Epoch: 25 cost time: 7.592738389968872
Epoch: 25, Steps: 131 | Train Loss: 0.2951415 Vali Loss: 0.4063775 Test Loss: 0.3337911
	iters: 100, epoch: 26 | loss: 0.7303606
	speed: 0.1173s/iter; left time: 65.2334s
Epoch: 26 cost time: 7.09271240234375
Epoch: 26, Steps: 131 | Train Loss: 0.2951771 Vali Loss: 0.4063361 Test Loss: 0.3336461
	iters: 100, epoch: 27 | loss: 0.7309669
	speed: 0.1187s/iter; left time: 50.4588s
Epoch: 27 cost time: 7.273449420928955
Epoch: 27, Steps: 131 | Train Loss: 0.2952141 Vali Loss: 0.4063002 Test Loss: 0.3335137
	iters: 100, epoch: 28 | loss: 0.7315474
	speed: 0.1153s/iter; left time: 33.8945s
Epoch: 28 cost time: 6.800495624542236
Epoch: 28, Steps: 131 | Train Loss: 0.2952514 Vali Loss: 0.4062689 Test Loss: 0.3333926
	iters: 100, epoch: 29 | loss: 0.7320981
	speed: 0.1170s/iter; left time: 19.0756s
Epoch: 29 cost time: 7.169828176498413
Epoch: 29, Steps: 131 | Train Loss: 0.2952881 Vali Loss: 0.4062411 Test Loss: 0.3332819
	iters: 100, epoch: 30 | loss: 0.7326172
	speed: 0.1172s/iter; left time: 3.7511s
Epoch: 30 cost time: 7.17413330078125
Epoch: 30, Steps: 131 | Train Loss: 0.2953237 Vali Loss: 0.4062171 Test Loss: 0.3331811
>>>>>>>testing : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.33282631635665894, mae:0.36755648255348206, rse:0.5489600300788879
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_192', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_192_SparseTSF_ETTm1_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.7412019
	speed: 0.1298s/iter; left time: 497.3218s
Epoch: 1 cost time: 8.78747010231018
Epoch: 1, Steps: 131 | Train Loss: 0.4029292 Vali Loss: 0.6012672 Test Loss: 0.4139555
	iters: 100, epoch: 2 | loss: 0.6867953
	speed: 0.1390s/iter; left time: 514.3711s
Epoch: 2 cost time: 8.006059408187866
Epoch: 2, Steps: 131 | Train Loss: 0.3831422 Vali Loss: 0.6132023 Test Loss: 0.4361408
	iters: 100, epoch: 3 | loss: 0.6928056
	speed: 0.1275s/iter; left time: 454.9946s
Epoch: 3 cost time: 7.893742322921753
Epoch: 3, Steps: 131 | Train Loss: 0.3772921 Vali Loss: 0.5938233 Test Loss: 0.4196637
	iters: 100, epoch: 4 | loss: 0.7063169
	speed: 0.1314s/iter; left time: 451.6935s
Epoch: 4 cost time: 8.150707006454468
Epoch: 4, Steps: 131 | Train Loss: 0.3722057 Vali Loss: 0.5815794 Test Loss: 0.4086965
	iters: 100, epoch: 5 | loss: 0.7145866
	speed: 0.1321s/iter; left time: 436.8359s
Epoch: 5 cost time: 8.043053150177002
Epoch: 5, Steps: 131 | Train Loss: 0.3676498 Vali Loss: 0.5772505 Test Loss: 0.4067614
	iters: 100, epoch: 6 | loss: 0.7219024
	speed: 0.1295s/iter; left time: 411.1736s
Epoch: 6 cost time: 7.7940919399261475
Epoch: 6, Steps: 131 | Train Loss: 0.3628253 Vali Loss: 0.5747976 Test Loss: 0.4065628
	iters: 100, epoch: 7 | loss: 0.7312787
	speed: 0.1275s/iter; left time: 388.2228s
Epoch: 7 cost time: 7.769148588180542
Epoch: 7, Steps: 131 | Train Loss: 0.3581325 Vali Loss: 0.5722012 Test Loss: 0.4055697
	iters: 100, epoch: 8 | loss: 0.7411531
	speed: 0.1268s/iter; left time: 369.4747s
Epoch: 8 cost time: 7.729304790496826
Epoch: 8, Steps: 131 | Train Loss: 0.3538320 Vali Loss: 0.5693892 Test Loss: 0.4039752
	iters: 100, epoch: 9 | loss: 0.7486004
	speed: 0.1269s/iter; left time: 353.2371s
Epoch: 9 cost time: 7.724860429763794
Epoch: 9, Steps: 131 | Train Loss: 0.3498652 Vali Loss: 0.5666919 Test Loss: 0.4024521
	iters: 100, epoch: 10 | loss: 0.7528216
	speed: 0.1318s/iter; left time: 349.4129s
Epoch: 10 cost time: 8.271254062652588
Epoch: 10, Steps: 131 | Train Loss: 0.3463742 Vali Loss: 0.5640540 Test Loss: 0.4010330
	iters: 100, epoch: 11 | loss: 0.7549791
	speed: 0.1309s/iter; left time: 329.9506s
Epoch: 11 cost time: 7.693664789199829
Epoch: 11, Steps: 131 | Train Loss: 0.3435081 Vali Loss: 0.5612479 Test Loss: 0.3992905
	iters: 100, epoch: 12 | loss: 0.7558858
	speed: 0.1260s/iter; left time: 301.1239s
Epoch: 12 cost time: 7.631845951080322
Epoch: 12, Steps: 131 | Train Loss: 0.3412835 Vali Loss: 0.5584174 Test Loss: 0.3972170
	iters: 100, epoch: 13 | loss: 0.7558993
	speed: 0.1275s/iter; left time: 287.9877s
Epoch: 13 cost time: 7.788569927215576
Epoch: 13, Steps: 131 | Train Loss: 0.3396346 Vali Loss: 0.5558534 Test Loss: 0.3951131
	iters: 100, epoch: 14 | loss: 0.7553411
	speed: 0.1278s/iter; left time: 271.8829s
Epoch: 14 cost time: 8.068176746368408
Epoch: 14, Steps: 131 | Train Loss: 0.3384475 Vali Loss: 0.5536694 Test Loss: 0.3931693
	iters: 100, epoch: 15 | loss: 0.7545297
	speed: 0.1322s/iter; left time: 263.9393s
Epoch: 15 cost time: 7.967801094055176
Epoch: 15, Steps: 131 | Train Loss: 0.3375926 Vali Loss: 0.5518069 Test Loss: 0.3913923
	iters: 100, epoch: 16 | loss: 0.7536784
	speed: 0.1258s/iter; left time: 234.7270s
Epoch: 16 cost time: 7.625349044799805
Epoch: 16, Steps: 131 | Train Loss: 0.3369564 Vali Loss: 0.5501651 Test Loss: 0.3897213
	iters: 100, epoch: 17 | loss: 0.7528846
	speed: 0.1271s/iter; left time: 220.5810s
Epoch: 17 cost time: 7.6559858322143555
Epoch: 17, Steps: 131 | Train Loss: 0.3364587 Vali Loss: 0.5486728 Test Loss: 0.3881119
	iters: 100, epoch: 18 | loss: 0.7521800
	speed: 0.1278s/iter; left time: 204.9195s
Epoch: 18 cost time: 7.709167242050171
Epoch: 18, Steps: 131 | Train Loss: 0.3360530 Vali Loss: 0.5472979 Test Loss: 0.3865531
	iters: 100, epoch: 19 | loss: 0.7515690
	speed: 0.1259s/iter; left time: 185.4650s
Epoch: 19 cost time: 7.698359966278076
Epoch: 19, Steps: 131 | Train Loss: 0.3357148 Vali Loss: 0.5460328 Test Loss: 0.3850565
	iters: 100, epoch: 20 | loss: 0.7510464
	speed: 0.1290s/iter; left time: 173.0837s
Epoch: 20 cost time: 7.935564279556274
Epoch: 20, Steps: 131 | Train Loss: 0.3354317 Vali Loss: 0.5448803 Test Loss: 0.3836408
	iters: 100, epoch: 21 | loss: 0.7506037
	speed: 0.1290s/iter; left time: 156.2190s
Epoch: 21 cost time: 7.898152589797974
Epoch: 21, Steps: 131 | Train Loss: 0.3351966 Vali Loss: 0.5438433 Test Loss: 0.3823236
	iters: 100, epoch: 22 | loss: 0.7502310
	speed: 0.1267s/iter; left time: 136.8171s
Epoch: 22 cost time: 7.630126714706421
Epoch: 22, Steps: 131 | Train Loss: 0.3350042 Vali Loss: 0.5429215 Test Loss: 0.3811167
	iters: 100, epoch: 23 | loss: 0.7499188
	speed: 0.1295s/iter; left time: 122.8846s
Epoch: 23 cost time: 8.042024374008179
Epoch: 23, Steps: 131 | Train Loss: 0.3348494 Vali Loss: 0.5421105 Test Loss: 0.3800249
	iters: 100, epoch: 24 | loss: 0.7496588
	speed: 0.1300s/iter; left time: 106.3499s
Epoch: 24 cost time: 7.877601146697998
Epoch: 24, Steps: 131 | Train Loss: 0.3347269 Vali Loss: 0.5414021 Test Loss: 0.3790470
	iters: 100, epoch: 25 | loss: 0.7494433
	speed: 0.1328s/iter; left time: 91.2357s
Epoch: 25 cost time: 8.19160509109497
Epoch: 25, Steps: 131 | Train Loss: 0.3346322 Vali Loss: 0.5407865 Test Loss: 0.3781776
	iters: 100, epoch: 26 | loss: 0.7492663
	speed: 0.1285s/iter; left time: 71.4674s
Epoch: 26 cost time: 8.028902530670166
Epoch: 26, Steps: 131 | Train Loss: 0.3345605 Vali Loss: 0.5402529 Test Loss: 0.3774082
	iters: 100, epoch: 27 | loss: 0.7491224
	speed: 0.1266s/iter; left time: 53.8184s
Epoch: 27 cost time: 7.699086666107178
Epoch: 27, Steps: 131 | Train Loss: 0.3345076 Vali Loss: 0.5397909 Test Loss: 0.3767292
	iters: 100, epoch: 28 | loss: 0.7490063
	speed: 0.1292s/iter; left time: 37.9813s
Epoch: 28 cost time: 7.889052391052246
Epoch: 28, Steps: 131 | Train Loss: 0.3344698 Vali Loss: 0.5393903 Test Loss: 0.3761307
	iters: 100, epoch: 29 | loss: 0.7489141
	speed: 0.1302s/iter; left time: 21.2279s
Epoch: 29 cost time: 8.123280763626099
Epoch: 29, Steps: 131 | Train Loss: 0.3344441 Vali Loss: 0.5390426 Test Loss: 0.3756028
	iters: 100, epoch: 30 | loss: 0.7488416
	speed: 0.1287s/iter; left time: 4.1172s
Epoch: 30 cost time: 7.833813428878784
Epoch: 30, Steps: 131 | Train Loss: 0.3344277 Vali Loss: 0.5387400 Test Loss: 0.3751369
>>>>>>>testing : ETTm1_720_192_SparseTSF_ETTm1_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3731345534324646, mae:0.3888683617115021, rse:0.5814792513847351
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_336', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_336_SparseTSF_ETTm1_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6717774
	speed: 0.1457s/iter; left time: 553.8407s
Epoch: 1 cost time: 9.575096845626831
Epoch: 1, Steps: 130 | Train Loss: 0.4262187 Vali Loss: 0.7685918 Test Loss: 0.4759890
	iters: 100, epoch: 2 | loss: 0.6514256
	speed: 0.1475s/iter; left time: 541.4366s
Epoch: 2 cost time: 8.661672115325928
Epoch: 2, Steps: 130 | Train Loss: 0.4254992 Vali Loss: 0.7529224 Test Loss: 0.4544335
	iters: 100, epoch: 3 | loss: 0.6464081
	speed: 0.1422s/iter; left time: 503.4160s
Epoch: 3 cost time: 8.559253215789795
Epoch: 3, Steps: 130 | Train Loss: 0.4199991 Vali Loss: 0.7450031 Test Loss: 0.4511883
	iters: 100, epoch: 4 | loss: 0.7010747
	speed: 0.1405s/iter; left time: 479.4081s
Epoch: 4 cost time: 8.47046446800232
Epoch: 4, Steps: 130 | Train Loss: 0.4108081 Vali Loss: 0.7252012 Test Loss: 0.4217017
	iters: 100, epoch: 5 | loss: 0.6995788
	speed: 0.1423s/iter; left time: 466.9079s
Epoch: 5 cost time: 8.784071207046509
Epoch: 5, Steps: 130 | Train Loss: 0.4037482 Vali Loss: 0.7335302 Test Loss: 0.4337198
	iters: 100, epoch: 6 | loss: 0.7000015
	speed: 0.1405s/iter; left time: 442.7378s
Epoch: 6 cost time: 8.428326845169067
Epoch: 6, Steps: 130 | Train Loss: 0.3971407 Vali Loss: 0.7538181 Test Loss: 0.4559042
	iters: 100, epoch: 7 | loss: 0.7015833
	speed: 0.1403s/iter; left time: 423.7131s
Epoch: 7 cost time: 8.418351411819458
Epoch: 7, Steps: 130 | Train Loss: 0.3918642 Vali Loss: 0.7762406 Test Loss: 0.4805179
	iters: 100, epoch: 8 | loss: 0.7041892
	speed: 0.1414s/iter; left time: 408.6687s
Epoch: 8 cost time: 8.731494903564453
Epoch: 8, Steps: 130 | Train Loss: 0.3875772 Vali Loss: 0.7824348 Test Loss: 0.4899804
	iters: 100, epoch: 9 | loss: 0.7044116
	speed: 0.1420s/iter; left time: 392.0856s
Epoch: 9 cost time: 8.516005992889404
Epoch: 9, Steps: 130 | Train Loss: 0.3840614 Vali Loss: 0.7764458 Test Loss: 0.4863613
	iters: 100, epoch: 10 | loss: 0.7035899
	speed: 0.1457s/iter; left time: 383.3052s
Epoch: 10 cost time: 8.804961919784546
Epoch: 10, Steps: 130 | Train Loss: 0.3813117 Vali Loss: 0.7651671 Test Loss: 0.4744554
	iters: 100, epoch: 11 | loss: 0.7072842
	speed: 0.1401s/iter; left time: 350.4227s
Epoch: 11 cost time: 8.450968265533447
Epoch: 11, Steps: 130 | Train Loss: 0.3799337 Vali Loss: 0.7472565 Test Loss: 0.4520239
	iters: 100, epoch: 12 | loss: 0.7203183
	speed: 0.1397s/iter; left time: 331.1381s
Epoch: 12 cost time: 8.459058284759521
Epoch: 12, Steps: 130 | Train Loss: 0.3807364 Vali Loss: 0.7230781 Test Loss: 0.4226884
	iters: 100, epoch: 13 | loss: 0.7301297
	speed: 0.1401s/iter; left time: 313.9872s
Epoch: 13 cost time: 8.62876558303833
Epoch: 13, Steps: 130 | Train Loss: 0.3817154 Vali Loss: 0.7113188 Test Loss: 0.4092748
	iters: 100, epoch: 14 | loss: 0.7364486
	speed: 0.1438s/iter; left time: 303.5024s
Epoch: 14 cost time: 8.496464252471924
Epoch: 14, Steps: 130 | Train Loss: 0.3821273 Vali Loss: 0.7061077 Test Loss: 0.4036618
	iters: 100, epoch: 15 | loss: 0.7402468
	speed: 0.1422s/iter; left time: 281.7168s
Epoch: 15 cost time: 8.59604024887085
Epoch: 15, Steps: 130 | Train Loss: 0.3822026 Vali Loss: 0.7032320 Test Loss: 0.4010377
	iters: 100, epoch: 16 | loss: 0.7421021
	speed: 0.1400s/iter; left time: 259.1515s
Epoch: 16 cost time: 8.548582077026367
Epoch: 16, Steps: 130 | Train Loss: 0.3820529 Vali Loss: 0.7014214 Test Loss: 0.3999746
	iters: 100, epoch: 17 | loss: 0.7429210
	speed: 0.1402s/iter; left time: 241.3456s
Epoch: 17 cost time: 8.46150541305542
Epoch: 17, Steps: 130 | Train Loss: 0.3818078 Vali Loss: 0.7001233 Test Loss: 0.3997148
	iters: 100, epoch: 18 | loss: 0.7432092
	speed: 0.1421s/iter; left time: 226.0327s
Epoch: 18 cost time: 8.627690076828003
Epoch: 18, Steps: 130 | Train Loss: 0.3815377 Vali Loss: 0.6991212 Test Loss: 0.3999838
	iters: 100, epoch: 19 | loss: 0.7431554
	speed: 0.1397s/iter; left time: 204.0755s
Epoch: 19 cost time: 8.434547424316406
Epoch: 19, Steps: 130 | Train Loss: 0.3812590 Vali Loss: 0.6983570 Test Loss: 0.4007618
	iters: 100, epoch: 20 | loss: 0.7427700
	speed: 0.1391s/iter; left time: 185.0930s
Epoch: 20 cost time: 8.388407945632935
Epoch: 20, Steps: 130 | Train Loss: 0.3809582 Vali Loss: 0.6978724 Test Loss: 0.4021584
	iters: 100, epoch: 21 | loss: 0.7419689
	speed: 0.1419s/iter; left time: 170.4427s
Epoch: 21 cost time: 8.570823669433594
Epoch: 21, Steps: 130 | Train Loss: 0.3806075 Vali Loss: 0.6978037 Test Loss: 0.4043575
	iters: 100, epoch: 22 | loss: 0.7406126
	speed: 0.1407s/iter; left time: 150.6657s
Epoch: 22 cost time: 8.432254552841187
Epoch: 22, Steps: 130 | Train Loss: 0.3801713 Vali Loss: 0.6984121 Test Loss: 0.4076081
	iters: 100, epoch: 23 | loss: 0.7385371
	speed: 0.1396s/iter; left time: 131.3588s
Epoch: 23 cost time: 8.505680799484253
Epoch: 23, Steps: 130 | Train Loss: 0.3796114 Vali Loss: 0.7001547 Test Loss: 0.4122722
	iters: 100, epoch: 24 | loss: 0.7356022
	speed: 0.1407s/iter; left time: 114.0881s
Epoch: 24 cost time: 8.44707202911377
Epoch: 24, Steps: 130 | Train Loss: 0.3788936 Vali Loss: 0.7037911 Test Loss: 0.4189464
	iters: 100, epoch: 25 | loss: 0.7317809
	speed: 0.1442s/iter; left time: 98.2279s
Epoch: 25 cost time: 8.830973863601685
Epoch: 25, Steps: 130 | Train Loss: 0.3779964 Vali Loss: 0.7103963 Test Loss: 0.4285326
	iters: 100, epoch: 26 | loss: 0.7272763
	speed: 0.1420s/iter; left time: 78.2468s
Epoch: 26 cost time: 8.57274317741394
Epoch: 26, Steps: 130 | Train Loss: 0.3769187 Vali Loss: 0.7207836 Test Loss: 0.4416971
	iters: 100, epoch: 27 | loss: 0.7226389
	speed: 0.1408s/iter; left time: 59.2671s
Epoch: 27 cost time: 8.638002872467041
Epoch: 27, Steps: 130 | Train Loss: 0.3756970 Vali Loss: 0.7338073 Test Loss: 0.4571407
	iters: 100, epoch: 28 | loss: 0.7187895
	speed: 0.1412s/iter; left time: 41.0909s
Epoch: 28 cost time: 8.54688811302185
Epoch: 28, Steps: 130 | Train Loss: 0.3744547 Vali Loss: 0.7451746 Test Loss: 0.4703836
	iters: 100, epoch: 29 | loss: 0.7167245
	speed: 0.1388s/iter; left time: 22.3512s
Epoch: 29 cost time: 8.444122314453125
Epoch: 29, Steps: 130 | Train Loss: 0.3734540 Vali Loss: 0.7502729 Test Loss: 0.4763369
	iters: 100, epoch: 30 | loss: 0.7168432
	speed: 0.1428s/iter; left time: 4.4265s
Epoch: 30 cost time: 8.585426568984985
Epoch: 30, Steps: 130 | Train Loss: 0.3730144 Vali Loss: 0.7485578 Test Loss: 0.4726966
>>>>>>>testing : ETTm1_720_336_SparseTSF_ETTm1_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4720187783241272, mae:0.4486289918422699, rse:0.6537744998931885
Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_720', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm1_720_720_SparseTSF_ETTm1_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5463569
	speed: 0.1945s/iter; left time: 733.4369s
Epoch: 1 cost time: 13.627026081085205
Epoch: 1, Steps: 129 | Train Loss: 0.5085519 Vali Loss: 1.0618079 Test Loss: 0.5323494
	iters: 100, epoch: 2 | loss: 0.5295401
	speed: 0.2084s/iter; left time: 758.9077s
Epoch: 2 cost time: 12.982844352722168
Epoch: 2, Steps: 129 | Train Loss: 0.4832660 Vali Loss: 1.1046532 Test Loss: 0.5679604
	iters: 100, epoch: 3 | loss: 0.5356769
	speed: 0.2051s/iter; left time: 720.6792s
Epoch: 3 cost time: 12.90157675743103
Epoch: 3, Steps: 129 | Train Loss: 0.4733475 Vali Loss: 1.0655674 Test Loss: 0.5267870
	iters: 100, epoch: 4 | loss: 0.5636367
	speed: 0.2029s/iter; left time: 686.4589s
Epoch: 4 cost time: 12.942371606826782
Epoch: 4, Steps: 129 | Train Loss: 0.4629795 Vali Loss: 1.0511209 Test Loss: 0.5058511
	iters: 100, epoch: 5 | loss: 0.5702855
	speed: 0.2041s/iter; left time: 664.2972s
Epoch: 5 cost time: 13.095290660858154
Epoch: 5, Steps: 129 | Train Loss: 0.4540794 Vali Loss: 1.0627264 Test Loss: 0.5087968
	iters: 100, epoch: 6 | loss: 0.5413929
	speed: 0.2020s/iter; left time: 631.3926s
Epoch: 6 cost time: 12.921377420425415
Epoch: 6, Steps: 129 | Train Loss: 0.4454469 Vali Loss: 1.0555925 Test Loss: 0.4990078
	iters: 100, epoch: 7 | loss: 0.5153199
	speed: 0.2039s/iter; left time: 611.0968s
Epoch: 7 cost time: 13.033524990081787
Epoch: 7, Steps: 129 | Train Loss: 0.4416209 Vali Loss: 1.0810275 Test Loss: 0.5107295
	iters: 100, epoch: 8 | loss: 0.5355576
	speed: 0.2010s/iter; left time: 576.5224s
Epoch: 8 cost time: 12.889442682266235
Epoch: 8, Steps: 129 | Train Loss: 0.4395359 Vali Loss: 1.0583649 Test Loss: 0.4801862
	iters: 100, epoch: 9 | loss: 0.5277095
	speed: 0.2046s/iter; left time: 560.3806s
Epoch: 9 cost time: 12.933517217636108
Epoch: 9, Steps: 129 | Train Loss: 0.4356786 Vali Loss: 1.0672292 Test Loss: 0.4925305
	iters: 100, epoch: 10 | loss: 0.5218078
	speed: 0.2092s/iter; left time: 545.9478s
Epoch: 10 cost time: 13.407987356185913
Epoch: 10, Steps: 129 | Train Loss: 0.4340470 Vali Loss: 1.0728880 Test Loss: 0.4992129
	iters: 100, epoch: 11 | loss: 0.5203466
	speed: 0.2052s/iter; left time: 509.1868s
Epoch: 11 cost time: 12.983070611953735
Epoch: 11, Steps: 129 | Train Loss: 0.4326373 Vali Loss: 1.0722539 Test Loss: 0.4996840
	iters: 100, epoch: 12 | loss: 0.5193886
	speed: 0.2023s/iter; left time: 475.7279s
Epoch: 12 cost time: 12.957136631011963
Epoch: 12, Steps: 129 | Train Loss: 0.4318130 Vali Loss: 1.0713552 Test Loss: 0.4993753
	iters: 100, epoch: 13 | loss: 0.5191308
	speed: 0.2038s/iter; left time: 453.1195s
Epoch: 13 cost time: 12.973954916000366
Epoch: 13, Steps: 129 | Train Loss: 0.4312647 Vali Loss: 1.0698041 Test Loss: 0.4980915
	iters: 100, epoch: 14 | loss: 0.5191997
	speed: 0.1999s/iter; left time: 418.5686s
Epoch: 14 cost time: 12.888556480407715
Epoch: 14, Steps: 129 | Train Loss: 0.4308961 Vali Loss: 1.0682024 Test Loss: 0.4965048
	iters: 100, epoch: 15 | loss: 0.5195296
	speed: 0.2099s/iter; left time: 412.3572s
Epoch: 15 cost time: 13.07905125617981
Epoch: 15, Steps: 129 | Train Loss: 0.4306309 Vali Loss: 1.0665724 Test Loss: 0.4947082
	iters: 100, epoch: 16 | loss: 0.5200099
	speed: 0.2012s/iter; left time: 369.3631s
Epoch: 16 cost time: 12.96709418296814
Epoch: 16, Steps: 129 | Train Loss: 0.4304345 Vali Loss: 1.0650079 Test Loss: 0.4928429
	iters: 100, epoch: 17 | loss: 0.5205905
	speed: 0.2041s/iter; left time: 348.4733s
Epoch: 17 cost time: 12.954336404800415
Epoch: 17, Steps: 129 | Train Loss: 0.4302861 Vali Loss: 1.0635160 Test Loss: 0.4909538
	iters: 100, epoch: 18 | loss: 0.5212355
	speed: 0.2038s/iter; left time: 321.5890s
Epoch: 18 cost time: 12.95559048652649
Epoch: 18, Steps: 129 | Train Loss: 0.4301739 Vali Loss: 1.0621004 Test Loss: 0.4890762
	iters: 100, epoch: 19 | loss: 0.5219246
	speed: 0.2020s/iter; left time: 292.7344s
Epoch: 19 cost time: 12.96481990814209
Epoch: 19, Steps: 129 | Train Loss: 0.4300902 Vali Loss: 1.0607535 Test Loss: 0.4872286
	iters: 100, epoch: 20 | loss: 0.5226425
	speed: 0.2030s/iter; left time: 267.9440s
Epoch: 20 cost time: 13.163378477096558
Epoch: 20, Steps: 129 | Train Loss: 0.4300295 Vali Loss: 1.0594676 Test Loss: 0.4854252
	iters: 100, epoch: 21 | loss: 0.5233768
	speed: 0.2026s/iter; left time: 241.2959s
Epoch: 21 cost time: 13.017807722091675
Epoch: 21, Steps: 129 | Train Loss: 0.4299872 Vali Loss: 1.0582367 Test Loss: 0.4836777
	iters: 100, epoch: 22 | loss: 0.5241180
	speed: 0.2025s/iter; left time: 215.0417s
Epoch: 22 cost time: 12.94982647895813
Epoch: 22, Steps: 129 | Train Loss: 0.4299601 Vali Loss: 1.0570558 Test Loss: 0.4819938
	iters: 100, epoch: 23 | loss: 0.5248586
	speed: 0.2025s/iter; left time: 188.9293s
Epoch: 23 cost time: 12.939900398254395
Epoch: 23, Steps: 129 | Train Loss: 0.4299447 Vali Loss: 1.0559201 Test Loss: 0.4803776
	iters: 100, epoch: 24 | loss: 0.5255914
	speed: 0.2026s/iter; left time: 162.8852s
Epoch: 24 cost time: 12.851927995681763
Epoch: 24, Steps: 129 | Train Loss: 0.4299388 Vali Loss: 1.0548288 Test Loss: 0.4788330
	iters: 100, epoch: 25 | loss: 0.5263144
	speed: 0.2019s/iter; left time: 136.2598s
Epoch: 25 cost time: 13.024688482284546
Epoch: 25, Steps: 129 | Train Loss: 0.4299402 Vali Loss: 1.0537759 Test Loss: 0.4773562
	iters: 100, epoch: 26 | loss: 0.5270249
	speed: 0.2040s/iter; left time: 111.3961s
Epoch: 26 cost time: 13.082815647125244
Epoch: 26, Steps: 129 | Train Loss: 0.4299473 Vali Loss: 1.0527622 Test Loss: 0.4759478
	iters: 100, epoch: 27 | loss: 0.5277207
	speed: 0.2025s/iter; left time: 84.4587s
Epoch: 27 cost time: 12.992948770523071
Epoch: 27, Steps: 129 | Train Loss: 0.4299589 Vali Loss: 1.0517857 Test Loss: 0.4746041
	iters: 100, epoch: 28 | loss: 0.5284047
	speed: 0.2033s/iter; left time: 58.5597s
Epoch: 28 cost time: 12.945350646972656
Epoch: 28, Steps: 129 | Train Loss: 0.4299743 Vali Loss: 1.0508438 Test Loss: 0.4733205
	iters: 100, epoch: 29 | loss: 0.5290754
	speed: 0.2040s/iter; left time: 32.4410s
Epoch: 29 cost time: 13.044190168380737
Epoch: 29, Steps: 129 | Train Loss: 0.4299927 Vali Loss: 1.0499367 Test Loss: 0.4720939
	iters: 100, epoch: 30 | loss: 0.5297348
	speed: 0.2030s/iter; left time: 6.0896s
Epoch: 30 cost time: 12.856013298034668
Epoch: 30, Steps: 129 | Train Loss: 0.4300138 Vali Loss: 1.0490631 Test Loss: 0.4709212
>>>>>>>testing : ETTm1_720_720_SparseTSF_ETTm1_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4664353132247925, mae:0.4461958110332489, rse:0.6497802138328552
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_96', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_96_SparseTSF_ETTm2_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1078935
	speed: 0.1187s/iter; left time: 454.7599s
Epoch: 1 cost time: 7.801525592803955
Epoch: 1, Steps: 131 | Train Loss: 0.3380516 Vali Loss: 0.2719789 Test Loss: 0.3310325
	iters: 100, epoch: 2 | loss: 0.1165895
	speed: 0.1191s/iter; left time: 440.6375s
Epoch: 2 cost time: 6.859700918197632
Epoch: 2, Steps: 131 | Train Loss: 0.3248065 Vali Loss: 0.2058311 Test Loss: 0.2663886
	iters: 100, epoch: 3 | loss: 0.1108922
	speed: 0.1175s/iter; left time: 419.2615s
Epoch: 3 cost time: 7.249376535415649
Epoch: 3, Steps: 131 | Train Loss: 0.3953693 Vali Loss: 0.3316385 Test Loss: 0.4132193
	iters: 100, epoch: 4 | loss: 0.1065296
	speed: 0.1179s/iter; left time: 405.3339s
Epoch: 4 cost time: 7.179654598236084
Epoch: 4, Steps: 131 | Train Loss: 0.3949010 Vali Loss: 0.2234688 Test Loss: 0.2794946
	iters: 100, epoch: 5 | loss: 0.1308960
	speed: 0.1203s/iter; left time: 397.8092s
Epoch: 5 cost time: 7.319852352142334
Epoch: 5, Steps: 131 | Train Loss: 0.2964129 Vali Loss: 0.1688109 Test Loss: 0.2245648
	iters: 100, epoch: 6 | loss: 0.0990362
	speed: 0.1168s/iter; left time: 370.8892s
Epoch: 6 cost time: 7.068544864654541
Epoch: 6, Steps: 131 | Train Loss: 0.3724872 Vali Loss: 0.2736950 Test Loss: 0.3808258
	iters: 100, epoch: 7 | loss: 0.1183605
	speed: 0.1130s/iter; left time: 344.2143s
Epoch: 7 cost time: 6.771953582763672
Epoch: 7, Steps: 131 | Train Loss: 0.2849797 Vali Loss: 0.1652419 Test Loss: 0.2190039
	iters: 100, epoch: 8 | loss: 0.0930296
	speed: 0.1105s/iter; left time: 321.9824s
Epoch: 8 cost time: 6.720912218093872
Epoch: 8, Steps: 131 | Train Loss: 0.3541525 Vali Loss: 0.2830340 Test Loss: 0.3814065
	iters: 100, epoch: 9 | loss: 0.1132008
	speed: 0.1203s/iter; left time: 334.8576s
Epoch: 9 cost time: 7.2620744705200195
Epoch: 9, Steps: 131 | Train Loss: 0.2773028 Vali Loss: 0.1558231 Test Loss: 0.2087215
	iters: 100, epoch: 10 | loss: 0.0965378
	speed: 0.1147s/iter; left time: 304.2047s
Epoch: 10 cost time: 6.867065906524658
Epoch: 10, Steps: 131 | Train Loss: 0.2986963 Vali Loss: 0.2238352 Test Loss: 0.2964617
	iters: 100, epoch: 11 | loss: 0.1101423
	speed: 0.1173s/iter; left time: 295.6470s
Epoch: 11 cost time: 7.230132341384888
Epoch: 11, Steps: 131 | Train Loss: 0.2676220 Vali Loss: 0.1661613 Test Loss: 0.2166553
	iters: 100, epoch: 12 | loss: 0.1085739
	speed: 0.1132s/iter; left time: 270.4484s
Epoch: 12 cost time: 6.645982027053833
Epoch: 12, Steps: 131 | Train Loss: 0.2670056 Vali Loss: 0.1870186 Test Loss: 0.2419197
	iters: 100, epoch: 13 | loss: 0.1068935
	speed: 0.1134s/iter; left time: 256.2083s
Epoch: 13 cost time: 6.6079511642456055
Epoch: 13, Steps: 131 | Train Loss: 0.2625739 Vali Loss: 0.1849300 Test Loss: 0.2391433
	iters: 100, epoch: 14 | loss: 0.1052210
	speed: 0.1150s/iter; left time: 244.7249s
Epoch: 14 cost time: 7.056903123855591
Epoch: 14, Steps: 131 | Train Loss: 0.2617003 Vali Loss: 0.1899042 Test Loss: 0.2458941
	iters: 100, epoch: 15 | loss: 0.1031093
	speed: 0.1180s/iter; left time: 235.7255s
Epoch: 15 cost time: 7.056281805038452
Epoch: 15, Steps: 131 | Train Loss: 0.2615771 Vali Loss: 0.1904073 Test Loss: 0.2470763
	iters: 100, epoch: 16 | loss: 0.1015107
	speed: 0.1184s/iter; left time: 220.9294s
Epoch: 16 cost time: 7.395665168762207
Epoch: 16, Steps: 131 | Train Loss: 0.2607220 Vali Loss: 0.1874053 Test Loss: 0.2440146
	iters: 100, epoch: 17 | loss: 0.0991494
	speed: 0.1154s/iter; left time: 200.2850s
Epoch: 17 cost time: 6.922969341278076
Epoch: 17, Steps: 131 | Train Loss: 0.2574176 Vali Loss: 0.1802559 Test Loss: 0.2354429
	iters: 100, epoch: 18 | loss: 0.0948870
	speed: 0.1179s/iter; left time: 189.0620s
Epoch: 18 cost time: 7.162710905075073
Epoch: 18, Steps: 131 | Train Loss: 0.2502366 Vali Loss: 0.1672137 Test Loss: 0.2195904
	iters: 100, epoch: 19 | loss: 0.0884517
	speed: 0.1152s/iter; left time: 169.6423s
Epoch: 19 cost time: 6.9589598178863525
Epoch: 19, Steps: 131 | Train Loss: 0.2369152 Vali Loss: 0.1470642 Test Loss: 0.1954378
	iters: 100, epoch: 20 | loss: 0.0873175
	speed: 0.1156s/iter; left time: 155.1892s
Epoch: 20 cost time: 6.8033692836761475
Epoch: 20, Steps: 131 | Train Loss: 0.2332676 Vali Loss: 0.1433334 Test Loss: 0.1913061
	iters: 100, epoch: 21 | loss: 0.0889104
	speed: 0.1134s/iter; left time: 137.3342s
Epoch: 21 cost time: 6.734034538269043
Epoch: 21, Steps: 131 | Train Loss: 0.2324222 Vali Loss: 0.1395403 Test Loss: 0.1871846
	iters: 100, epoch: 22 | loss: 0.0913416
	speed: 0.1127s/iter; left time: 121.7625s
Epoch: 22 cost time: 6.860103130340576
Epoch: 22, Steps: 131 | Train Loss: 0.2317897 Vali Loss: 0.1363007 Test Loss: 0.1833622
	iters: 100, epoch: 23 | loss: 0.0935568
	speed: 0.1152s/iter; left time: 109.3696s
Epoch: 23 cost time: 6.815438508987427
Epoch: 23, Steps: 131 | Train Loss: 0.2321393 Vali Loss: 0.1350168 Test Loss: 0.1818222
	iters: 100, epoch: 24 | loss: 0.0937822
	speed: 0.1123s/iter; left time: 91.8652s
Epoch: 24 cost time: 6.681811332702637
Epoch: 24, Steps: 131 | Train Loss: 0.2333758 Vali Loss: 0.1343412 Test Loss: 0.1811807
	iters: 100, epoch: 25 | loss: 0.0931201
	speed: 0.1140s/iter; left time: 78.3180s
Epoch: 25 cost time: 6.711065053939819
Epoch: 25, Steps: 131 | Train Loss: 0.2342748 Vali Loss: 0.1338676 Test Loss: 0.1807891
	iters: 100, epoch: 26 | loss: 0.0923588
	speed: 0.1118s/iter; left time: 62.1516s
Epoch: 26 cost time: 6.616819620132446
Epoch: 26, Steps: 131 | Train Loss: 0.2348549 Vali Loss: 0.1338053 Test Loss: 0.1808181
	iters: 100, epoch: 27 | loss: 0.0914764
	speed: 0.1134s/iter; left time: 48.1886s
Epoch: 27 cost time: 6.76449728012085
Epoch: 27, Steps: 131 | Train Loss: 0.2350459 Vali Loss: 0.1342934 Test Loss: 0.1814098
	iters: 100, epoch: 28 | loss: 0.0900987
	speed: 0.1165s/iter; left time: 34.2636s
Epoch: 28 cost time: 7.061671018600464
Epoch: 28, Steps: 131 | Train Loss: 0.2344122 Vali Loss: 0.1358281 Test Loss: 0.1830881
	iters: 100, epoch: 29 | loss: 0.0877929
	speed: 0.1138s/iter; left time: 18.5514s
Epoch: 29 cost time: 6.711243629455566
Epoch: 29, Steps: 131 | Train Loss: 0.2325585 Vali Loss: 0.1399086 Test Loss: 0.1873717
	iters: 100, epoch: 30 | loss: 0.0868699
	speed: 0.1165s/iter; left time: 3.7289s
Epoch: 30 cost time: 6.909599542617798
Epoch: 30, Steps: 131 | Train Loss: 0.2316694 Vali Loss: 0.1428548 Test Loss: 0.1905859
>>>>>>>testing : ETTm2_720_96_SparseTSF_ETTm2_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.19142504036426544, mae:0.28473275899887085, rse:0.3547280430793762
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_192', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_192_SparseTSF_ETTm2_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.1240907
	speed: 0.1290s/iter; left time: 494.1817s
Epoch: 1 cost time: 8.714320421218872
Epoch: 1, Steps: 131 | Train Loss: 0.4253787 Vali Loss: 0.3606177 Test Loss: 0.4367264
	iters: 100, epoch: 2 | loss: 0.1364021
	speed: 0.1378s/iter; left time: 509.6784s
Epoch: 2 cost time: 8.335927724838257
Epoch: 2, Steps: 131 | Train Loss: 0.4381147 Vali Loss: 0.4861440 Test Loss: 0.6797131
	iters: 100, epoch: 3 | loss: 0.1047917
	speed: 0.1307s/iter; left time: 466.4120s
Epoch: 3 cost time: 8.035609722137451
Epoch: 3, Steps: 131 | Train Loss: 0.4468355 Vali Loss: 0.2684205 Test Loss: 0.3406214
	iters: 100, epoch: 4 | loss: 0.1279165
	speed: 0.1343s/iter; left time: 461.8222s
Epoch: 4 cost time: 8.417188167572021
Epoch: 4, Steps: 131 | Train Loss: 0.3853024 Vali Loss: 0.2878749 Test Loss: 0.3656363
	iters: 100, epoch: 5 | loss: 0.1302428
	speed: 0.1330s/iter; left time: 439.6751s
Epoch: 5 cost time: 8.367853164672852
Epoch: 5, Steps: 131 | Train Loss: 0.3898028 Vali Loss: 0.2596311 Test Loss: 0.3237699
	iters: 100, epoch: 6 | loss: 0.1132133
	speed: 0.1292s/iter; left time: 410.2167s
Epoch: 6 cost time: 7.900639295578003
Epoch: 6, Steps: 131 | Train Loss: 0.4440435 Vali Loss: 0.4520387 Test Loss: 0.6829672
	iters: 100, epoch: 7 | loss: 0.1262719
	speed: 0.1306s/iter; left time: 397.7970s
Epoch: 7 cost time: 8.267075061798096
Epoch: 7, Steps: 131 | Train Loss: 0.4484434 Vali Loss: 0.2221543 Test Loss: 0.2909981
	iters: 100, epoch: 8 | loss: 0.1203612
	speed: 0.1359s/iter; left time: 396.0781s
Epoch: 8 cost time: 8.439903736114502
Epoch: 8, Steps: 131 | Train Loss: 0.3924332 Vali Loss: 0.2880569 Test Loss: 0.3694947
	iters: 100, epoch: 9 | loss: 0.1281136
	speed: 0.1330s/iter; left time: 370.0974s
Epoch: 9 cost time: 8.313454627990723
Epoch: 9, Steps: 131 | Train Loss: 0.3848397 Vali Loss: 0.2357152 Test Loss: 0.2951930
	iters: 100, epoch: 10 | loss: 0.1246672
	speed: 0.1312s/iter; left time: 347.8158s
Epoch: 10 cost time: 8.172005891799927
Epoch: 10, Steps: 131 | Train Loss: 0.3620693 Vali Loss: 0.2442022 Test Loss: 0.3122025
	iters: 100, epoch: 11 | loss: 0.1155011
	speed: 0.1323s/iter; left time: 333.5326s
Epoch: 11 cost time: 8.163613080978394
Epoch: 11, Steps: 131 | Train Loss: 0.3614494 Vali Loss: 0.1973005 Test Loss: 0.2543648
	iters: 100, epoch: 12 | loss: 0.1186405
	speed: 0.1337s/iter; left time: 319.4674s
Epoch: 12 cost time: 8.452543497085571
Epoch: 12, Steps: 131 | Train Loss: 0.3433523 Vali Loss: 0.2128651 Test Loss: 0.2728118
	iters: 100, epoch: 13 | loss: 0.1216295
	speed: 0.1302s/iter; left time: 294.1832s
Epoch: 13 cost time: 7.992901086807251
Epoch: 13, Steps: 131 | Train Loss: 0.3492444 Vali Loss: 0.1792532 Test Loss: 0.2358882
	iters: 100, epoch: 14 | loss: 0.1106713
	speed: 0.1322s/iter; left time: 281.4052s
Epoch: 14 cost time: 8.228235006332397
Epoch: 14, Steps: 131 | Train Loss: 0.3403474 Vali Loss: 0.1909731 Test Loss: 0.2488543
	iters: 100, epoch: 15 | loss: 0.1185933
	speed: 0.1305s/iter; left time: 260.5792s
Epoch: 15 cost time: 8.100423097610474
Epoch: 15, Steps: 131 | Train Loss: 0.3446612 Vali Loss: 0.1877168 Test Loss: 0.2473786
	iters: 100, epoch: 16 | loss: 0.1121297
	speed: 0.1309s/iter; left time: 244.3013s
Epoch: 16 cost time: 8.175912618637085
Epoch: 16, Steps: 131 | Train Loss: 0.3399784 Vali Loss: 0.2041387 Test Loss: 0.2658259
	iters: 100, epoch: 17 | loss: 0.1181527
	speed: 0.1320s/iter; left time: 228.9401s
Epoch: 17 cost time: 8.089377164840698
Epoch: 17, Steps: 131 | Train Loss: 0.3536464 Vali Loss: 0.1674812 Test Loss: 0.2259977
	iters: 100, epoch: 18 | loss: 0.1076806
	speed: 0.1306s/iter; left time: 209.4239s
Epoch: 18 cost time: 8.288423299789429
Epoch: 18, Steps: 131 | Train Loss: 0.3364561 Vali Loss: 0.1871656 Test Loss: 0.2454465
	iters: 100, epoch: 19 | loss: 0.1278971
	speed: 0.1329s/iter; left time: 195.7998s
Epoch: 19 cost time: 8.007468700408936
Epoch: 19, Steps: 131 | Train Loss: 0.3377587 Vali Loss: 0.1784249 Test Loss: 0.2353387
	iters: 100, epoch: 20 | loss: 0.1137064
	speed: 0.1308s/iter; left time: 175.4794s
Epoch: 20 cost time: 8.116232633590698
Epoch: 20, Steps: 131 | Train Loss: 0.3642351 Vali Loss: 0.2303608 Test Loss: 0.3037044
	iters: 100, epoch: 21 | loss: 0.1059397
	speed: 0.1327s/iter; left time: 160.6668s
Epoch: 21 cost time: 8.26736855506897
Epoch: 21, Steps: 131 | Train Loss: 0.3658319 Vali Loss: 0.2255377 Test Loss: 0.2983905
	iters: 100, epoch: 22 | loss: 0.1097249
	speed: 0.1318s/iter; left time: 142.3753s
Epoch: 22 cost time: 8.407583236694336
Epoch: 22, Steps: 131 | Train Loss: 0.3592298 Vali Loss: 0.2043433 Test Loss: 0.2720338
	iters: 100, epoch: 23 | loss: 0.1102382
	speed: 0.1328s/iter; left time: 126.0077s
Epoch: 23 cost time: 8.291204929351807
Epoch: 23, Steps: 131 | Train Loss: 0.3466993 Vali Loss: 0.1845923 Test Loss: 0.2458121
	iters: 100, epoch: 24 | loss: 0.1095884
	speed: 0.1296s/iter; left time: 105.9962s
Epoch: 24 cost time: 7.960559606552124
Epoch: 24, Steps: 131 | Train Loss: 0.3427227 Vali Loss: 0.1907599 Test Loss: 0.2524242
	iters: 100, epoch: 25 | loss: 0.1084484
	speed: 0.1294s/iter; left time: 88.8719s
Epoch: 25 cost time: 7.910693168640137
Epoch: 25, Steps: 131 | Train Loss: 0.3388171 Vali Loss: 0.1963028 Test Loss: 0.2586072
	iters: 100, epoch: 26 | loss: 0.1093768
	speed: 0.1342s/iter; left time: 74.5903s
Epoch: 26 cost time: 8.461384534835815
Epoch: 26, Steps: 131 | Train Loss: 0.3392167 Vali Loss: 0.1993440 Test Loss: 0.2607251
	iters: 100, epoch: 27 | loss: 0.1225816
	speed: 0.1305s/iter; left time: 55.4497s
Epoch: 27 cost time: 8.128293991088867
Epoch: 27, Steps: 131 | Train Loss: 0.3483527 Vali Loss: 0.1667572 Test Loss: 0.2251047
	iters: 100, epoch: 28 | loss: 0.1061992
	speed: 0.1319s/iter; left time: 38.7843s
Epoch: 28 cost time: 7.983595132827759
Epoch: 28, Steps: 131 | Train Loss: 0.3416674 Vali Loss: 0.2005994 Test Loss: 0.2651781
	iters: 100, epoch: 29 | loss: 0.1112095
	speed: 0.1319s/iter; left time: 21.4954s
Epoch: 29 cost time: 8.25421690940857
Epoch: 29, Steps: 131 | Train Loss: 0.3394865 Vali Loss: 0.2119869 Test Loss: 0.2781665
	iters: 100, epoch: 30 | loss: 0.1190313
	speed: 0.1303s/iter; left time: 4.1681s
Epoch: 30 cost time: 8.035765647888184
Epoch: 30, Steps: 131 | Train Loss: 0.3488734 Vali Loss: 0.1666842 Test Loss: 0.2266378
>>>>>>>testing : ETTm2_720_192_SparseTSF_ETTm2_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.22872857749462128, mae:0.30218827724456787, rse:0.38712868094444275
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_336', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_336_SparseTSF_ETTm2_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.1335675
	speed: 0.1501s/iter; left time: 570.4901s
Epoch: 1 cost time: 10.18903660774231
Epoch: 1, Steps: 130 | Train Loss: 0.5200197 Vali Loss: 0.2781527 Test Loss: 0.3657074
	iters: 100, epoch: 2 | loss: 0.1350290
	speed: 0.1474s/iter; left time: 541.0865s
Epoch: 2 cost time: 8.678777933120728
Epoch: 2, Steps: 130 | Train Loss: 0.4859452 Vali Loss: 0.2669024 Test Loss: 0.3476411
	iters: 100, epoch: 3 | loss: 0.1435366
	speed: 0.1408s/iter; left time: 498.7395s
Epoch: 3 cost time: 8.397516012191772
Epoch: 3, Steps: 130 | Train Loss: 0.4973433 Vali Loss: 0.3677465 Test Loss: 0.4429636
	iters: 100, epoch: 4 | loss: 0.1473709
	speed: 0.1400s/iter; left time: 477.5819s
Epoch: 4 cost time: 8.471414804458618
Epoch: 4, Steps: 130 | Train Loss: 0.4873016 Vali Loss: 0.2456313 Test Loss: 0.3273232
	iters: 100, epoch: 5 | loss: 0.1460956
	speed: 0.1403s/iter; left time: 460.3438s
Epoch: 5 cost time: 8.806901693344116
Epoch: 5, Steps: 130 | Train Loss: 0.4756214 Vali Loss: 0.2514513 Test Loss: 0.3283851
	iters: 100, epoch: 6 | loss: 0.1435571
	speed: 0.1460s/iter; left time: 460.0724s
Epoch: 6 cost time: 8.637998580932617
Epoch: 6, Steps: 130 | Train Loss: 0.4807212 Vali Loss: 0.2370657 Test Loss: 0.3160010
	iters: 100, epoch: 7 | loss: 0.1425271
	speed: 0.1419s/iter; left time: 428.5896s
Epoch: 7 cost time: 8.61320161819458
Epoch: 7, Steps: 130 | Train Loss: 0.4723143 Vali Loss: 0.2393717 Test Loss: 0.3127971
	iters: 100, epoch: 8 | loss: 0.1376108
	speed: 0.1426s/iter; left time: 412.3224s
Epoch: 8 cost time: 8.942693710327148
Epoch: 8, Steps: 130 | Train Loss: 0.4738120 Vali Loss: 0.2326533 Test Loss: 0.3099002
	iters: 100, epoch: 9 | loss: 0.1339568
	speed: 0.1422s/iter; left time: 392.6440s
Epoch: 9 cost time: 8.48634386062622
Epoch: 9, Steps: 130 | Train Loss: 0.4686704 Vali Loss: 0.2391305 Test Loss: 0.3115528
	iters: 100, epoch: 10 | loss: 0.1297644
	speed: 0.1380s/iter; left time: 362.9906s
Epoch: 10 cost time: 8.463948965072632
Epoch: 10, Steps: 130 | Train Loss: 0.4685793 Vali Loss: 0.2324815 Test Loss: 0.3080053
	iters: 100, epoch: 11 | loss: 0.1202607
	speed: 0.1398s/iter; left time: 349.6391s
Epoch: 11 cost time: 8.290535688400269
Epoch: 11, Steps: 130 | Train Loss: 0.4676812 Vali Loss: 0.2512768 Test Loss: 0.3339336
	iters: 100, epoch: 12 | loss: 0.1123449
	speed: 0.1392s/iter; left time: 330.0375s
Epoch: 12 cost time: 8.412815809249878
Epoch: 12, Steps: 130 | Train Loss: 0.4786444 Vali Loss: 0.2717981 Test Loss: 0.3514033
	iters: 100, epoch: 13 | loss: 0.1110220
	speed: 0.1431s/iter; left time: 320.7306s
Epoch: 13 cost time: 8.923861026763916
Epoch: 13, Steps: 130 | Train Loss: 0.4901683 Vali Loss: 0.2754660 Test Loss: 0.3616462
	iters: 100, epoch: 14 | loss: 0.1246192
	speed: 0.1419s/iter; left time: 299.5137s
Epoch: 14 cost time: 8.44944167137146
Epoch: 14, Steps: 130 | Train Loss: 0.4473287 Vali Loss: 0.2532141 Test Loss: 0.3328466
	iters: 100, epoch: 15 | loss: 0.1253203
	speed: 0.1484s/iter; left time: 294.0546s
Epoch: 15 cost time: 9.367702960968018
Epoch: 15, Steps: 130 | Train Loss: 0.4396950 Vali Loss: 0.2632796 Test Loss: 0.3478256
	iters: 100, epoch: 16 | loss: 0.1259714
	speed: 0.1526s/iter; left time: 282.4487s
Epoch: 16 cost time: 8.418667793273926
Epoch: 16, Steps: 130 | Train Loss: 0.4418520 Vali Loss: 0.2968054 Test Loss: 0.3944414
	iters: 100, epoch: 17 | loss: 0.1106182
	speed: 0.1393s/iter; left time: 239.7144s
Epoch: 17 cost time: 8.562617301940918
Epoch: 17, Steps: 130 | Train Loss: 0.5141227 Vali Loss: 0.4854361 Test Loss: 0.6561319
	iters: 100, epoch: 18 | loss: 0.1189175
	speed: 0.1385s/iter; left time: 220.3046s
Epoch: 18 cost time: 8.31308364868164
Epoch: 18, Steps: 130 | Train Loss: 0.4745750 Vali Loss: 0.3651903 Test Loss: 0.5059031
	iters: 100, epoch: 19 | loss: 0.1024112
	speed: 0.1413s/iter; left time: 206.4811s
Epoch: 19 cost time: 8.722044706344604
Epoch: 19, Steps: 130 | Train Loss: 0.4662970 Vali Loss: 0.2299748 Test Loss: 0.3112580
	iters: 100, epoch: 20 | loss: 0.1069155
	speed: 0.1410s/iter; left time: 187.6160s
Epoch: 20 cost time: 8.644764184951782
Epoch: 20, Steps: 130 | Train Loss: 0.4606218 Vali Loss: 0.6740887 Test Loss: 0.9181616
	iters: 100, epoch: 21 | loss: 0.1150771
	speed: 0.1449s/iter; left time: 174.0804s
Epoch: 21 cost time: 8.901922225952148
Epoch: 21, Steps: 130 | Train Loss: 0.5014812 Vali Loss: 0.3588346 Test Loss: 0.5016671
	iters: 100, epoch: 22 | loss: 0.1040347
	speed: 0.1402s/iter; left time: 150.1326s
Epoch: 22 cost time: 8.480558156967163
Epoch: 22, Steps: 130 | Train Loss: 0.4653095 Vali Loss: 0.2293472 Test Loss: 0.3103596
	iters: 100, epoch: 23 | loss: 0.1111276
	speed: 0.1468s/iter; left time: 138.1438s
Epoch: 23 cost time: 8.97163987159729
Epoch: 23, Steps: 130 | Train Loss: 0.4455757 Vali Loss: 0.5480000 Test Loss: 0.7474987
	iters: 100, epoch: 24 | loss: 0.1192845
	speed: 0.1386s/iter; left time: 112.3660s
Epoch: 24 cost time: 8.386411666870117
Epoch: 24, Steps: 130 | Train Loss: 0.4542559 Vali Loss: 0.2292231 Test Loss: 0.3066134
	iters: 100, epoch: 25 | loss: 0.1040642
	speed: 0.1420s/iter; left time: 96.6799s
Epoch: 25 cost time: 8.741778373718262
Epoch: 25, Steps: 130 | Train Loss: 0.4351997 Vali Loss: 0.2073634 Test Loss: 0.2831053
	iters: 100, epoch: 26 | loss: 0.1259439
	speed: 0.1413s/iter; left time: 77.8400s
Epoch: 26 cost time: 8.672360897064209
Epoch: 26, Steps: 130 | Train Loss: 0.4285527 Vali Loss: 0.3550261 Test Loss: 0.4923151
	iters: 100, epoch: 27 | loss: 0.0997776
	speed: 0.1422s/iter; left time: 59.8745s
Epoch: 27 cost time: 8.79295015335083
Epoch: 27, Steps: 130 | Train Loss: 0.4648108 Vali Loss: 0.2309179 Test Loss: 0.3121027
	iters: 100, epoch: 28 | loss: 0.1168903
	speed: 0.1413s/iter; left time: 41.1057s
Epoch: 28 cost time: 8.551656246185303
Epoch: 28, Steps: 130 | Train Loss: 0.4405617 Vali Loss: 0.4338138 Test Loss: 0.6005239
	iters: 100, epoch: 29 | loss: 0.1230880
	speed: 0.1411s/iter; left time: 22.7216s
Epoch: 29 cost time: 8.63546895980835
Epoch: 29, Steps: 130 | Train Loss: 0.4515033 Vali Loss: 0.2741783 Test Loss: 0.3761781
	iters: 100, epoch: 30 | loss: 0.1099954
	speed: 0.1410s/iter; left time: 4.3709s
Epoch: 30 cost time: 8.4877769947052
Epoch: 30, Steps: 130 | Train Loss: 0.4648164 Vali Loss: 0.2304338 Test Loss: 0.3105566
>>>>>>>testing : ETTm2_720_336_SparseTSF_ETTm2_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3114123046398163, mae:0.36342647671699524, rse:0.4507425129413605
Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_720', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : ETTm2_720_720_SparseTSF_ETTm2_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.2682465
	speed: 0.1883s/iter; left time: 710.0366s
Epoch: 1 cost time: 12.629939079284668
Epoch: 1, Steps: 129 | Train Loss: 0.6174601 Vali Loss: 0.3298711 Test Loss: 0.4326569
	iters: 100, epoch: 2 | loss: 0.2727619
	speed: 0.1870s/iter; left time: 681.0661s
Epoch: 2 cost time: 11.014861106872559
Epoch: 2, Steps: 129 | Train Loss: 0.5853767 Vali Loss: 0.3974118 Test Loss: 0.4926526
	iters: 100, epoch: 3 | loss: 0.2646627
	speed: 0.1802s/iter; left time: 633.2029s
Epoch: 3 cost time: 11.150649309158325
Epoch: 3, Steps: 129 | Train Loss: 0.6037593 Vali Loss: 0.4790877 Test Loss: 0.5879646
	iters: 100, epoch: 4 | loss: 0.2895591
	speed: 0.1854s/iter; left time: 627.3499s
Epoch: 4 cost time: 11.46499228477478
Epoch: 4, Steps: 129 | Train Loss: 0.6190621 Vali Loss: 0.3268144 Test Loss: 0.4372105
	iters: 100, epoch: 5 | loss: 0.2876375
	speed: 0.1822s/iter; left time: 592.9535s
Epoch: 5 cost time: 10.741165399551392
Epoch: 5, Steps: 129 | Train Loss: 0.6051815 Vali Loss: 0.3343001 Test Loss: 0.4398358
	iters: 100, epoch: 6 | loss: 0.2927854
	speed: 0.1825s/iter; left time: 570.4294s
Epoch: 6 cost time: 11.085057020187378
Epoch: 6, Steps: 129 | Train Loss: 0.5843589 Vali Loss: 0.3036274 Test Loss: 0.4076538
	iters: 100, epoch: 7 | loss: 0.2864174
	speed: 0.1859s/iter; left time: 557.1379s
Epoch: 7 cost time: 11.343612432479858
Epoch: 7, Steps: 129 | Train Loss: 0.5713167 Vali Loss: 0.3811610 Test Loss: 0.4852389
	iters: 100, epoch: 8 | loss: 0.2806171
	speed: 0.1868s/iter; left time: 535.6612s
Epoch: 8 cost time: 11.355476379394531
Epoch: 8, Steps: 129 | Train Loss: 0.5919267 Vali Loss: 0.3514943 Test Loss: 0.4563550
	iters: 100, epoch: 9 | loss: 0.2820772
	speed: 0.1849s/iter; left time: 506.3886s
Epoch: 9 cost time: 11.123543500900269
Epoch: 9, Steps: 129 | Train Loss: 0.5916571 Vali Loss: 0.5588260 Test Loss: 0.7001954
	iters: 100, epoch: 10 | loss: 0.2661329
	speed: 0.1836s/iter; left time: 479.2044s
Epoch: 10 cost time: 11.037302494049072
Epoch: 10, Steps: 129 | Train Loss: 0.5727494 Vali Loss: 0.2889227 Test Loss: 0.3962587
	iters: 100, epoch: 11 | loss: 0.2906640
	speed: 0.1832s/iter; left time: 454.4858s
Epoch: 11 cost time: 11.003471851348877
Epoch: 11, Steps: 129 | Train Loss: 0.5513482 Vali Loss: 0.3315424 Test Loss: 0.4272100
	iters: 100, epoch: 12 | loss: 0.2791083
	speed: 0.1810s/iter; left time: 425.7018s
Epoch: 12 cost time: 10.906271934509277
Epoch: 12, Steps: 129 | Train Loss: 0.5882066 Vali Loss: 0.2977813 Test Loss: 0.3984209
	iters: 100, epoch: 13 | loss: 0.2689803
	speed: 0.1835s/iter; left time: 408.0071s
Epoch: 13 cost time: 11.20105266571045
Epoch: 13, Steps: 129 | Train Loss: 0.5471150 Vali Loss: 0.3010382 Test Loss: 0.3978497
	iters: 100, epoch: 14 | loss: 0.2749712
	speed: 0.1825s/iter; left time: 382.1083s
Epoch: 14 cost time: 11.071463108062744
Epoch: 14, Steps: 129 | Train Loss: 0.5775455 Vali Loss: 0.3113376 Test Loss: 0.4091075
	iters: 100, epoch: 15 | loss: 0.2810226
	speed: 0.1848s/iter; left time: 363.0959s
Epoch: 15 cost time: 11.13634204864502
Epoch: 15, Steps: 129 | Train Loss: 0.5701691 Vali Loss: 0.2945820 Test Loss: 0.4049180
	iters: 100, epoch: 16 | loss: 0.2716743
	speed: 0.1835s/iter; left time: 336.9927s
Epoch: 16 cost time: 10.906728744506836
Epoch: 16, Steps: 129 | Train Loss: 0.5494217 Vali Loss: 0.2884809 Test Loss: 0.3918826
	iters: 100, epoch: 17 | loss: 0.2722749
	speed: 0.1851s/iter; left time: 316.0167s
Epoch: 17 cost time: 11.145336151123047
Epoch: 17, Steps: 129 | Train Loss: 0.5586560 Vali Loss: 0.2925466 Test Loss: 0.3901960
	iters: 100, epoch: 18 | loss: 0.2801538
	speed: 0.1819s/iter; left time: 286.9932s
Epoch: 18 cost time: 11.02813720703125
Epoch: 18, Steps: 129 | Train Loss: 0.6237952 Vali Loss: 0.2955423 Test Loss: 0.3945807
	iters: 100, epoch: 19 | loss: 0.2796387
	speed: 0.1852s/iter; left time: 268.4200s
Epoch: 19 cost time: 11.645127296447754
Epoch: 19, Steps: 129 | Train Loss: 0.5449940 Vali Loss: 0.2973806 Test Loss: 0.4076216
	iters: 100, epoch: 20 | loss: 0.2522382
	speed: 0.1906s/iter; left time: 251.6188s
Epoch: 20 cost time: 11.53122615814209
Epoch: 20, Steps: 129 | Train Loss: 0.5689546 Vali Loss: 0.3506478 Test Loss: 0.4706965
	iters: 100, epoch: 21 | loss: 0.2718989
	speed: 0.1865s/iter; left time: 222.1599s
Epoch: 21 cost time: 11.158578157424927
Epoch: 21, Steps: 129 | Train Loss: 0.5409477 Vali Loss: 0.2920981 Test Loss: 0.4075265
	iters: 100, epoch: 22 | loss: 0.2744140
	speed: 0.1860s/iter; left time: 197.5447s
Epoch: 22 cost time: 11.413731098175049
Epoch: 22, Steps: 129 | Train Loss: 0.5304170 Vali Loss: 0.3018723 Test Loss: 0.4192362
	iters: 100, epoch: 23 | loss: 0.2744935
	speed: 0.1863s/iter; left time: 173.8117s
Epoch: 23 cost time: 11.516335725784302
Epoch: 23, Steps: 129 | Train Loss: 0.5342146 Vali Loss: 0.3280902 Test Loss: 0.4511800
	iters: 100, epoch: 24 | loss: 0.2707732
	speed: 0.1875s/iter; left time: 150.7157s
Epoch: 24 cost time: 11.301740884780884
Epoch: 24, Steps: 129 | Train Loss: 0.5367876 Vali Loss: 0.3230905 Test Loss: 0.4435476
	iters: 100, epoch: 25 | loss: 0.2718424
	speed: 0.1892s/iter; left time: 127.6964s
Epoch: 25 cost time: 11.633115768432617
Epoch: 25, Steps: 129 | Train Loss: 0.5364648 Vali Loss: 0.3185602 Test Loss: 0.4378537
	iters: 100, epoch: 26 | loss: 0.2677757
	speed: 0.1852s/iter; left time: 101.1143s
Epoch: 26 cost time: 11.289814949035645
Epoch: 26, Steps: 129 | Train Loss: 0.5354702 Vali Loss: 0.3020628 Test Loss: 0.4165991
	iters: 100, epoch: 27 | loss: 0.2676486
	speed: 0.1847s/iter; left time: 77.0262s
Epoch: 27 cost time: 11.041364431381226
Epoch: 27, Steps: 129 | Train Loss: 0.5358037 Vali Loss: 0.2986666 Test Loss: 0.4120989
	iters: 100, epoch: 28 | loss: 0.2666356
	speed: 0.1968s/iter; left time: 56.6708s
Epoch: 28 cost time: 12.452343940734863
Epoch: 28, Steps: 129 | Train Loss: 0.5360534 Vali Loss: 0.2888767 Test Loss: 0.3989645
	iters: 100, epoch: 29 | loss: 0.2666641
	speed: 0.1859s/iter; left time: 29.5657s
Epoch: 29 cost time: 11.327990770339966
Epoch: 29, Steps: 129 | Train Loss: 0.5382554 Vali Loss: 0.2825167 Test Loss: 0.3897334
	iters: 100, epoch: 30 | loss: 0.2665097
	speed: 0.1863s/iter; left time: 5.5884s
Epoch: 30 cost time: 11.589672327041626
Epoch: 30, Steps: 129 | Train Loss: 0.5432155 Vali Loss: 0.2775180 Test Loss: 0.3812259
>>>>>>>testing : ETTm2_720_720_SparseTSF_ETTm2_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.3730117678642273, mae:0.39021629095077515, rse:0.4909142553806305
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Epoch: 1 cost time: 178.6274449825287
Epoch: 1, Steps: 89 | Train Loss: 0.3266055 Vali Loss: 0.3552630 Test Loss: 0.4160372
Epoch: 2 cost time: 172.21851348876953
Epoch: 2, Steps: 89 | Train Loss: 0.2639893 Vali Loss: 0.3530054 Test Loss: 0.4144239
Epoch: 3 cost time: 176.88694977760315
Epoch: 3, Steps: 89 | Train Loss: 0.2658203 Vali Loss: 0.3492836 Test Loss: 0.4118483
Epoch: 4 cost time: 185.9019012451172
Epoch: 4, Steps: 89 | Train Loss: 0.2663043 Vali Loss: 0.3487108 Test Loss: 0.4117303
Epoch: 5 cost time: 186.87348866462708
Epoch: 5, Steps: 89 | Train Loss: 0.2665738 Vali Loss: 0.3485804 Test Loss: 0.4119784
Epoch: 6 cost time: 185.52013611793518
Epoch: 6, Steps: 89 | Train Loss: 0.2667293 Vali Loss: 0.3486337 Test Loss: 0.4123079
Epoch: 7 cost time: 187.92693829536438
Epoch: 7, Steps: 89 | Train Loss: 0.2668267 Vali Loss: 0.3487344 Test Loss: 0.4126182
Epoch: 8 cost time: 188.62771463394165
Epoch: 8, Steps: 89 | Train Loss: 0.2668904 Vali Loss: 0.3488416 Test Loss: 0.4128877
Epoch: 9 cost time: 189.74138879776
Epoch: 9, Steps: 89 | Train Loss: 0.2669338 Vali Loss: 0.3489407 Test Loss: 0.4131150
Epoch: 10 cost time: 189.72410917282104
Epoch: 10, Steps: 89 | Train Loss: 0.2669640 Vali Loss: 0.3490278 Test Loss: 0.4133049
Epoch: 11 cost time: 190.09619903564453
Epoch: 11, Steps: 89 | Train Loss: 0.2669856 Vali Loss: 0.3491025 Test Loss: 0.4134634
Epoch: 12 cost time: 189.9651644229889
Epoch: 12, Steps: 89 | Train Loss: 0.2670012 Vali Loss: 0.3491659 Test Loss: 0.4135959
Epoch: 13 cost time: 190.0075147151947
Epoch: 13, Steps: 89 | Train Loss: 0.2670125 Vali Loss: 0.3492197 Test Loss: 0.4137072
Epoch: 14 cost time: 189.87732887268066
Epoch: 14, Steps: 89 | Train Loss: 0.2670209 Vali Loss: 0.3492651 Test Loss: 0.4138011
Epoch: 15 cost time: 190.38383769989014
Epoch: 15, Steps: 89 | Train Loss: 0.2670272 Vali Loss: 0.3493034 Test Loss: 0.4138807
Epoch: 16 cost time: 189.60578775405884
Epoch: 16, Steps: 89 | Train Loss: 0.2670319 Vali Loss: 0.3493360 Test Loss: 0.4139484
Epoch: 17 cost time: 190.1166067123413
Epoch: 17, Steps: 89 | Train Loss: 0.2670354 Vali Loss: 0.3493637 Test Loss: 0.4140063
Epoch: 18 cost time: 190.2423825263977
Epoch: 18, Steps: 89 | Train Loss: 0.2670381 Vali Loss: 0.3493871 Test Loss: 0.4140560
Epoch: 19 cost time: 188.87732243537903
Epoch: 19, Steps: 89 | Train Loss: 0.2670402 Vali Loss: 0.3494071 Test Loss: 0.4140988
Epoch: 20 cost time: 189.8853120803833
Epoch: 20, Steps: 89 | Train Loss: 0.2670417 Vali Loss: 0.3494243 Test Loss: 0.4141358
Epoch: 21 cost time: 189.62689352035522
Epoch: 21, Steps: 89 | Train Loss: 0.2670430 Vali Loss: 0.3494390 Test Loss: 0.4141679
Epoch: 22 cost time: 190.33850955963135
Epoch: 22, Steps: 89 | Train Loss: 0.2670439 Vali Loss: 0.3494515 Test Loss: 0.4141959
Epoch: 23 cost time: 189.36139249801636
Epoch: 23, Steps: 89 | Train Loss: 0.2670447 Vali Loss: 0.3494624 Test Loss: 0.4142203
Epoch: 24 cost time: 189.60551261901855
Epoch: 24, Steps: 89 | Train Loss: 0.2670452 Vali Loss: 0.3494717 Test Loss: 0.4142416
Epoch: 25 cost time: 189.69164490699768
Epoch: 25, Steps: 89 | Train Loss: 0.2670457 Vali Loss: 0.3494797 Test Loss: 0.4142603
Epoch: 26 cost time: 190.21648383140564
Epoch: 26, Steps: 89 | Train Loss: 0.2670461 Vali Loss: 0.3494866 Test Loss: 0.4142768
Epoch: 27 cost time: 190.06874680519104
Epoch: 27, Steps: 89 | Train Loss: 0.2670464 Vali Loss: 0.3494926 Test Loss: 0.4142912
Epoch: 28 cost time: 189.83513879776
Epoch: 28, Steps: 89 | Train Loss: 0.2670466 Vali Loss: 0.3494978 Test Loss: 0.4143040
Epoch: 29 cost time: 190.42936873435974
Epoch: 29, Steps: 89 | Train Loss: 0.2670468 Vali Loss: 0.3495022 Test Loss: 0.4143153
Epoch: 30 cost time: 189.96935439109802
Epoch: 30, Steps: 89 | Train Loss: 0.2670470 Vali Loss: 0.3495061 Test Loss: 0.4143252
>>>>>>>testing : traffic_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
scripts/SparseTSF/linear/traffic.sh: line 13: 102425 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1565
test 3317
Epoch: 1 cost time: 200.15608096122742
Epoch: 1, Steps: 88 | Train Loss: 0.3360535 Vali Loss: 0.3639995 Test Loss: 0.4384142
Epoch: 2 cost time: 198.3162817955017
Epoch: 2, Steps: 88 | Train Loss: 0.2727545 Vali Loss: 0.3849809 Test Loss: 0.4584790
Epoch: 3 cost time: 204.70788168907166
Epoch: 3, Steps: 88 | Train Loss: 0.2741727 Vali Loss: 0.3790156 Test Loss: 0.4519880
Epoch: 4 cost time: 205.98975801467896
Epoch: 4, Steps: 88 | Train Loss: 0.2741815 Vali Loss: 0.3767010 Test Loss: 0.4495248
Epoch: 5 cost time: 207.79395198822021
Epoch: 5, Steps: 88 | Train Loss: 0.2742962 Vali Loss: 0.3756351 Test Loss: 0.4484234
Epoch: 6 cost time: 211.50119471549988
Epoch: 6, Steps: 88 | Train Loss: 0.2743812 Vali Loss: 0.3749551 Test Loss: 0.4477405
Epoch: 7 cost time: 211.2287847995758
Epoch: 7, Steps: 88 | Train Loss: 0.2744379 Vali Loss: 0.3744923 Test Loss: 0.4472874
Epoch: 8 cost time: 211.69063544273376
Epoch: 8, Steps: 88 | Train Loss: 0.2744774 Vali Loss: 0.3741598 Test Loss: 0.4469695
Epoch: 9 cost time: 211.8719880580902
Epoch: 9, Steps: 88 | Train Loss: 0.2745059 Vali Loss: 0.3739121 Test Loss: 0.4467373
Epoch: 10 cost time: 211.73740792274475
Epoch: 10, Steps: 88 | Train Loss: 0.2745267 Vali Loss: 0.3737215 Test Loss: 0.4465618
Epoch: 11 cost time: 212.9620327949524
Epoch: 11, Steps: 88 | Train Loss: 0.2745422 Vali Loss: 0.3735709 Test Loss: 0.4464252
Epoch: 12 cost time: 212.139990568161
Epoch: 12, Steps: 88 | Train Loss: 0.2745537 Vali Loss: 0.3734492 Test Loss: 0.4463161
Epoch: 13 cost time: 211.87666606903076
Epoch: 13, Steps: 88 | Train Loss: 0.2745623 Vali Loss: 0.3733492 Test Loss: 0.4462273
Epoch: 14 cost time: 210.99641728401184
Epoch: 14, Steps: 88 | Train Loss: 0.2745687 Vali Loss: 0.3732655 Test Loss: 0.4461535
Epoch: 15 cost time: 210.21653819084167
Epoch: 15, Steps: 88 | Train Loss: 0.2745735 Vali Loss: 0.3731946 Test Loss: 0.4460912
Epoch: 16 cost time: 212.44456839561462
Epoch: 16, Steps: 88 | Train Loss: 0.2745771 Vali Loss: 0.3731339 Test Loss: 0.4460382
Epoch: 17 cost time: 210.36058950424194
Epoch: 17, Steps: 88 | Train Loss: 0.2745797 Vali Loss: 0.3730814 Test Loss: 0.4459925
Epoch: 18 cost time: 210.79433369636536
Epoch: 18, Steps: 88 | Train Loss: 0.2745817 Vali Loss: 0.3730357 Test Loss: 0.4459526
Epoch: 19 cost time: 211.2183825969696
Epoch: 19, Steps: 88 | Train Loss: 0.2745831 Vali Loss: 0.3729955 Test Loss: 0.4459176
Epoch: 20 cost time: 210.93584322929382
Epoch: 20, Steps: 88 | Train Loss: 0.2745842 Vali Loss: 0.3729601 Test Loss: 0.4458868
Epoch: 21 cost time: 213.19913983345032
Epoch: 21, Steps: 88 | Train Loss: 0.2745849 Vali Loss: 0.3729286 Test Loss: 0.4458593
Epoch: 22 cost time: 210.74685716629028
Epoch: 22, Steps: 88 | Train Loss: 0.2745854 Vali Loss: 0.3729006 Test Loss: 0.4458348
Epoch: 23 cost time: 212.4879059791565
Epoch: 23, Steps: 88 | Train Loss: 0.2745857 Vali Loss: 0.3728756 Test Loss: 0.4458129
Epoch: 24 cost time: 212.27648878097534
Epoch: 24, Steps: 88 | Train Loss: 0.2745859 Vali Loss: 0.3728530 Test Loss: 0.4457932
Epoch: 25 cost time: 211.15438437461853
Epoch: 25, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3728328 Test Loss: 0.4457753
Epoch: 26 cost time: 211.0413315296173
Epoch: 26, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3728146 Test Loss: 0.4457593
Epoch: 27 cost time: 211.39865112304688
Epoch: 27, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3727981 Test Loss: 0.4457447
Epoch: 28 cost time: 210.71708250045776
Epoch: 28, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3727832 Test Loss: 0.4457315
Epoch: 29 cost time: 209.98271822929382
Epoch: 29, Steps: 88 | Train Loss: 0.2745859 Vali Loss: 0.3727696 Test Loss: 0.4457194
Epoch: 30 cost time: 210.71215534210205
Epoch: 30, Steps: 88 | Train Loss: 0.2745858 Vali Loss: 0.3727573 Test Loss: 0.4457085
>>>>>>>testing : traffic_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
scripts/SparseTSF/linear/traffic.sh: line 13: 133874 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1421
test 3173
Epoch: 1 cost time: 260.27128434181213
Epoch: 1, Steps: 87 | Train Loss: 0.3443427 Vali Loss: 0.4043419 Test Loss: 0.4910342
Epoch: 2 cost time: 245.00039291381836
Epoch: 2, Steps: 87 | Train Loss: 0.2946257 Vali Loss: 0.4128924 Test Loss: 0.5010188
Epoch: 3 cost time: 254.99596166610718
Epoch: 3, Steps: 87 | Train Loss: 0.2934018 Vali Loss: 0.4160010 Test Loss: 0.5033123
Epoch: 4 cost time: 252.03505754470825
Epoch: 4, Steps: 87 | Train Loss: 0.2927021 Vali Loss: 0.4163986 Test Loss: 0.5030383
Epoch: 5 cost time: 252.51005625724792
Epoch: 5, Steps: 87 | Train Loss: 0.2922287 Vali Loss: 0.4164222 Test Loss: 0.5026301
Epoch: 6 cost time: 263.56854128837585
Epoch: 6, Steps: 87 | Train Loss: 0.2918818 Vali Loss: 0.4163004 Test Loss: 0.5021969
Epoch: 7 cost time: 262.5116140842438
Epoch: 7, Steps: 87 | Train Loss: 0.2916146 Vali Loss: 0.4161284 Test Loss: 0.5017885
Epoch: 8 cost time: 264.54619431495667
Epoch: 8, Steps: 87 | Train Loss: 0.2914099 Vali Loss: 0.4159523 Test Loss: 0.5014309
Epoch: 9 cost time: 265.71854519844055
Epoch: 9, Steps: 87 | Train Loss: 0.2912512 Vali Loss: 0.4157861 Test Loss: 0.5011221
scripts/SparseTSF/linear/traffic.sh: line 13: 168490 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10841
val 1037
test 2789
scripts/SparseTSF/linear/traffic.sh: line 13: 182440 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2431851
	speed: 1.4459s/iter; left time: 5799.6602s
Epoch: 1 cost time: 102.23373317718506
Epoch: 1, Steps: 137 | Train Loss: 0.2087275 Vali Loss: 0.1414938 Test Loss: 0.1646020
	iters: 100, epoch: 2 | loss: 0.1923705
	speed: 1.4070s/iter; left time: 5450.5850s
Epoch: 2 cost time: 97.23059153556824
Epoch: 2, Steps: 137 | Train Loss: 0.1524391 Vali Loss: 0.1282468 Test Loss: 0.1532815
	iters: 100, epoch: 3 | loss: 0.1905833
	speed: 1.3799s/iter; left time: 5156.5950s
Epoch: 3 cost time: 96.72317171096802
Epoch: 3, Steps: 137 | Train Loss: 0.1517104 Vali Loss: 0.1324147 Test Loss: 0.1571408
	iters: 100, epoch: 4 | loss: 0.1950833
	speed: 1.3709s/iter; left time: 4935.3078s
Epoch: 4 cost time: 96.32569336891174
Epoch: 4, Steps: 137 | Train Loss: 0.1523264 Vali Loss: 0.1353960 Test Loss: 0.1602241
	iters: 100, epoch: 5 | loss: 0.1976405
	speed: 1.3759s/iter; left time: 4764.8151s
Epoch: 5 cost time: 96.91231060028076
Epoch: 5, Steps: 137 | Train Loss: 0.1528485 Vali Loss: 0.1370019 Test Loss: 0.1620244
	iters: 100, epoch: 6 | loss: 0.1981079
	speed: 1.3839s/iter; left time: 4602.8858s
Epoch: 6 cost time: 98.70768642425537
Epoch: 6, Steps: 137 | Train Loss: 0.1532264 Vali Loss: 0.1376725 Test Loss: 0.1628503
	iters: 100, epoch: 7 | loss: 0.1980499
	speed: 1.3869s/iter; left time: 4422.9112s
Epoch: 7 cost time: 97.07519292831421
Epoch: 7, Steps: 137 | Train Loss: 0.1534604 Vali Loss: 0.1379176 Test Loss: 0.1632065
	iters: 100, epoch: 8 | loss: 0.1979304
	speed: 1.3699s/iter; left time: 4180.9625s
Epoch: 8 cost time: 96.12250137329102
Epoch: 8, Steps: 137 | Train Loss: 0.1536036 Vali Loss: 0.1380025 Test Loss: 0.1633706
	iters: 100, epoch: 9 | loss: 0.1978315
	speed: 1.3659s/iter; left time: 3981.4577s
Epoch: 9 cost time: 96.69394636154175
Epoch: 9, Steps: 137 | Train Loss: 0.1536948 Vali Loss: 0.1380286 Test Loss: 0.1634545
	iters: 100, epoch: 10 | loss: 0.1977586
	speed: 1.3720s/iter; left time: 3811.4210s
Epoch: 10 cost time: 96.75759196281433
Epoch: 10, Steps: 137 | Train Loss: 0.1537557 Vali Loss: 0.1380328 Test Loss: 0.1635019
	iters: 100, epoch: 11 | loss: 0.1977056
	speed: 1.3708s/iter; left time: 3620.4092s
Epoch: 11 cost time: 96.50615453720093
Epoch: 11, Steps: 137 | Train Loss: 0.1537981 Vali Loss: 0.1380288 Test Loss: 0.1635310
	iters: 100, epoch: 12 | loss: 0.1976659
	speed: 1.3629s/iter; left time: 3412.6966s
Epoch: 12 cost time: 96.54904103279114
Epoch: 12, Steps: 137 | Train Loss: 0.1538287 Vali Loss: 0.1380222 Test Loss: 0.1635502
	iters: 100, epoch: 13 | loss: 0.1976353
	speed: 1.3700s/iter; left time: 3242.7279s
Epoch: 13 cost time: 96.8456974029541
Epoch: 13, Steps: 137 | Train Loss: 0.1538513 Vali Loss: 0.1380152 Test Loss: 0.1635637
	iters: 100, epoch: 14 | loss: 0.1976108
	speed: 1.3719s/iter; left time: 3059.4108s
Epoch: 14 cost time: 97.23966455459595
Epoch: 14, Steps: 137 | Train Loss: 0.1538685 Vali Loss: 0.1380087 Test Loss: 0.1635737
	iters: 100, epoch: 15 | loss: 0.1975905
	speed: 1.3659s/iter; left time: 2858.8676s
Epoch: 15 cost time: 96.50523161888123
Epoch: 15, Steps: 137 | Train Loss: 0.1538817 Vali Loss: 0.1380031 Test Loss: 0.1635814
	iters: 100, epoch: 16 | loss: 0.1975733
	speed: 1.3719s/iter; left time: 2683.4003s
Epoch: 16 cost time: 96.7374279499054
Epoch: 16, Steps: 137 | Train Loss: 0.1538920 Vali Loss: 0.1379983 Test Loss: 0.1635877
	iters: 100, epoch: 17 | loss: 0.1975583
	speed: 1.3800s/iter; left time: 2510.1696s
Epoch: 17 cost time: 97.1501977443695
Epoch: 17, Steps: 137 | Train Loss: 0.1539002 Vali Loss: 0.1379944 Test Loss: 0.1635929
	iters: 100, epoch: 18 | loss: 0.1975451
	speed: 1.3629s/iter; left time: 2292.3609s
Epoch: 18 cost time: 96.27856230735779
Epoch: 18, Steps: 137 | Train Loss: 0.1539068 Vali Loss: 0.1379912 Test Loss: 0.1635974
	iters: 100, epoch: 19 | loss: 0.1975332
	speed: 1.3759s/iter; left time: 2125.7959s
Epoch: 19 cost time: 97.05867290496826
Epoch: 19, Steps: 137 | Train Loss: 0.1539122 Vali Loss: 0.1379888 Test Loss: 0.1636014
	iters: 100, epoch: 20 | loss: 0.1975224
	speed: 1.3659s/iter; left time: 1923.2363s
Epoch: 20 cost time: 96.49950766563416
Epoch: 20, Steps: 137 | Train Loss: 0.1539165 Vali Loss: 0.1379869 Test Loss: 0.1636050
	iters: 100, epoch: 21 | loss: 0.1975126
	speed: 1.3709s/iter; left time: 1742.4387s
Epoch: 21 cost time: 97.39787149429321
Epoch: 21, Steps: 137 | Train Loss: 0.1539201 Vali Loss: 0.1379855 Test Loss: 0.1636083
	iters: 100, epoch: 22 | loss: 0.1975035
	speed: 1.3679s/iter; left time: 1551.1872s
Epoch: 22 cost time: 97.19947099685669
Epoch: 22, Steps: 137 | Train Loss: 0.1539231 Vali Loss: 0.1379846 Test Loss: 0.1636114
	iters: 100, epoch: 23 | loss: 0.1974951
	speed: 1.3819s/iter; left time: 1377.7666s
Epoch: 23 cost time: 97.30560278892517
Epoch: 23, Steps: 137 | Train Loss: 0.1539256 Vali Loss: 0.1379840 Test Loss: 0.1636142
	iters: 100, epoch: 24 | loss: 0.1974874
	speed: 1.3698s/iter; left time: 1178.0120s
Epoch: 24 cost time: 96.17940020561218
Epoch: 24, Steps: 137 | Train Loss: 0.1539276 Vali Loss: 0.1379837 Test Loss: 0.1636169
	iters: 100, epoch: 25 | loss: 0.1974801
	speed: 1.3741s/iter; left time: 993.4761s
Epoch: 25 cost time: 96.29367685317993
Epoch: 25, Steps: 137 | Train Loss: 0.1539294 Vali Loss: 0.1379837 Test Loss: 0.1636194
	iters: 100, epoch: 26 | loss: 0.1974734
	speed: 1.3699s/iter; left time: 802.7763s
Epoch: 26 cost time: 96.10898923873901
Epoch: 26, Steps: 137 | Train Loss: 0.1539308 Vali Loss: 0.1379839 Test Loss: 0.1636218
	iters: 100, epoch: 27 | loss: 0.1974671
	speed: 1.3768s/iter; left time: 618.1990s
Epoch: 27 cost time: 97.2790858745575
Epoch: 27, Steps: 137 | Train Loss: 0.1539320 Vali Loss: 0.1379843 Test Loss: 0.1636241
	iters: 100, epoch: 28 | loss: 0.1974612
	speed: 1.3640s/iter; left time: 425.5534s
Epoch: 28 cost time: 96.3218400478363
Epoch: 28, Steps: 137 | Train Loss: 0.1539331 Vali Loss: 0.1379848 Test Loss: 0.1636263
	iters: 100, epoch: 29 | loss: 0.1974556
	speed: 1.3689s/iter; left time: 239.5620s
Epoch: 29 cost time: 96.37449812889099
Epoch: 29, Steps: 137 | Train Loss: 0.1539340 Vali Loss: 0.1379854 Test Loss: 0.1636284
	iters: 100, epoch: 30 | loss: 0.1974504
	speed: 1.3688s/iter; left time: 52.0159s
Epoch: 30 cost time: 96.5995659828186
Epoch: 30, Steps: 137 | Train Loss: 0.1539347 Vali Loss: 0.1379861 Test Loss: 0.1636304
>>>>>>>testing : Electricity_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.16351711750030518, mae:0.2660321295261383, rse:0.40190693736076355
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2314767
	speed: 1.6218s/iter; left time: 6456.2021s
Epoch: 1 cost time: 113.70918440818787
Epoch: 1, Steps: 136 | Train Loss: 0.2289864 Vali Loss: 0.1633728 Test Loss: 0.1892245
	iters: 100, epoch: 2 | loss: 0.1860326
	speed: 1.5820s/iter; left time: 6082.6431s
Epoch: 2 cost time: 110.46957302093506
Epoch: 2, Steps: 136 | Train Loss: 0.1719760 Vali Loss: 0.1556875 Test Loss: 0.1824849
	iters: 100, epoch: 3 | loss: 0.1783573
	speed: 1.5668s/iter; left time: 5811.4188s
Epoch: 3 cost time: 110.92676210403442
Epoch: 3, Steps: 136 | Train Loss: 0.1698274 Vali Loss: 0.1456867 Test Loss: 0.1731715
	iters: 100, epoch: 4 | loss: 0.1756103
	speed: 1.5699s/iter; left time: 5609.3348s
Epoch: 4 cost time: 111.32969999313354
Epoch: 4, Steps: 136 | Train Loss: 0.1693159 Vali Loss: 0.1443218 Test Loss: 0.1720162
	iters: 100, epoch: 5 | loss: 0.1750418
	speed: 1.5679s/iter; left time: 5388.9300s
Epoch: 5 cost time: 110.19553971290588
Epoch: 5, Steps: 136 | Train Loss: 0.1692790 Vali Loss: 0.1454597 Test Loss: 0.1731571
	iters: 100, epoch: 6 | loss: 0.1752204
	speed: 1.5619s/iter; left time: 5155.9059s
Epoch: 6 cost time: 110.49786067008972
Epoch: 6, Steps: 136 | Train Loss: 0.1694147 Vali Loss: 0.1472609 Test Loss: 0.1749922
	iters: 100, epoch: 7 | loss: 0.1756597
	speed: 1.5679s/iter; left time: 4962.4523s
Epoch: 7 cost time: 111.23713278770447
Epoch: 7, Steps: 136 | Train Loss: 0.1695875 Vali Loss: 0.1490020 Test Loss: 0.1768071
	iters: 100, epoch: 8 | loss: 0.1761627
	speed: 1.5782s/iter; left time: 4780.3853s
Epoch: 8 cost time: 112.15414428710938
Epoch: 8, Steps: 136 | Train Loss: 0.1697457 Vali Loss: 0.1504791 Test Loss: 0.1783689
	iters: 100, epoch: 9 | loss: 0.1766349
	speed: 1.5576s/iter; left time: 4506.2008s
Epoch: 9 cost time: 110.01050996780396
Epoch: 9, Steps: 136 | Train Loss: 0.1698785 Vali Loss: 0.1516785 Test Loss: 0.1796478
	iters: 100, epoch: 10 | loss: 0.1770383
	speed: 1.5558s/iter; left time: 4289.3511s
Epoch: 10 cost time: 109.64674210548401
Epoch: 10, Steps: 136 | Train Loss: 0.1699871 Vali Loss: 0.1526359 Test Loss: 0.1806739
	iters: 100, epoch: 11 | loss: 0.1773673
	speed: 1.5579s/iter; left time: 4083.2506s
Epoch: 11 cost time: 109.66569876670837
Epoch: 11, Steps: 136 | Train Loss: 0.1700748 Vali Loss: 0.1533955 Test Loss: 0.1814911
	iters: 100, epoch: 12 | loss: 0.1776295
	speed: 1.5530s/iter; left time: 3859.1652s
Epoch: 12 cost time: 110.8155608177185
Epoch: 12, Steps: 136 | Train Loss: 0.1701452 Vali Loss: 0.1539981 Test Loss: 0.1821413
	iters: 100, epoch: 13 | loss: 0.1778366
	speed: 1.5609s/iter; left time: 3666.5514s
Epoch: 13 cost time: 110.45094156265259
Epoch: 13, Steps: 136 | Train Loss: 0.1702019 Vali Loss: 0.1544776 Test Loss: 0.1826602
	iters: 100, epoch: 14 | loss: 0.1779997
	speed: 1.5561s/iter; left time: 3443.7463s
Epoch: 14 cost time: 110.31720519065857
Epoch: 14, Steps: 136 | Train Loss: 0.1702475 Vali Loss: 0.1548609 Test Loss: 0.1830760
	iters: 100, epoch: 15 | loss: 0.1781281
	speed: 1.5676s/iter; left time: 3255.9194s
Epoch: 15 cost time: 110.86953043937683
Epoch: 15, Steps: 136 | Train Loss: 0.1702843 Vali Loss: 0.1551688 Test Loss: 0.1834109
	iters: 100, epoch: 16 | loss: 0.1782294
	speed: 1.5569s/iter; left time: 3022.0348s
Epoch: 16 cost time: 110.4343695640564
Epoch: 16, Steps: 136 | Train Loss: 0.1703142 Vali Loss: 0.1554174 Test Loss: 0.1836819
	iters: 100, epoch: 17 | loss: 0.1783095
	speed: 1.5550s/iter; left time: 2806.7215s
Epoch: 17 cost time: 110.36950397491455
Epoch: 17, Steps: 136 | Train Loss: 0.1703384 Vali Loss: 0.1556192 Test Loss: 0.1839023
	iters: 100, epoch: 18 | loss: 0.1783730
	speed: 1.5638s/iter; left time: 2610.0322s
Epoch: 18 cost time: 110.63953948020935
Epoch: 18, Steps: 136 | Train Loss: 0.1703582 Vali Loss: 0.1557838 Test Loss: 0.1840826
	iters: 100, epoch: 19 | loss: 0.1784234
	speed: 1.5589s/iter; left time: 2389.7873s
Epoch: 19 cost time: 110.08712863922119
Epoch: 19, Steps: 136 | Train Loss: 0.1703744 Vali Loss: 0.1559186 Test Loss: 0.1842305
	iters: 100, epoch: 20 | loss: 0.1784635
	speed: 1.5591s/iter; left time: 2178.0522s
Epoch: 20 cost time: 110.365473985672
Epoch: 20, Steps: 136 | Train Loss: 0.1703877 Vali Loss: 0.1560296 Test Loss: 0.1843525
	iters: 100, epoch: 21 | loss: 0.1784955
	speed: 1.5598s/iter; left time: 1966.8903s
Epoch: 21 cost time: 109.73584628105164
Epoch: 21, Steps: 136 | Train Loss: 0.1703987 Vali Loss: 0.1561212 Test Loss: 0.1844535
	iters: 100, epoch: 22 | loss: 0.1785209
	speed: 1.5518s/iter; left time: 1745.7745s
Epoch: 22 cost time: 110.44501256942749
Epoch: 22, Steps: 136 | Train Loss: 0.1704077 Vali Loss: 0.1561972 Test Loss: 0.1845374
	iters: 100, epoch: 23 | loss: 0.1785411
	speed: 1.5540s/iter; left time: 1536.9450s
Epoch: 23 cost time: 109.7736451625824
Epoch: 23, Steps: 136 | Train Loss: 0.1704152 Vali Loss: 0.1562604 Test Loss: 0.1846074
	iters: 100, epoch: 24 | loss: 0.1785571
	speed: 1.5501s/iter; left time: 1322.2757s
Epoch: 24 cost time: 109.95475506782532
Epoch: 24, Steps: 136 | Train Loss: 0.1704214 Vali Loss: 0.1563132 Test Loss: 0.1846659
	iters: 100, epoch: 25 | loss: 0.1785698
	speed: 1.5557s/iter; left time: 1115.4119s
Epoch: 25 cost time: 110.28155899047852
Epoch: 25, Steps: 136 | Train Loss: 0.1704265 Vali Loss: 0.1563574 Test Loss: 0.1847151
	iters: 100, epoch: 26 | loss: 0.1785798
	speed: 1.5639s/iter; left time: 908.6270s
Epoch: 26 cost time: 111.97952103614807
Epoch: 26, Steps: 136 | Train Loss: 0.1704308 Vali Loss: 0.1563945 Test Loss: 0.1847565
	iters: 100, epoch: 27 | loss: 0.1785876
	speed: 1.5712s/iter; left time: 699.2021s
Epoch: 27 cost time: 110.51126742362976
Epoch: 27, Steps: 136 | Train Loss: 0.1704343 Vali Loss: 0.1564258 Test Loss: 0.1847914
	iters: 100, epoch: 28 | loss: 0.1785936
	speed: 1.5649s/iter; left time: 483.5597s
Epoch: 28 cost time: 110.87632393836975
Epoch: 28, Steps: 136 | Train Loss: 0.1704373 Vali Loss: 0.1564523 Test Loss: 0.1848211
	iters: 100, epoch: 29 | loss: 0.1785982
	speed: 1.5495s/iter; left time: 268.0701s
Epoch: 29 cost time: 109.77109599113464
Epoch: 29, Steps: 136 | Train Loss: 0.1704398 Vali Loss: 0.1564746 Test Loss: 0.1848462
	iters: 100, epoch: 30 | loss: 0.1786016
	speed: 1.5539s/iter; left time: 57.4948s
Epoch: 30 cost time: 110.32567620277405
Epoch: 30, Steps: 136 | Train Loss: 0.1704419 Vali Loss: 0.1564937 Test Loss: 0.1848676
>>>>>>>testing : Electricity_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.18189771473407745, mae:0.29101449251174927, rse:0.4240489602088928
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2102656
	speed: 1.9086s/iter; left time: 7540.7118s
Epoch: 1 cost time: 134.31618690490723
Epoch: 1, Steps: 135 | Train Loss: 0.2489475 Vali Loss: 0.1695510 Test Loss: 0.1929897
	iters: 100, epoch: 2 | loss: 0.1893084
	speed: 1.7769s/iter; left time: 6780.7178s
Epoch: 2 cost time: 124.05377101898193
Epoch: 2, Steps: 135 | Train Loss: 0.2007884 Vali Loss: 0.1817687 Test Loss: 0.2056774
	iters: 100, epoch: 3 | loss: 0.1858957
	speed: 1.7537s/iter; left time: 6455.2054s
Epoch: 3 cost time: 125.05459499359131
Epoch: 3, Steps: 135 | Train Loss: 0.1994729 Vali Loss: 0.1820939 Test Loss: 0.2067334
	iters: 100, epoch: 4 | loss: 0.1846720
	speed: 1.7524s/iter; left time: 6214.0595s
Epoch: 4 cost time: 123.01079249382019
Epoch: 4, Steps: 135 | Train Loss: 0.1987807 Vali Loss: 0.1801661 Test Loss: 0.2053237
	iters: 100, epoch: 5 | loss: 0.1840951
	speed: 1.7416s/iter; left time: 5940.6463s
Epoch: 5 cost time: 123.61310315132141
Epoch: 5, Steps: 135 | Train Loss: 0.1983704 Vali Loss: 0.1780366 Test Loss: 0.2035020
	iters: 100, epoch: 6 | loss: 0.1838357
	speed: 1.7410s/iter; left time: 5703.4591s
Epoch: 6 cost time: 123.80415868759155
Epoch: 6, Steps: 135 | Train Loss: 0.1980953 Vali Loss: 0.1761215 Test Loss: 0.2017765
	iters: 100, epoch: 7 | loss: 0.1837450
	speed: 1.7443s/iter; left time: 5478.8007s
Epoch: 7 cost time: 124.0203104019165
Epoch: 7, Steps: 135 | Train Loss: 0.1978985 Vali Loss: 0.1745063 Test Loss: 0.2002889
	iters: 100, epoch: 8 | loss: 0.1837496
	speed: 1.7407s/iter; left time: 5232.4363s
Epoch: 8 cost time: 124.373544216156
Epoch: 8, Steps: 135 | Train Loss: 0.1977521 Vali Loss: 0.1731774 Test Loss: 0.1990540
	iters: 100, epoch: 9 | loss: 0.1838109
	speed: 1.7580s/iter; left time: 5047.1233s
Epoch: 9 cost time: 124.23670029640198
Epoch: 9, Steps: 135 | Train Loss: 0.1976405 Vali Loss: 0.1720946 Test Loss: 0.1980452
	iters: 100, epoch: 10 | loss: 0.1839066
	speed: 1.7599s/iter; left time: 4815.1596s
Epoch: 10 cost time: 125.6079113483429
Epoch: 10, Steps: 135 | Train Loss: 0.1975538 Vali Loss: 0.1712148 Test Loss: 0.1972258
	iters: 100, epoch: 11 | loss: 0.1840228
	speed: 1.7412s/iter; left time: 4528.8122s
Epoch: 11 cost time: 125.27280402183533
Epoch: 11, Steps: 135 | Train Loss: 0.1974853 Vali Loss: 0.1704994 Test Loss: 0.1965606
	iters: 100, epoch: 12 | loss: 0.1841503
	speed: 1.7588s/iter; left time: 4337.3123s
Epoch: 12 cost time: 124.64859414100647
Epoch: 12, Steps: 135 | Train Loss: 0.1974306 Vali Loss: 0.1699160 Test Loss: 0.1960194
	iters: 100, epoch: 13 | loss: 0.1842826
	speed: 1.7427s/iter; left time: 4062.1254s
Epoch: 13 cost time: 123.8840982913971
Epoch: 13, Steps: 135 | Train Loss: 0.1973866 Vali Loss: 0.1694388 Test Loss: 0.1955774
	iters: 100, epoch: 14 | loss: 0.1844154
	speed: 1.7492s/iter; left time: 3841.1623s
Epoch: 14 cost time: 124.44893956184387
Epoch: 14, Steps: 135 | Train Loss: 0.1973508 Vali Loss: 0.1690470 Test Loss: 0.1952150
	iters: 100, epoch: 15 | loss: 0.1845457
	speed: 1.7479s/iter; left time: 3602.3709s
Epoch: 15 cost time: 123.94451355934143
Epoch: 15, Steps: 135 | Train Loss: 0.1973214 Vali Loss: 0.1687240 Test Loss: 0.1949165
	iters: 100, epoch: 16 | loss: 0.1846717
	speed: 1.7339s/iter; left time: 3339.4663s
Epoch: 16 cost time: 123.15536880493164
Epoch: 16, Steps: 135 | Train Loss: 0.1972971 Vali Loss: 0.1684569 Test Loss: 0.1946694
	iters: 100, epoch: 17 | loss: 0.1847921
	speed: 1.7508s/iter; left time: 3135.6719s
Epoch: 17 cost time: 124.84435796737671
Epoch: 17, Steps: 135 | Train Loss: 0.1972770 Vali Loss: 0.1682351 Test Loss: 0.1944640
	iters: 100, epoch: 18 | loss: 0.1849060
	speed: 1.7599s/iter; left time: 2914.4638s
Epoch: 18 cost time: 126.09190011024475
Epoch: 18, Steps: 135 | Train Loss: 0.1972601 Vali Loss: 0.1680503 Test Loss: 0.1942924
	iters: 100, epoch: 19 | loss: 0.1850132
	speed: 1.7618s/iter; left time: 2679.6805s
Epoch: 19 cost time: 126.71400189399719
Epoch: 19, Steps: 135 | Train Loss: 0.1972459 Vali Loss: 0.1678958 Test Loss: 0.1941484
	iters: 100, epoch: 20 | loss: 0.1851136
	speed: 1.7593s/iter; left time: 2438.4358s
Epoch: 20 cost time: 123.93836975097656
Epoch: 20, Steps: 135 | Train Loss: 0.1972338 Vali Loss: 0.1677664 Test Loss: 0.1940271
	iters: 100, epoch: 21 | loss: 0.1852072
	speed: 1.7488s/iter; left time: 2187.7600s
Epoch: 21 cost time: 123.85302686691284
Epoch: 21, Steps: 135 | Train Loss: 0.1972235 Vali Loss: 0.1676575 Test Loss: 0.1939244
	iters: 100, epoch: 22 | loss: 0.1852941
	speed: 1.7402s/iter; left time: 1942.0646s
Epoch: 22 cost time: 123.37393307685852
Epoch: 22, Steps: 135 | Train Loss: 0.1972147 Vali Loss: 0.1675658 Test Loss: 0.1938372
	iters: 100, epoch: 23 | loss: 0.1853747
	speed: 1.7479s/iter; left time: 1714.7077s
Epoch: 23 cost time: 125.07389497756958
Epoch: 23, Steps: 135 | Train Loss: 0.1972070 Vali Loss: 0.1674883 Test Loss: 0.1937628
	iters: 100, epoch: 24 | loss: 0.1854493
	speed: 1.7403s/iter; left time: 1472.3211s
Epoch: 24 cost time: 123.74600028991699
Epoch: 24, Steps: 135 | Train Loss: 0.1972004 Vali Loss: 0.1674227 Test Loss: 0.1936992
	iters: 100, epoch: 25 | loss: 0.1855182
	speed: 1.7311s/iter; left time: 1230.8234s
Epoch: 25 cost time: 123.36800813674927
Epoch: 25, Steps: 135 | Train Loss: 0.1971947 Vali Loss: 0.1673670 Test Loss: 0.1936446
	iters: 100, epoch: 26 | loss: 0.1855818
	speed: 1.7288s/iter; left time: 995.7617s
Epoch: 26 cost time: 124.37580633163452
Epoch: 26, Steps: 135 | Train Loss: 0.1971896 Vali Loss: 0.1673197 Test Loss: 0.1935977
	iters: 100, epoch: 27 | loss: 0.1856403
	speed: 1.7480s/iter; left time: 770.8679s
Epoch: 27 cost time: 124.14393830299377
Epoch: 27, Steps: 135 | Train Loss: 0.1971852 Vali Loss: 0.1672795 Test Loss: 0.1935572
	iters: 100, epoch: 28 | loss: 0.1856942
	speed: 1.7409s/iter; left time: 532.7146s
Epoch: 28 cost time: 123.40257811546326
Epoch: 28, Steps: 135 | Train Loss: 0.1971813 Vali Loss: 0.1672453 Test Loss: 0.1935222
	iters: 100, epoch: 29 | loss: 0.1857438
	speed: 1.7420s/iter; left time: 297.8788s
Epoch: 29 cost time: 123.93674063682556
Epoch: 29, Steps: 135 | Train Loss: 0.1971778 Vali Loss: 0.1672162 Test Loss: 0.1934919
	iters: 100, epoch: 30 | loss: 0.1857894
	speed: 1.7358s/iter; left time: 62.4872s
Epoch: 30 cost time: 123.87997436523438
Epoch: 30, Steps: 135 | Train Loss: 0.1971748 Vali Loss: 0.1671913 Test Loss: 0.1934656
>>>>>>>testing : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.19126562774181366, mae:0.2993529140949249, rse:0.4352710247039795
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16973
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2839727
	speed: 2.7920s/iter; left time: 10779.8088s
Epoch: 1 cost time: 214.91672110557556
Epoch: 1, Steps: 132 | Train Loss: 0.2968918 Vali Loss: 0.2011228 Test Loss: 0.2415604
	iters: 100, epoch: 2 | loss: 0.2776476
	speed: 2.7025s/iter; left time: 10077.7871s
Epoch: 2 cost time: 205.1418879032135
Epoch: 2, Steps: 132 | Train Loss: 0.2455444 Vali Loss: 0.1878125 Test Loss: 0.2207165
	iters: 100, epoch: 3 | loss: 0.2809228
	speed: 2.6677s/iter; left time: 9595.8269s
Epoch: 3 cost time: 203.61426639556885
Epoch: 3, Steps: 132 | Train Loss: 0.2436285 Vali Loss: 0.1858479 Test Loss: 0.2179505
	iters: 100, epoch: 4 | loss: 0.2818470
	speed: 2.6659s/iter; left time: 9237.2738s
Epoch: 4 cost time: 205.08122944831848
Epoch: 4, Steps: 132 | Train Loss: 0.2427986 Vali Loss: 0.1852282 Test Loss: 0.2177547
	iters: 100, epoch: 5 | loss: 0.2812980
	speed: 2.6688s/iter; left time: 8895.2688s
Epoch: 5 cost time: 205.22403001785278
Epoch: 5, Steps: 132 | Train Loss: 0.2423379 Vali Loss: 0.1848106 Test Loss: 0.2177959
	iters: 100, epoch: 6 | loss: 0.2805412
	speed: 2.6781s/iter; left time: 8572.4525s
Epoch: 6 cost time: 206.6794786453247
Epoch: 6, Steps: 132 | Train Loss: 0.2421272 Vali Loss: 0.1844918 Test Loss: 0.2177844
	iters: 100, epoch: 7 | loss: 0.2800999
	speed: 2.6783s/iter; left time: 8219.5593s
Epoch: 7 cost time: 205.80310082435608
Epoch: 7, Steps: 132 | Train Loss: 0.2421060 Vali Loss: 0.1843054 Test Loss: 0.2177870
	iters: 100, epoch: 8 | loss: 0.2799189
	speed: 2.6876s/iter; left time: 7893.3499s
Epoch: 8 cost time: 207.21544003486633
Epoch: 8, Steps: 132 | Train Loss: 0.2421823 Vali Loss: 0.1842413 Test Loss: 0.2178399
	iters: 100, epoch: 9 | loss: 0.2798609
	speed: 2.6778s/iter; left time: 7511.3458s
Epoch: 9 cost time: 206.28521537780762
Epoch: 9, Steps: 132 | Train Loss: 0.2422918 Vali Loss: 0.1842575 Test Loss: 0.2179304
	iters: 100, epoch: 10 | loss: 0.2798459
	speed: 2.6588s/iter; left time: 7106.8838s
Epoch: 10 cost time: 204.5558557510376
Epoch: 10, Steps: 132 | Train Loss: 0.2424033 Vali Loss: 0.1843155 Test Loss: 0.2180370
	iters: 100, epoch: 11 | loss: 0.2798393
	speed: 2.6917s/iter; left time: 6839.6459s
Epoch: 11 cost time: 207.04842281341553
Epoch: 11, Steps: 132 | Train Loss: 0.2425048 Vali Loss: 0.1843904 Test Loss: 0.2181449
	iters: 100, epoch: 12 | loss: 0.2798287
	speed: 2.6644s/iter; left time: 6418.6119s
Epoch: 12 cost time: 205.03426337242126
Epoch: 12, Steps: 132 | Train Loss: 0.2425928 Vali Loss: 0.1844682 Test Loss: 0.2182458
	iters: 100, epoch: 13 | loss: 0.2798115
	speed: 2.6767s/iter; left time: 6094.9572s
Epoch: 13 cost time: 206.0411570072174
Epoch: 13, Steps: 132 | Train Loss: 0.2426674 Vali Loss: 0.1845420 Test Loss: 0.2183362
	iters: 100, epoch: 14 | loss: 0.2797890
	speed: 2.6620s/iter; left time: 5710.0323s
Epoch: 14 cost time: 204.02984237670898
Epoch: 14, Steps: 132 | Train Loss: 0.2427302 Vali Loss: 0.1846089 Test Loss: 0.2184152
	iters: 100, epoch: 15 | loss: 0.2797633
	speed: 2.6597s/iter; left time: 5354.0149s
Epoch: 15 cost time: 205.11469388008118
Epoch: 15, Steps: 132 | Train Loss: 0.2427828 Vali Loss: 0.1846680 Test Loss: 0.2184834
	iters: 100, epoch: 16 | loss: 0.2797365
	speed: 2.6758s/iter; left time: 5033.1878s
Epoch: 16 cost time: 206.38236021995544
Epoch: 16, Steps: 132 | Train Loss: 0.2428269 Vali Loss: 0.1847197 Test Loss: 0.2185417
	iters: 100, epoch: 17 | loss: 0.2797101
	speed: 2.6967s/iter; left time: 4716.5580s
Epoch: 17 cost time: 205.7423357963562
Epoch: 17, Steps: 132 | Train Loss: 0.2428639 Vali Loss: 0.1847644 Test Loss: 0.2185913
	iters: 100, epoch: 18 | loss: 0.2796853
	speed: 2.6447s/iter; left time: 4276.4979s
Epoch: 18 cost time: 202.88381123542786
Epoch: 18, Steps: 132 | Train Loss: 0.2428952 Vali Loss: 0.1848030 Test Loss: 0.2186335
	iters: 100, epoch: 19 | loss: 0.2796629
	speed: 2.6667s/iter; left time: 3960.0453s
Epoch: 19 cost time: 205.16174578666687
Epoch: 19, Steps: 132 | Train Loss: 0.2429214 Vali Loss: 0.1848364 Test Loss: 0.2186694
	iters: 100, epoch: 20 | loss: 0.2796431
	speed: 2.6679s/iter; left time: 3609.6134s
Epoch: 20 cost time: 204.92357301712036
Epoch: 20, Steps: 132 | Train Loss: 0.2429436 Vali Loss: 0.1848653 Test Loss: 0.2187000
	iters: 100, epoch: 21 | loss: 0.2796261
	speed: 2.6429s/iter; left time: 3227.0007s
Epoch: 21 cost time: 203.58056378364563
Epoch: 21, Steps: 132 | Train Loss: 0.2429624 Vali Loss: 0.1848903 Test Loss: 0.2187261
	iters: 100, epoch: 22 | loss: 0.2796119
	speed: 2.6799s/iter; left time: 2918.3834s
Epoch: 22 cost time: 205.61836051940918
Epoch: 22, Steps: 132 | Train Loss: 0.2429784 Vali Loss: 0.1849120 Test Loss: 0.2187485
	iters: 100, epoch: 23 | loss: 0.2796002
	speed: 2.6781s/iter; left time: 2562.9744s
Epoch: 23 cost time: 206.90839076042175
Epoch: 23, Steps: 132 | Train Loss: 0.2429919 Vali Loss: 0.1849309 Test Loss: 0.2187677
	iters: 100, epoch: 24 | loss: 0.2795908
	speed: 2.6579s/iter; left time: 2192.7936s
Epoch: 24 cost time: 204.8477246761322
Epoch: 24, Steps: 132 | Train Loss: 0.2430034 Vali Loss: 0.1849475 Test Loss: 0.2187842
	iters: 100, epoch: 25 | loss: 0.2795835
	speed: 2.6667s/iter; left time: 1848.0388s
Epoch: 25 cost time: 204.78597450256348
Epoch: 25, Steps: 132 | Train Loss: 0.2430133 Vali Loss: 0.1849620 Test Loss: 0.2187985
	iters: 100, epoch: 26 | loss: 0.2795780
	speed: 2.6869s/iter; left time: 1507.3755s
Epoch: 26 cost time: 206.4024600982666
Epoch: 26, Steps: 132 | Train Loss: 0.2430216 Vali Loss: 0.1849747 Test Loss: 0.2188109
	iters: 100, epoch: 27 | loss: 0.2795740
	speed: 2.6677s/iter; left time: 1144.4520s
Epoch: 27 cost time: 206.5322229862213
Epoch: 27, Steps: 132 | Train Loss: 0.2430288 Vali Loss: 0.1849860 Test Loss: 0.2188217
	iters: 100, epoch: 28 | loss: 0.2795714
	speed: 2.6783s/iter; left time: 795.4471s
Epoch: 28 cost time: 205.8292224407196
Epoch: 28, Steps: 132 | Train Loss: 0.2430348 Vali Loss: 0.1849958 Test Loss: 0.2188311
	iters: 100, epoch: 29 | loss: 0.2795697
	speed: 2.6988s/iter; left time: 445.2970s
Epoch: 29 cost time: 208.0474636554718
Epoch: 29, Steps: 132 | Train Loss: 0.2430400 Vali Loss: 0.1850046 Test Loss: 0.2188393
	iters: 100, epoch: 30 | loss: 0.2795689
	speed: 2.6821s/iter; left time: 88.5107s
Epoch: 30 cost time: 206.1273798942566
Epoch: 30, Steps: 132 | Train Loss: 0.2430444 Vali Loss: 0.1850123 Test Loss: 0.2188466
>>>>>>>testing : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2172478437423706, mae:0.3100104331970215, rse:0.4649488031864166
Args in experiment:
Namespace(is_training=1, model_id='weather_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2266081
	speed: 0.2184s/iter; left time: 895.7778s
Epoch: 1 cost time: 14.739177465438843
Epoch: 1, Steps: 140 | Train Loss: 0.6288335 Vali Loss: 0.4962613 Test Loss: 0.2179674
	iters: 100, epoch: 2 | loss: 0.1877532
	speed: 0.2084s/iter; left time: 825.5757s
Epoch: 2 cost time: 13.575408458709717
Epoch: 2, Steps: 140 | Train Loss: 0.5345840 Vali Loss: 0.4810614 Test Loss: 0.2039274
	iters: 100, epoch: 3 | loss: 0.1869356
	speed: 0.1997s/iter; left time: 763.0853s
Epoch: 3 cost time: 14.018581628799438
Epoch: 3, Steps: 140 | Train Loss: 0.5402549 Vali Loss: 0.4757688 Test Loss: 0.2047223
	iters: 100, epoch: 4 | loss: 0.1764631
	speed: 0.2097s/iter; left time: 771.8368s
Epoch: 4 cost time: 14.367224931716919
Epoch: 4, Steps: 140 | Train Loss: 0.5346263 Vali Loss: 0.4610896 Test Loss: 0.1961218
	iters: 100, epoch: 5 | loss: 0.1638757
	speed: 0.1987s/iter; left time: 703.6989s
Epoch: 5 cost time: 13.712375164031982
Epoch: 5, Steps: 140 | Train Loss: 0.4934551 Vali Loss: 0.4382074 Test Loss: 0.1853539
	iters: 100, epoch: 6 | loss: 0.1585633
	speed: 0.2035s/iter; left time: 692.0433s
Epoch: 6 cost time: 14.451257467269897
Epoch: 6, Steps: 140 | Train Loss: 0.4822505 Vali Loss: 0.4284836 Test Loss: 0.1823420
	iters: 100, epoch: 7 | loss: 0.1489115
	speed: 0.2104s/iter; left time: 686.2693s
Epoch: 7 cost time: 14.682758569717407
Epoch: 7, Steps: 140 | Train Loss: 0.4727323 Vali Loss: 0.4254432 Test Loss: 0.1815729
	iters: 100, epoch: 8 | loss: 0.1475760
	speed: 0.2060s/iter; left time: 642.7963s
Epoch: 8 cost time: 13.893404245376587
Epoch: 8, Steps: 140 | Train Loss: 0.4696397 Vali Loss: 0.4249749 Test Loss: 0.1824234
	iters: 100, epoch: 9 | loss: 0.1474639
	speed: 0.1996s/iter; left time: 595.0433s
Epoch: 9 cost time: 13.877986431121826
Epoch: 9, Steps: 140 | Train Loss: 0.4684646 Vali Loss: 0.4260997 Test Loss: 0.1837552
	iters: 100, epoch: 10 | loss: 0.1478557
	speed: 0.2092s/iter; left time: 594.2100s
Epoch: 10 cost time: 14.867583513259888
Epoch: 10, Steps: 140 | Train Loss: 0.4680387 Vali Loss: 0.4279516 Test Loss: 0.1851729
	iters: 100, epoch: 11 | loss: 0.1484352
	speed: 0.2037s/iter; left time: 550.1381s
Epoch: 11 cost time: 14.315386533737183
Epoch: 11, Steps: 140 | Train Loss: 0.4679744 Vali Loss: 0.4300221 Test Loss: 0.1865281
	iters: 100, epoch: 12 | loss: 0.1490585
	speed: 0.2055s/iter; left time: 526.3904s
Epoch: 12 cost time: 14.196650743484497
Epoch: 12, Steps: 140 | Train Loss: 0.4680907 Vali Loss: 0.4320719 Test Loss: 0.1877829
	iters: 100, epoch: 13 | loss: 0.1496756
	speed: 0.2043s/iter; left time: 494.5145s
Epoch: 13 cost time: 14.180603742599487
Epoch: 13, Steps: 140 | Train Loss: 0.4683017 Vali Loss: 0.4340240 Test Loss: 0.1889467
	iters: 100, epoch: 14 | loss: 0.1502741
	speed: 0.2078s/iter; left time: 473.8997s
Epoch: 14 cost time: 14.336143255233765
Epoch: 14, Steps: 140 | Train Loss: 0.4685680 Vali Loss: 0.4358702 Test Loss: 0.1900398
	iters: 100, epoch: 15 | loss: 0.1508511
	speed: 0.1994s/iter; left time: 426.8410s
Epoch: 15 cost time: 14.112463235855103
Epoch: 15, Steps: 140 | Train Loss: 0.4688705 Vali Loss: 0.4376184 Test Loss: 0.1910768
	iters: 100, epoch: 16 | loss: 0.1514056
	speed: 0.2030s/iter; left time: 406.1805s
Epoch: 16 cost time: 14.124626159667969
Epoch: 16, Steps: 140 | Train Loss: 0.4691975 Vali Loss: 0.4392761 Test Loss: 0.1920657
	iters: 100, epoch: 17 | loss: 0.1519364
	speed: 0.2016s/iter; left time: 375.2025s
Epoch: 17 cost time: 13.909208536148071
Epoch: 17, Steps: 140 | Train Loss: 0.4695404 Vali Loss: 0.4408469 Test Loss: 0.1930095
	iters: 100, epoch: 18 | loss: 0.1524423
	speed: 0.2004s/iter; left time: 344.9575s
Epoch: 18 cost time: 13.865600109100342
Epoch: 18, Steps: 140 | Train Loss: 0.4698920 Vali Loss: 0.4423317 Test Loss: 0.1939086
	iters: 100, epoch: 19 | loss: 0.1529224
	speed: 0.2025s/iter; left time: 320.1995s
Epoch: 19 cost time: 14.014439344406128
Epoch: 19, Steps: 140 | Train Loss: 0.4702459 Vali Loss: 0.4437308 Test Loss: 0.1947621
	iters: 100, epoch: 20 | loss: 0.1533760
	speed: 0.1955s/iter; left time: 281.7108s
Epoch: 20 cost time: 13.504478454589844
Epoch: 20, Steps: 140 | Train Loss: 0.4705964 Vali Loss: 0.4450444 Test Loss: 0.1955689
	iters: 100, epoch: 21 | loss: 0.1538030
	speed: 0.1977s/iter; left time: 257.2719s
Epoch: 21 cost time: 13.898674726486206
Epoch: 21, Steps: 140 | Train Loss: 0.4709390 Vali Loss: 0.4462734 Test Loss: 0.1963288
	iters: 100, epoch: 22 | loss: 0.1542034
	speed: 0.2054s/iter; left time: 238.4333s
Epoch: 22 cost time: 14.698206663131714
Epoch: 22, Steps: 140 | Train Loss: 0.4712698 Vali Loss: 0.4474192 Test Loss: 0.1970412
	iters: 100, epoch: 23 | loss: 0.1545775
	speed: 0.2063s/iter; left time: 210.6126s
Epoch: 23 cost time: 14.156684637069702
Epoch: 23, Steps: 140 | Train Loss: 0.4715858 Vali Loss: 0.4484842 Test Loss: 0.1977067
	iters: 100, epoch: 24 | loss: 0.1549260
	speed: 0.2026s/iter; left time: 178.4966s
Epoch: 24 cost time: 14.64670443534851
Epoch: 24, Steps: 140 | Train Loss: 0.4718850 Vali Loss: 0.4494712 Test Loss: 0.1983260
	iters: 100, epoch: 25 | loss: 0.1552496
	speed: 0.2026s/iter; left time: 150.1151s
Epoch: 25 cost time: 13.815972089767456
Epoch: 25, Steps: 140 | Train Loss: 0.4721660 Vali Loss: 0.4503841 Test Loss: 0.1989006
	iters: 100, epoch: 26 | loss: 0.1555494
	speed: 0.2065s/iter; left time: 124.1007s
Epoch: 26 cost time: 14.800440788269043
Epoch: 26, Steps: 140 | Train Loss: 0.4724281 Vali Loss: 0.4512262 Test Loss: 0.1994320
	iters: 100, epoch: 27 | loss: 0.1558263
	speed: 0.2063s/iter; left time: 95.1166s
Epoch: 27 cost time: 13.818925857543945
Epoch: 27, Steps: 140 | Train Loss: 0.4726710 Vali Loss: 0.4520014 Test Loss: 0.1999222
	iters: 100, epoch: 28 | loss: 0.1560813
	speed: 0.2032s/iter; left time: 65.2256s
Epoch: 28 cost time: 14.378194570541382
Epoch: 28, Steps: 140 | Train Loss: 0.4728949 Vali Loss: 0.4527138 Test Loss: 0.2003730
	iters: 100, epoch: 29 | loss: 0.1563156
	speed: 0.2059s/iter; left time: 37.2652s
Epoch: 29 cost time: 13.813826322555542
Epoch: 29, Steps: 140 | Train Loss: 0.4731003 Vali Loss: 0.4533673 Test Loss: 0.2007868
	iters: 100, epoch: 30 | loss: 0.1565301
	speed: 0.2043s/iter; left time: 8.3755s
Epoch: 30 cost time: 14.266595363616943
Epoch: 30, Steps: 140 | Train Loss: 0.4732880 Vali Loss: 0.4539659 Test Loss: 0.2011655
>>>>>>>testing : weather_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.20192809402942657, mae:0.2592340111732483, rse:0.5921757221221924
Args in experiment:
Namespace(is_training=1, model_id='weather_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.2833450
	speed: 0.2394s/iter; left time: 981.5804s
Epoch: 1 cost time: 16.248576879501343
Epoch: 1, Steps: 140 | Train Loss: 0.6694753 Vali Loss: 0.5577618 Test Loss: 0.2533901
	iters: 100, epoch: 2 | loss: 0.2522190
	speed: 0.2251s/iter; left time: 891.4693s
Epoch: 2 cost time: 15.02746868133545
Epoch: 2, Steps: 140 | Train Loss: 0.5782317 Vali Loss: 0.5452998 Test Loss: 0.2429574
	iters: 100, epoch: 3 | loss: 0.2919723
	speed: 0.2180s/iter; left time: 833.0135s
Epoch: 3 cost time: 15.593799114227295
Epoch: 3, Steps: 140 | Train Loss: 0.6048461 Vali Loss: 0.5198045 Test Loss: 0.2342143
	iters: 100, epoch: 4 | loss: 0.2679108
	speed: 0.2215s/iter; left time: 815.1768s
Epoch: 4 cost time: 15.394309997558594
Epoch: 4, Steps: 140 | Train Loss: 0.5440509 Vali Loss: 0.5046063 Test Loss: 0.2267108
	iters: 100, epoch: 5 | loss: 0.2316249
	speed: 0.2215s/iter; left time: 784.4669s
Epoch: 5 cost time: 15.367837190628052
Epoch: 5, Steps: 140 | Train Loss: 0.5289725 Vali Loss: 0.4984577 Test Loss: 0.2237113
	iters: 100, epoch: 6 | loss: 0.2311929
	speed: 0.2232s/iter; left time: 759.0488s
Epoch: 6 cost time: 15.50801134109497
Epoch: 6, Steps: 140 | Train Loss: 0.5250703 Vali Loss: 0.4970472 Test Loss: 0.2228926
	iters: 100, epoch: 7 | loss: 0.2320220
	speed: 0.2273s/iter; left time: 741.2771s
Epoch: 7 cost time: 15.546999216079712
Epoch: 7, Steps: 140 | Train Loss: 0.5241204 Vali Loss: 0.4973404 Test Loss: 0.2229909
	iters: 100, epoch: 8 | loss: 0.2328376
	speed: 0.2208s/iter; left time: 689.0420s
Epoch: 8 cost time: 15.0353524684906
Epoch: 8, Steps: 140 | Train Loss: 0.5234748 Vali Loss: 0.4982757 Test Loss: 0.2234462
	iters: 100, epoch: 9 | loss: 0.2338348
	speed: 0.2200s/iter; left time: 655.7659s
Epoch: 9 cost time: 15.421383619308472
Epoch: 9, Steps: 140 | Train Loss: 0.5230180 Vali Loss: 0.4996266 Test Loss: 0.2241198
	iters: 100, epoch: 10 | loss: 0.2349949
	speed: 0.2200s/iter; left time: 624.9564s
Epoch: 10 cost time: 15.288265705108643
Epoch: 10, Steps: 140 | Train Loss: 0.5227252 Vali Loss: 0.5012530 Test Loss: 0.2249258
	iters: 100, epoch: 11 | loss: 0.2362403
	speed: 0.2232s/iter; left time: 602.9660s
Epoch: 11 cost time: 15.669562101364136
Epoch: 11, Steps: 140 | Train Loss: 0.5225818 Vali Loss: 0.5030290 Test Loss: 0.2257962
	iters: 100, epoch: 12 | loss: 0.2374867
	speed: 0.2212s/iter; left time: 566.5536s
Epoch: 12 cost time: 15.128400325775146
Epoch: 12, Steps: 140 | Train Loss: 0.5225726 Vali Loss: 0.5048461 Test Loss: 0.2266795
	iters: 100, epoch: 13 | loss: 0.2386645
	speed: 0.2187s/iter; left time: 529.5064s
Epoch: 13 cost time: 15.145413160324097
Epoch: 13, Steps: 140 | Train Loss: 0.5226800 Vali Loss: 0.5066198 Test Loss: 0.2275398
	iters: 100, epoch: 14 | loss: 0.2397298
	speed: 0.2175s/iter; left time: 496.0091s
Epoch: 14 cost time: 15.07512354850769
Epoch: 14, Steps: 140 | Train Loss: 0.5228835 Vali Loss: 0.5082929 Test Loss: 0.2283551
	iters: 100, epoch: 15 | loss: 0.2406649
	speed: 0.2219s/iter; left time: 475.1781s
Epoch: 15 cost time: 15.595929145812988
Epoch: 15, Steps: 140 | Train Loss: 0.5231606 Vali Loss: 0.5098320 Test Loss: 0.2291130
	iters: 100, epoch: 16 | loss: 0.2414733
	speed: 0.2292s/iter; left time: 458.7085s
Epoch: 16 cost time: 15.64823603630066
Epoch: 16, Steps: 140 | Train Loss: 0.5234897 Vali Loss: 0.5112240 Test Loss: 0.2298086
	iters: 100, epoch: 17 | loss: 0.2421720
	speed: 0.2188s/iter; left time: 407.2644s
Epoch: 17 cost time: 14.874126195907593
Epoch: 17, Steps: 140 | Train Loss: 0.5238510 Vali Loss: 0.5124692 Test Loss: 0.2304422
	iters: 100, epoch: 18 | loss: 0.2427819
	speed: 0.2183s/iter; left time: 375.6083s
Epoch: 18 cost time: 15.115789413452148
Epoch: 18, Steps: 140 | Train Loss: 0.5242289 Vali Loss: 0.5135756 Test Loss: 0.2310161
	iters: 100, epoch: 19 | loss: 0.2433235
	speed: 0.2249s/iter; left time: 355.5838s
Epoch: 19 cost time: 16.33261466026306
Epoch: 19, Steps: 140 | Train Loss: 0.5246108 Vali Loss: 0.5145548 Test Loss: 0.2315344
	iters: 100, epoch: 20 | loss: 0.2438133
	speed: 0.2238s/iter; left time: 322.5583s
Epoch: 20 cost time: 15.45297384262085
Epoch: 20, Steps: 140 | Train Loss: 0.5249880 Vali Loss: 0.5154195 Test Loss: 0.2320014
	iters: 100, epoch: 21 | loss: 0.2442642
	speed: 0.2221s/iter; left time: 288.9630s
Epoch: 21 cost time: 15.1245756149292
Epoch: 21, Steps: 140 | Train Loss: 0.5253538 Vali Loss: 0.5161817 Test Loss: 0.2324212
	iters: 100, epoch: 22 | loss: 0.2446846
	speed: 0.2170s/iter; left time: 251.9487s
Epoch: 22 cost time: 15.324071407318115
Epoch: 22, Steps: 140 | Train Loss: 0.5257043 Vali Loss: 0.5168527 Test Loss: 0.2327980
	iters: 100, epoch: 23 | loss: 0.2450803
	speed: 0.2268s/iter; left time: 231.6116s
Epoch: 23 cost time: 15.953503608703613
Epoch: 23, Steps: 140 | Train Loss: 0.5260362 Vali Loss: 0.5174422 Test Loss: 0.2331351
	iters: 100, epoch: 24 | loss: 0.2454547
	speed: 0.2272s/iter; left time: 200.1646s
Epoch: 24 cost time: 15.684926509857178
Epoch: 24, Steps: 140 | Train Loss: 0.5263481 Vali Loss: 0.5179592 Test Loss: 0.2334359
	iters: 100, epoch: 25 | loss: 0.2458094
	speed: 0.2201s/iter; left time: 163.0694s
Epoch: 25 cost time: 15.258686304092407
Epoch: 25, Steps: 140 | Train Loss: 0.5266383 Vali Loss: 0.5184121 Test Loss: 0.2337034
	iters: 100, epoch: 26 | loss: 0.2461452
	speed: 0.2183s/iter; left time: 131.1686s
Epoch: 26 cost time: 15.084698677062988
Epoch: 26, Steps: 140 | Train Loss: 0.5269062 Vali Loss: 0.5188085 Test Loss: 0.2339408
	iters: 100, epoch: 27 | loss: 0.2464622
	speed: 0.2201s/iter; left time: 101.4644s
Epoch: 27 cost time: 15.466146230697632
Epoch: 27, Steps: 140 | Train Loss: 0.5271510 Vali Loss: 0.5191553 Test Loss: 0.2341507
	iters: 100, epoch: 28 | loss: 0.2467603
	speed: 0.2216s/iter; left time: 71.1418s
Epoch: 28 cost time: 15.44520092010498
Epoch: 28, Steps: 140 | Train Loss: 0.5273731 Vali Loss: 0.5194588 Test Loss: 0.2343360
	iters: 100, epoch: 29 | loss: 0.2470391
	speed: 0.2240s/iter; left time: 40.5428s
Epoch: 29 cost time: 15.45206904411316
Epoch: 29, Steps: 140 | Train Loss: 0.5275724 Vali Loss: 0.5197250 Test Loss: 0.2344993
	iters: 100, epoch: 30 | loss: 0.2472985
	speed: 0.2214s/iter; left time: 9.0759s
Epoch: 30 cost time: 15.267727613449097
Epoch: 30, Steps: 140 | Train Loss: 0.5277501 Vali Loss: 0.5199589 Test Loss: 0.2346431
>>>>>>>testing : weather_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.23724082112312317, mae:0.28761765360832214, rse:0.6411547064781189
Args in experiment:
Namespace(is_training=1, model_id='weather_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.3832350
	speed: 0.2826s/iter; left time: 1150.2712s
Epoch: 1 cost time: 19.58489441871643
Epoch: 1, Steps: 139 | Train Loss: 0.6914325 Vali Loss: 0.6157368 Test Loss: 0.2947578
	iters: 100, epoch: 2 | loss: 0.3878448
	speed: 0.2668s/iter; left time: 1049.0632s
Epoch: 2 cost time: 17.939900398254395
Epoch: 2, Steps: 139 | Train Loss: 0.6242175 Vali Loss: 0.5980624 Test Loss: 0.2849475
	iters: 100, epoch: 3 | loss: 0.4190471
	speed: 0.2492s/iter; left time: 945.2909s
Epoch: 3 cost time: 17.438076734542847
Epoch: 3, Steps: 139 | Train Loss: 0.6322129 Vali Loss: 0.5769967 Test Loss: 0.2740818
	iters: 100, epoch: 4 | loss: 0.3907006
	speed: 0.2528s/iter; left time: 923.6507s
Epoch: 4 cost time: 17.492615461349487
Epoch: 4, Steps: 139 | Train Loss: 0.5946087 Vali Loss: 0.5547948 Test Loss: 0.2634488
	iters: 100, epoch: 5 | loss: 0.3588879
	speed: 0.2503s/iter; left time: 879.7225s
Epoch: 5 cost time: 17.530948162078857
Epoch: 5, Steps: 139 | Train Loss: 0.5895429 Vali Loss: 0.5473971 Test Loss: 0.2597020
	iters: 100, epoch: 6 | loss: 0.3742918
	speed: 0.2571s/iter; left time: 868.1357s
Epoch: 6 cost time: 18.227168560028076
Epoch: 6, Steps: 139 | Train Loss: 0.5832579 Vali Loss: 0.5459120 Test Loss: 0.2581699
	iters: 100, epoch: 7 | loss: 0.3787937
	speed: 0.2615s/iter; left time: 846.4798s
Epoch: 7 cost time: 18.216755867004395
Epoch: 7, Steps: 139 | Train Loss: 0.5823298 Vali Loss: 0.5459129 Test Loss: 0.2579393
	iters: 100, epoch: 8 | loss: 0.3805058
	speed: 0.2487s/iter; left time: 770.4272s
Epoch: 8 cost time: 17.415650844573975
Epoch: 8, Steps: 139 | Train Loss: 0.5822102 Vali Loss: 0.5457717 Test Loss: 0.2579900
	iters: 100, epoch: 9 | loss: 0.3809396
	speed: 0.2503s/iter; left time: 740.7202s
Epoch: 9 cost time: 17.865065813064575
Epoch: 9, Steps: 139 | Train Loss: 0.5823907 Vali Loss: 0.5454259 Test Loss: 0.2581463
	iters: 100, epoch: 10 | loss: 0.3809913
	speed: 0.2535s/iter; left time: 714.7345s
Epoch: 10 cost time: 17.71302342414856
Epoch: 10, Steps: 139 | Train Loss: 0.5827675 Vali Loss: 0.5450832 Test Loss: 0.2584072
	iters: 100, epoch: 11 | loss: 0.3810447
	speed: 0.2547s/iter; left time: 682.9825s
Epoch: 11 cost time: 17.944744110107422
Epoch: 11, Steps: 139 | Train Loss: 0.5832992 Vali Loss: 0.5449308 Test Loss: 0.2588115
	iters: 100, epoch: 12 | loss: 0.3812557
	speed: 0.2597s/iter; left time: 660.0915s
Epoch: 12 cost time: 17.83915948867798
Epoch: 12, Steps: 139 | Train Loss: 0.5839377 Vali Loss: 0.5450659 Test Loss: 0.2593809
	iters: 100, epoch: 13 | loss: 0.3816569
	speed: 0.2561s/iter; left time: 615.2963s
Epoch: 13 cost time: 18.483711004257202
Epoch: 13, Steps: 139 | Train Loss: 0.5846328 Vali Loss: 0.5455410 Test Loss: 0.2601294
	iters: 100, epoch: 14 | loss: 0.3821646
	speed: 0.2723s/iter; left time: 616.4643s
Epoch: 14 cost time: 18.036455392837524
Epoch: 14, Steps: 139 | Train Loss: 0.5853266 Vali Loss: 0.5463578 Test Loss: 0.2610559
	iters: 100, epoch: 15 | loss: 0.3826235
	speed: 0.2637s/iter; left time: 560.4200s
Epoch: 15 cost time: 19.046807050704956
Epoch: 15, Steps: 139 | Train Loss: 0.5859599 Vali Loss: 0.5474429 Test Loss: 0.2621253
	iters: 100, epoch: 16 | loss: 0.3829059
	speed: 0.2785s/iter; left time: 553.0818s
Epoch: 16 cost time: 19.762149572372437
Epoch: 16, Steps: 139 | Train Loss: 0.5864938 Vali Loss: 0.5486702 Test Loss: 0.2632682
	iters: 100, epoch: 17 | loss: 0.3829595
	speed: 0.2650s/iter; left time: 489.4316s
Epoch: 17 cost time: 18.270391702651978
Epoch: 17, Steps: 139 | Train Loss: 0.5869215 Vali Loss: 0.5499220 Test Loss: 0.2644079
	iters: 100, epoch: 18 | loss: 0.3827731
	speed: 0.2560s/iter; left time: 437.2166s
Epoch: 18 cost time: 17.671351194381714
Epoch: 18, Steps: 139 | Train Loss: 0.5872576 Vali Loss: 0.5511159 Test Loss: 0.2654769
	iters: 100, epoch: 19 | loss: 0.3823597
	speed: 0.2557s/iter; left time: 401.1404s
Epoch: 19 cost time: 18.431734561920166
Epoch: 19, Steps: 139 | Train Loss: 0.5875276 Vali Loss: 0.5522094 Test Loss: 0.2664291
	iters: 100, epoch: 20 | loss: 0.3817512
	speed: 0.2529s/iter; left time: 361.6313s
Epoch: 20 cost time: 17.57631778717041
Epoch: 20, Steps: 139 | Train Loss: 0.5877621 Vali Loss: 0.5531948 Test Loss: 0.2672462
	iters: 100, epoch: 21 | loss: 0.3809856
	speed: 0.2447s/iter; left time: 315.9366s
Epoch: 21 cost time: 17.23676347732544
Epoch: 21, Steps: 139 | Train Loss: 0.5879868 Vali Loss: 0.5540783 Test Loss: 0.2679293
	iters: 100, epoch: 22 | loss: 0.3800994
	speed: 0.2532s/iter; left time: 291.6678s
Epoch: 22 cost time: 17.89906597137451
Epoch: 22, Steps: 139 | Train Loss: 0.5882192 Vali Loss: 0.5548655 Test Loss: 0.2684872
	iters: 100, epoch: 23 | loss: 0.3791291
	speed: 0.2590s/iter; left time: 262.3706s
Epoch: 23 cost time: 18.05815100669861
Epoch: 23, Steps: 139 | Train Loss: 0.5884608 Vali Loss: 0.5555536 Test Loss: 0.2689281
	iters: 100, epoch: 24 | loss: 0.3781124
	speed: 0.2504s/iter; left time: 218.8211s
Epoch: 24 cost time: 17.89298939704895
Epoch: 24, Steps: 139 | Train Loss: 0.5887024 Vali Loss: 0.5561346 Test Loss: 0.2692555
	iters: 100, epoch: 25 | loss: 0.3771017
	speed: 0.2666s/iter; left time: 195.9323s
Epoch: 25 cost time: 18.23091197013855
Epoch: 25, Steps: 139 | Train Loss: 0.5889159 Vali Loss: 0.5565987 Test Loss: 0.2694710
	iters: 100, epoch: 26 | loss: 0.3761401
	speed: 0.2579s/iter; left time: 153.7327s
Epoch: 26 cost time: 18.285516023635864
Epoch: 26, Steps: 139 | Train Loss: 0.5890749 Vali Loss: 0.5569392 Test Loss: 0.2695774
	iters: 100, epoch: 27 | loss: 0.3752630
	speed: 0.2548s/iter; left time: 116.4300s
Epoch: 27 cost time: 17.801114082336426
Epoch: 27, Steps: 139 | Train Loss: 0.5891579 Vali Loss: 0.5571580 Test Loss: 0.2695887
	iters: 100, epoch: 28 | loss: 0.3744489
	speed: 0.2536s/iter; left time: 80.6496s
Epoch: 28 cost time: 17.853407382965088
Epoch: 28, Steps: 139 | Train Loss: 0.5891867 Vali Loss: 0.5572718 Test Loss: 0.2695310
	iters: 100, epoch: 29 | loss: 0.3736794
	speed: 0.2524s/iter; left time: 45.1721s
Epoch: 29 cost time: 17.662835359573364
Epoch: 29, Steps: 139 | Train Loss: 0.5891950 Vali Loss: 0.5573205 Test Loss: 0.2694468
	iters: 100, epoch: 30 | loss: 0.3729247
	speed: 0.2487s/iter; left time: 9.9483s
Epoch: 30 cost time: 17.876991748809814
Epoch: 30, Steps: 139 | Train Loss: 0.5892348 Vali Loss: 0.5573615 Test Loss: 0.2693751
>>>>>>>testing : weather_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2697525918483734, mae:0.306852251291275, rse:0.6821318864822388
Args in experiment:
Namespace(is_training=1, model_id='weather_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.4538550
	speed: 0.4147s/iter; left time: 1675.6683s
Epoch: 1 cost time: 30.375261545181274
Epoch: 1, Steps: 138 | Train Loss: 0.7525852 Vali Loss: 0.7027466 Test Loss: 0.3547494
	iters: 100, epoch: 2 | loss: 0.4484903
	speed: 0.3979s/iter; left time: 1552.9725s
Epoch: 2 cost time: 29.05807089805603
Epoch: 2, Steps: 138 | Train Loss: 0.6675594 Vali Loss: 0.6965185 Test Loss: 0.3514032
	iters: 100, epoch: 3 | loss: 0.4819614
	speed: 0.4000s/iter; left time: 1505.8263s
Epoch: 3 cost time: 29.575730562210083
Epoch: 3, Steps: 138 | Train Loss: 0.6580675 Vali Loss: 0.6929545 Test Loss: 0.3456230
	iters: 100, epoch: 4 | loss: 0.4480585
	speed: 0.3830s/iter; left time: 1389.1962s
Epoch: 4 cost time: 28.412480115890503
Epoch: 4, Steps: 138 | Train Loss: 0.6445451 Vali Loss: 0.7413533 Test Loss: 0.3441102
	iters: 100, epoch: 5 | loss: 0.4670055
	speed: 0.3819s/iter; left time: 1332.5980s
Epoch: 5 cost time: 28.30892300605774
Epoch: 5, Steps: 138 | Train Loss: 0.6473826 Vali Loss: 0.6629326 Test Loss: 0.3336316
	iters: 100, epoch: 6 | loss: 0.4415677
	speed: 0.3753s/iter; left time: 1257.5322s
Epoch: 6 cost time: 28.160396814346313
Epoch: 6, Steps: 138 | Train Loss: 0.6330022 Vali Loss: 0.6439711 Test Loss: 0.3320073
	iters: 100, epoch: 7 | loss: 0.4376135
	speed: 0.4023s/iter; left time: 1292.4402s
Epoch: 7 cost time: 29.78427815437317
Epoch: 7, Steps: 138 | Train Loss: 0.6344250 Vali Loss: 0.6513460 Test Loss: 0.3328666
	iters: 100, epoch: 8 | loss: 0.4359408
	speed: 0.3706s/iter; left time: 1139.6879s
Epoch: 8 cost time: 27.51337504386902
Epoch: 8, Steps: 138 | Train Loss: 0.6339933 Vali Loss: 0.6607380 Test Loss: 0.3335549
	iters: 100, epoch: 9 | loss: 0.4352116
	speed: 0.3956s/iter; left time: 1161.9121s
Epoch: 9 cost time: 29.642503023147583
Epoch: 9, Steps: 138 | Train Loss: 0.6340613 Vali Loss: 0.6626824 Test Loss: 0.3333700
	iters: 100, epoch: 10 | loss: 0.4347069
	speed: 0.3966s/iter; left time: 1110.0804s
Epoch: 10 cost time: 29.701683282852173
Epoch: 10, Steps: 138 | Train Loss: 0.6336789 Vali Loss: 0.6636832 Test Loss: 0.3329671
	iters: 100, epoch: 11 | loss: 0.4343740
	speed: 0.3829s/iter; left time: 1018.7958s
Epoch: 11 cost time: 29.179627656936646
Epoch: 11, Steps: 138 | Train Loss: 0.6333022 Vali Loss: 0.6636393 Test Loss: 0.3324957
	iters: 100, epoch: 12 | loss: 0.4340661
	speed: 0.4037s/iter; left time: 1018.5923s
Epoch: 12 cost time: 29.7808039188385
Epoch: 12, Steps: 138 | Train Loss: 0.6328940 Vali Loss: 0.6628616 Test Loss: 0.3319137
	iters: 100, epoch: 13 | loss: 0.4338444
	speed: 0.3810s/iter; left time: 908.5981s
Epoch: 13 cost time: 28.818613290786743
Epoch: 13, Steps: 138 | Train Loss: 0.6324181 Vali Loss: 0.6616039 Test Loss: 0.3312789
	iters: 100, epoch: 14 | loss: 0.4336827
	speed: 0.3863s/iter; left time: 867.9521s
Epoch: 14 cost time: 28.71890425682068
Epoch: 14, Steps: 138 | Train Loss: 0.6318799 Vali Loss: 0.6599813 Test Loss: 0.3305885
	iters: 100, epoch: 15 | loss: 0.4335943
	speed: 0.3762s/iter; left time: 793.4556s
Epoch: 15 cost time: 28.096752882003784
Epoch: 15, Steps: 138 | Train Loss: 0.6312701 Vali Loss: 0.6582124 Test Loss: 0.3298773
	iters: 100, epoch: 16 | loss: 0.4335901
	speed: 0.3686s/iter; left time: 726.5492s
Epoch: 16 cost time: 27.48388361930847
Epoch: 16, Steps: 138 | Train Loss: 0.6306040 Vali Loss: 0.6565482 Test Loss: 0.3291931
	iters: 100, epoch: 17 | loss: 0.4336987
	speed: 0.3880s/iter; left time: 711.1241s
Epoch: 17 cost time: 28.02209186553955
Epoch: 17, Steps: 138 | Train Loss: 0.6299146 Vali Loss: 0.6552629 Test Loss: 0.3286012
	iters: 100, epoch: 18 | loss: 0.4339570
	speed: 0.3960s/iter; left time: 671.2093s
Epoch: 18 cost time: 29.74372959136963
Epoch: 18, Steps: 138 | Train Loss: 0.6292530 Vali Loss: 0.6545343 Test Loss: 0.3281533
	iters: 100, epoch: 19 | loss: 0.4343931
	speed: 0.3808s/iter; left time: 592.9420s
Epoch: 19 cost time: 28.294650077819824
Epoch: 19, Steps: 138 | Train Loss: 0.6286666 Vali Loss: 0.6543711 Test Loss: 0.3278605
	iters: 100, epoch: 20 | loss: 0.4350176
	speed: 0.3775s/iter; left time: 535.6143s
Epoch: 20 cost time: 28.321585655212402
Epoch: 20, Steps: 138 | Train Loss: 0.6281779 Vali Loss: 0.6546686 Test Loss: 0.3277006
	iters: 100, epoch: 21 | loss: 0.4358304
	speed: 0.3785s/iter; left time: 484.7961s
Epoch: 21 cost time: 27.501768589019775
Epoch: 21, Steps: 138 | Train Loss: 0.6277850 Vali Loss: 0.6553105 Test Loss: 0.3276431
	iters: 100, epoch: 22 | loss: 0.4368224
	speed: 0.3918s/iter; left time: 447.8479s
Epoch: 22 cost time: 29.049355268478394
Epoch: 22, Steps: 138 | Train Loss: 0.6274782 Vali Loss: 0.6562046 Test Loss: 0.3276597
	iters: 100, epoch: 23 | loss: 0.4379780
	speed: 0.3988s/iter; left time: 400.7726s
Epoch: 23 cost time: 29.442588329315186
Epoch: 23, Steps: 138 | Train Loss: 0.6272491 Vali Loss: 0.6572930 Test Loss: 0.3277281
	iters: 100, epoch: 24 | loss: 0.4392711
	speed: 0.3675s/iter; left time: 318.6303s
Epoch: 24 cost time: 27.483999729156494
Epoch: 24, Steps: 138 | Train Loss: 0.6270972 Vali Loss: 0.6585480 Test Loss: 0.3278315
	iters: 100, epoch: 25 | loss: 0.4406658
	speed: 0.3782s/iter; left time: 275.7112s
Epoch: 25 cost time: 27.810450792312622
Epoch: 25, Steps: 138 | Train Loss: 0.6270359 Vali Loss: 0.6599723 Test Loss: 0.3279608
	iters: 100, epoch: 26 | loss: 0.4421278
	speed: 0.3669s/iter; left time: 216.8339s
Epoch: 26 cost time: 27.73030948638916
Epoch: 26, Steps: 138 | Train Loss: 0.6271008 Vali Loss: 0.6615914 Test Loss: 0.3281166
	iters: 100, epoch: 27 | loss: 0.4436896
	speed: 0.3906s/iter; left time: 176.9197s
Epoch: 27 cost time: 29.153278827667236
Epoch: 27, Steps: 138 | Train Loss: 0.6273557 Vali Loss: 0.6634156 Test Loss: 0.3283109
	iters: 100, epoch: 28 | loss: 0.4455744
	speed: 0.3940s/iter; left time: 124.1088s
Epoch: 28 cost time: 29.144598722457886
Epoch: 28, Steps: 138 | Train Loss: 0.6278629 Vali Loss: 0.6653627 Test Loss: 0.3285522
	iters: 100, epoch: 29 | loss: 0.4481188
	speed: 0.3697s/iter; left time: 65.4338s
Epoch: 29 cost time: 27.853237867355347
Epoch: 29, Steps: 138 | Train Loss: 0.6285839 Vali Loss: 0.6673659 Test Loss: 0.3288328
	iters: 100, epoch: 30 | loss: 0.4516156
	speed: 0.3978s/iter; left time: 15.5141s
Epoch: 30 cost time: 28.857009172439575
Epoch: 30, Steps: 138 | Train Loss: 0.6294094 Vali Loss: 0.6699987 Test Loss: 0.3292203
>>>>>>>testing : weather_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3251100480556488, mae:0.3453748822212219, rse:0.7503212690353394
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2431851
	speed: 1.4364s/iter; left time: 5761.3861s
Epoch: 1 cost time: 96.95143008232117
Epoch: 1, Steps: 137 | Train Loss: 0.2087275 Vali Loss: 0.1414938 Test Loss: 0.1646020
	iters: 100, epoch: 2 | loss: 0.1923705
	speed: 1.3296s/iter; left time: 5151.0227s
Epoch: 2 cost time: 89.94101333618164
Epoch: 2, Steps: 137 | Train Loss: 0.1524391 Vali Loss: 0.1282468 Test Loss: 0.1532815
	iters: 100, epoch: 3 | loss: 0.1905833
	speed: 1.3110s/iter; left time: 4899.0474s
Epoch: 3 cost time: 88.53213047981262
Epoch: 3, Steps: 137 | Train Loss: 0.1517104 Vali Loss: 0.1324147 Test Loss: 0.1571408
	iters: 100, epoch: 4 | loss: 0.1950833
	speed: 1.3134s/iter; left time: 4728.1724s
Epoch: 4 cost time: 88.03890323638916
Epoch: 4, Steps: 137 | Train Loss: 0.1523264 Vali Loss: 0.1353960 Test Loss: 0.1602241
	iters: 100, epoch: 5 | loss: 0.1976405
	speed: 1.3138s/iter; left time: 4549.5382s
Epoch: 5 cost time: 90.52748417854309
Epoch: 5, Steps: 137 | Train Loss: 0.1528485 Vali Loss: 0.1370019 Test Loss: 0.1620244
	iters: 100, epoch: 6 | loss: 0.1981079
	speed: 1.3112s/iter; left time: 4360.8940s
Epoch: 6 cost time: 87.92081475257874
Epoch: 6, Steps: 137 | Train Loss: 0.1532264 Vali Loss: 0.1376725 Test Loss: 0.1628503
	iters: 100, epoch: 7 | loss: 0.1980499
	speed: 1.3074s/iter; left time: 4169.1871s
Epoch: 7 cost time: 89.60546541213989
Epoch: 7, Steps: 137 | Train Loss: 0.1534604 Vali Loss: 0.1379176 Test Loss: 0.1632065
	iters: 100, epoch: 8 | loss: 0.1979305
	speed: 1.3059s/iter; left time: 3985.6059s
Epoch: 8 cost time: 87.60177397727966
Epoch: 8, Steps: 137 | Train Loss: 0.1536036 Vali Loss: 0.1380025 Test Loss: 0.1633706
	iters: 100, epoch: 9 | loss: 0.1978315
	speed: 1.3061s/iter; left time: 3807.1864s
Epoch: 9 cost time: 88.62902879714966
Epoch: 9, Steps: 137 | Train Loss: 0.1536948 Vali Loss: 0.1380286 Test Loss: 0.1634545
	iters: 100, epoch: 10 | loss: 0.1977587
	speed: 1.3068s/iter; left time: 3630.3573s
Epoch: 10 cost time: 88.64608931541443
Epoch: 10, Steps: 137 | Train Loss: 0.1537557 Vali Loss: 0.1380328 Test Loss: 0.1635019
	iters: 100, epoch: 11 | loss: 0.1977056
	speed: 1.3202s/iter; left time: 3486.6500s
Epoch: 11 cost time: 89.90798473358154
Epoch: 11, Steps: 137 | Train Loss: 0.1537981 Vali Loss: 0.1380288 Test Loss: 0.1635310
	iters: 100, epoch: 12 | loss: 0.1976659
	speed: 1.3231s/iter; left time: 3313.0462s
Epoch: 12 cost time: 89.09289741516113
Epoch: 12, Steps: 137 | Train Loss: 0.1538287 Vali Loss: 0.1380222 Test Loss: 0.1635502
	iters: 100, epoch: 13 | loss: 0.1976354
	speed: 1.3009s/iter; left time: 3079.2815s
Epoch: 13 cost time: 88.67252016067505
Epoch: 13, Steps: 137 | Train Loss: 0.1538513 Vali Loss: 0.1380152 Test Loss: 0.1635637
	iters: 100, epoch: 14 | loss: 0.1976109
	speed: 1.3148s/iter; left time: 2931.9407s
Epoch: 14 cost time: 90.06293082237244
Epoch: 14, Steps: 137 | Train Loss: 0.1538685 Vali Loss: 0.1380087 Test Loss: 0.1635737
	iters: 100, epoch: 15 | loss: 0.1975906
	speed: 1.3098s/iter; left time: 2741.4106s
Epoch: 15 cost time: 87.86544919013977
Epoch: 15, Steps: 137 | Train Loss: 0.1538817 Vali Loss: 0.1380031 Test Loss: 0.1635814
	iters: 100, epoch: 16 | loss: 0.1975733
	speed: 1.2937s/iter; left time: 2530.5076s
Epoch: 16 cost time: 87.94882559776306
Epoch: 16, Steps: 137 | Train Loss: 0.1538920 Vali Loss: 0.1379983 Test Loss: 0.1635877
	iters: 100, epoch: 17 | loss: 0.1975583
	speed: 1.3580s/iter; left time: 2470.1926s
Epoch: 17 cost time: 93.72380137443542
Epoch: 17, Steps: 137 | Train Loss: 0.1539002 Vali Loss: 0.1379944 Test Loss: 0.1635929
	iters: 100, epoch: 18 | loss: 0.1975451
	speed: 1.3690s/iter; left time: 2302.6034s
Epoch: 18 cost time: 93.36341452598572
Epoch: 18, Steps: 137 | Train Loss: 0.1539068 Vali Loss: 0.1379912 Test Loss: 0.1635974
	iters: 100, epoch: 19 | loss: 0.1975332
	speed: 1.3670s/iter; left time: 2111.9887s
Epoch: 19 cost time: 94.86080241203308
Epoch: 19, Steps: 137 | Train Loss: 0.1539122 Vali Loss: 0.1379888 Test Loss: 0.1636014
	iters: 100, epoch: 20 | loss: 0.1975224
	speed: 1.3922s/iter; left time: 1960.1719s
Epoch: 20 cost time: 95.1166660785675
Epoch: 20, Steps: 137 | Train Loss: 0.1539165 Vali Loss: 0.1379869 Test Loss: 0.1636050
	iters: 100, epoch: 21 | loss: 0.1975126
	speed: 1.3629s/iter; left time: 1732.1931s
Epoch: 21 cost time: 92.37081289291382
Epoch: 21, Steps: 137 | Train Loss: 0.1539201 Vali Loss: 0.1379855 Test Loss: 0.1636083
	iters: 100, epoch: 22 | loss: 0.1975035
	speed: 1.3553s/iter; left time: 1536.8747s
Epoch: 22 cost time: 92.53860855102539
Epoch: 22, Steps: 137 | Train Loss: 0.1539231 Vali Loss: 0.1379846 Test Loss: 0.1636113
	iters: 100, epoch: 23 | loss: 0.1974952
	speed: 1.3593s/iter; left time: 1355.2146s
Epoch: 23 cost time: 92.50883293151855
Epoch: 23, Steps: 137 | Train Loss: 0.1539256 Vali Loss: 0.1379840 Test Loss: 0.1636142
	iters: 100, epoch: 24 | loss: 0.1974874
	speed: 1.3658s/iter; left time: 1174.6194s
Epoch: 24 cost time: 93.19746375083923
Epoch: 24, Steps: 137 | Train Loss: 0.1539276 Vali Loss: 0.1379837 Test Loss: 0.1636169
	iters: 100, epoch: 25 | loss: 0.1974801
	speed: 1.3802s/iter; left time: 997.8597s
Epoch: 25 cost time: 94.30173587799072
Epoch: 25, Steps: 137 | Train Loss: 0.1539294 Vali Loss: 0.1379837 Test Loss: 0.1636194
	iters: 100, epoch: 26 | loss: 0.1974734
	speed: 1.3744s/iter; left time: 805.3977s
Epoch: 26 cost time: 93.94934463500977
Epoch: 26, Steps: 137 | Train Loss: 0.1539308 Vali Loss: 0.1379839 Test Loss: 0.1636218
	iters: 100, epoch: 27 | loss: 0.1974671
	speed: 1.3497s/iter; left time: 605.9950s
Epoch: 27 cost time: 92.09993124008179
Epoch: 27, Steps: 137 | Train Loss: 0.1539320 Vali Loss: 0.1379842 Test Loss: 0.1636240
	iters: 100, epoch: 28 | loss: 0.1974612
	speed: 1.3686s/iter; left time: 426.9880s
Epoch: 28 cost time: 93.00086641311646
Epoch: 28, Steps: 137 | Train Loss: 0.1539331 Vali Loss: 0.1379848 Test Loss: 0.1636263
	iters: 100, epoch: 29 | loss: 0.1974556
	speed: 1.3703s/iter; left time: 239.8084s
Epoch: 29 cost time: 93.79384589195251
Epoch: 29, Steps: 137 | Train Loss: 0.1539340 Vali Loss: 0.1379854 Test Loss: 0.1636284
	iters: 100, epoch: 30 | loss: 0.1974504
	speed: 1.3537s/iter; left time: 51.4418s
Epoch: 30 cost time: 91.53837394714355
Epoch: 30, Steps: 137 | Train Loss: 0.1539347 Vali Loss: 0.1379861 Test Loss: 0.1636304
>>>>>>>testing : Electricity_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.16351710259914398, mae:0.2660320997238159, rse:0.40190690755844116
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2314767
	speed: 1.6588s/iter; left time: 6603.5561s
Epoch: 1 cost time: 115.77479839324951
Epoch: 1, Steps: 136 | Train Loss: 0.2289864 Vali Loss: 0.1633728 Test Loss: 0.1892245
	iters: 100, epoch: 2 | loss: 0.1860326
	speed: 1.5717s/iter; left time: 6043.2129s
Epoch: 2 cost time: 109.30562090873718
Epoch: 2, Steps: 136 | Train Loss: 0.1719760 Vali Loss: 0.1556875 Test Loss: 0.1824849
	iters: 100, epoch: 3 | loss: 0.1783573
	speed: 1.5640s/iter; left time: 5800.7953s
Epoch: 3 cost time: 109.37858629226685
Epoch: 3, Steps: 136 | Train Loss: 0.1698274 Vali Loss: 0.1456867 Test Loss: 0.1731715
	iters: 100, epoch: 4 | loss: 0.1756103
	speed: 1.5618s/iter; left time: 5580.3789s
Epoch: 4 cost time: 109.19286704063416
Epoch: 4, Steps: 136 | Train Loss: 0.1693159 Vali Loss: 0.1443218 Test Loss: 0.1720162
	iters: 100, epoch: 5 | loss: 0.1750418
	speed: 1.5419s/iter; left time: 5299.6188s
Epoch: 5 cost time: 107.9645938873291
Epoch: 5, Steps: 136 | Train Loss: 0.1692790 Vali Loss: 0.1454597 Test Loss: 0.1731570
	iters: 100, epoch: 6 | loss: 0.1752204
	speed: 1.5279s/iter; left time: 5043.5497s
Epoch: 6 cost time: 107.34831404685974
Epoch: 6, Steps: 136 | Train Loss: 0.1694147 Vali Loss: 0.1472609 Test Loss: 0.1749922
	iters: 100, epoch: 7 | loss: 0.1756597
	speed: 1.5403s/iter; left time: 4875.0433s
Epoch: 7 cost time: 107.49555110931396
Epoch: 7, Steps: 136 | Train Loss: 0.1695875 Vali Loss: 0.1490020 Test Loss: 0.1768071
	iters: 100, epoch: 8 | loss: 0.1761627
	speed: 1.5307s/iter; left time: 4636.5003s
Epoch: 8 cost time: 107.37491416931152
Epoch: 8, Steps: 136 | Train Loss: 0.1697457 Vali Loss: 0.1504791 Test Loss: 0.1783688
	iters: 100, epoch: 9 | loss: 0.1766349
	speed: 1.5468s/iter; left time: 4474.8238s
Epoch: 9 cost time: 109.47221612930298
Epoch: 9, Steps: 136 | Train Loss: 0.1698785 Vali Loss: 0.1516785 Test Loss: 0.1796478
	iters: 100, epoch: 10 | loss: 0.1770384
	speed: 1.5412s/iter; left time: 4249.1580s
Epoch: 10 cost time: 106.60843801498413
Epoch: 10, Steps: 136 | Train Loss: 0.1699871 Vali Loss: 0.1526359 Test Loss: 0.1806739
	iters: 100, epoch: 11 | loss: 0.1773673
	speed: 1.5949s/iter; left time: 4180.3313s
Epoch: 11 cost time: 115.8024549484253
Epoch: 11, Steps: 136 | Train Loss: 0.1700748 Vali Loss: 0.1533955 Test Loss: 0.1814911
	iters: 100, epoch: 12 | loss: 0.1776295
	speed: 1.6300s/iter; left time: 4050.5341s
Epoch: 12 cost time: 114.2417893409729
Epoch: 12, Steps: 136 | Train Loss: 0.1701453 Vali Loss: 0.1539980 Test Loss: 0.1821413
	iters: 100, epoch: 13 | loss: 0.1778366
	speed: 1.6198s/iter; left time: 3804.8244s
Epoch: 13 cost time: 114.32893323898315
Epoch: 13, Steps: 136 | Train Loss: 0.1702019 Vali Loss: 0.1544776 Test Loss: 0.1826602
	iters: 100, epoch: 14 | loss: 0.1779997
	speed: 1.6201s/iter; left time: 3585.1970s
Epoch: 14 cost time: 114.15820264816284
Epoch: 14, Steps: 136 | Train Loss: 0.1702475 Vali Loss: 0.1548609 Test Loss: 0.1830760
	iters: 100, epoch: 15 | loss: 0.1781281
	speed: 1.6144s/iter; left time: 3353.2024s
Epoch: 15 cost time: 113.6623182296753
Epoch: 15, Steps: 136 | Train Loss: 0.1702843 Vali Loss: 0.1551688 Test Loss: 0.1834108
	iters: 100, epoch: 16 | loss: 0.1782294
	speed: 1.6152s/iter; left time: 3135.1617s
Epoch: 16 cost time: 114.54503154754639
Epoch: 16, Steps: 136 | Train Loss: 0.1703142 Vali Loss: 0.1554174 Test Loss: 0.1836819
	iters: 100, epoch: 17 | loss: 0.1783095
	speed: 1.6257s/iter; left time: 2934.3835s
Epoch: 17 cost time: 115.11531352996826
Epoch: 17, Steps: 136 | Train Loss: 0.1703384 Vali Loss: 0.1556192 Test Loss: 0.1839023
	iters: 100, epoch: 18 | loss: 0.1783730
	speed: 1.6239s/iter; left time: 2710.3688s
Epoch: 18 cost time: 114.54875206947327
Epoch: 18, Steps: 136 | Train Loss: 0.1703582 Vali Loss: 0.1557838 Test Loss: 0.1840825
	iters: 100, epoch: 19 | loss: 0.1784234
	speed: 1.6258s/iter; left time: 2492.3684s
Epoch: 19 cost time: 115.28782868385315
Epoch: 19, Steps: 136 | Train Loss: 0.1703744 Vali Loss: 0.1559186 Test Loss: 0.1842305
	iters: 100, epoch: 20 | loss: 0.1784635
	speed: 1.6261s/iter; left time: 2271.6876s
Epoch: 20 cost time: 114.31289935112
Epoch: 20, Steps: 136 | Train Loss: 0.1703877 Vali Loss: 0.1560296 Test Loss: 0.1843525
	iters: 100, epoch: 21 | loss: 0.1784955
	speed: 1.6047s/iter; left time: 2023.4965s
Epoch: 21 cost time: 112.84011769294739
Epoch: 21, Steps: 136 | Train Loss: 0.1703987 Vali Loss: 0.1561212 Test Loss: 0.1844535
	iters: 100, epoch: 22 | loss: 0.1785209
	speed: 1.6010s/iter; left time: 1801.1160s
Epoch: 22 cost time: 113.8365626335144
Epoch: 22, Steps: 136 | Train Loss: 0.1704077 Vali Loss: 0.1561972 Test Loss: 0.1845374
	iters: 100, epoch: 23 | loss: 0.1785411
	speed: 1.6009s/iter; left time: 1583.3315s
Epoch: 23 cost time: 112.73857283592224
Epoch: 23, Steps: 136 | Train Loss: 0.1704152 Vali Loss: 0.1562604 Test Loss: 0.1846074
	iters: 100, epoch: 24 | loss: 0.1785571
	speed: 1.6049s/iter; left time: 1369.0048s
Epoch: 24 cost time: 113.45032095909119
Epoch: 24, Steps: 136 | Train Loss: 0.1704214 Vali Loss: 0.1563132 Test Loss: 0.1846660
	iters: 100, epoch: 25 | loss: 0.1785698
	speed: 1.5549s/iter; left time: 1114.8960s
Epoch: 25 cost time: 107.69298982620239
Epoch: 25, Steps: 136 | Train Loss: 0.1704265 Vali Loss: 0.1563573 Test Loss: 0.1847151
	iters: 100, epoch: 26 | loss: 0.1785798
	speed: 1.5327s/iter; left time: 890.5006s
Epoch: 26 cost time: 106.87020540237427
Epoch: 26, Steps: 136 | Train Loss: 0.1704308 Vali Loss: 0.1563945 Test Loss: 0.1847565
	iters: 100, epoch: 27 | loss: 0.1785876
	speed: 1.5229s/iter; left time: 677.7029s
Epoch: 27 cost time: 107.03897047042847
Epoch: 27, Steps: 136 | Train Loss: 0.1704343 Vali Loss: 0.1564258 Test Loss: 0.1847914
	iters: 100, epoch: 28 | loss: 0.1785936
	speed: 1.5389s/iter; left time: 475.5246s
Epoch: 28 cost time: 108.24673962593079
Epoch: 28, Steps: 136 | Train Loss: 0.1704373 Vali Loss: 0.1564523 Test Loss: 0.1848211
	iters: 100, epoch: 29 | loss: 0.1785982
	speed: 1.5530s/iter; left time: 268.6708s
Epoch: 29 cost time: 109.16659617424011
Epoch: 29, Steps: 136 | Train Loss: 0.1704398 Vali Loss: 0.1564746 Test Loss: 0.1848462
	iters: 100, epoch: 30 | loss: 0.1786016
	speed: 1.5403s/iter; left time: 56.9915s
Epoch: 30 cost time: 108.5360004901886
Epoch: 30, Steps: 136 | Train Loss: 0.1704419 Vali Loss: 0.1564937 Test Loss: 0.1848676
>>>>>>>testing : Electricity_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.18189771473407745, mae:0.2910144329071045, rse:0.4240489602088928
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2102656
	speed: 1.9629s/iter; left time: 7755.2427s
Epoch: 1 cost time: 141.95424675941467
Epoch: 1, Steps: 135 | Train Loss: 0.2489475 Vali Loss: 0.1695510 Test Loss: 0.1929897
	iters: 100, epoch: 2 | loss: 0.1893084
	speed: 1.8130s/iter; left time: 6918.2381s
Epoch: 2 cost time: 122.49135637283325
Epoch: 2, Steps: 135 | Train Loss: 0.2007884 Vali Loss: 0.1817687 Test Loss: 0.2056774
	iters: 100, epoch: 3 | loss: 0.1858957
	speed: 1.7633s/iter; left time: 6490.7328s
Epoch: 3 cost time: 124.54888081550598
Epoch: 3, Steps: 135 | Train Loss: 0.1994729 Vali Loss: 0.1820939 Test Loss: 0.2067334
	iters: 100, epoch: 4 | loss: 0.1846720
	speed: 1.7619s/iter; left time: 6247.7924s
Epoch: 4 cost time: 124.66059279441833
Epoch: 4, Steps: 135 | Train Loss: 0.1987807 Vali Loss: 0.1801661 Test Loss: 0.2053237
	iters: 100, epoch: 5 | loss: 0.1840951
	speed: 1.7759s/iter; left time: 6057.5178s
Epoch: 5 cost time: 124.55732655525208
Epoch: 5, Steps: 135 | Train Loss: 0.1983704 Vali Loss: 0.1780366 Test Loss: 0.2035020
	iters: 100, epoch: 6 | loss: 0.1838357
	speed: 1.7720s/iter; left time: 5804.9376s
Epoch: 6 cost time: 125.15099358558655
Epoch: 6, Steps: 135 | Train Loss: 0.1980953 Vali Loss: 0.1761215 Test Loss: 0.2017765
	iters: 100, epoch: 7 | loss: 0.1837450
	speed: 1.7666s/iter; left time: 5548.8179s
Epoch: 7 cost time: 123.45699501037598
Epoch: 7, Steps: 135 | Train Loss: 0.1978985 Vali Loss: 0.1745063 Test Loss: 0.2002889
	iters: 100, epoch: 8 | loss: 0.1837496
	speed: 1.7504s/iter; left time: 5261.6150s
Epoch: 8 cost time: 123.3495225906372
Epoch: 8, Steps: 135 | Train Loss: 0.1977521 Vali Loss: 0.1731774 Test Loss: 0.1990540
	iters: 100, epoch: 9 | loss: 0.1838109
	speed: 1.7696s/iter; left time: 5080.6172s
Epoch: 9 cost time: 125.9125165939331
Epoch: 9, Steps: 135 | Train Loss: 0.1976405 Vali Loss: 0.1720946 Test Loss: 0.1980452
	iters: 100, epoch: 10 | loss: 0.1839066
	speed: 1.7804s/iter; left time: 4871.0704s
Epoch: 10 cost time: 125.06208443641663
Epoch: 10, Steps: 135 | Train Loss: 0.1975538 Vali Loss: 0.1712148 Test Loss: 0.1972258
	iters: 100, epoch: 11 | loss: 0.1840228
	speed: 1.7539s/iter; left time: 4561.8691s
Epoch: 11 cost time: 124.05908823013306
Epoch: 11, Steps: 135 | Train Loss: 0.1974853 Vali Loss: 0.1704994 Test Loss: 0.1965606
	iters: 100, epoch: 12 | loss: 0.1841503
	speed: 1.7658s/iter; left time: 4354.3996s
Epoch: 12 cost time: 124.16408944129944
Epoch: 12, Steps: 135 | Train Loss: 0.1974306 Vali Loss: 0.1699160 Test Loss: 0.1960194
	iters: 100, epoch: 13 | loss: 0.1842826
	speed: 1.7561s/iter; left time: 4093.4920s
Epoch: 13 cost time: 123.99232149124146
Epoch: 13, Steps: 135 | Train Loss: 0.1973866 Vali Loss: 0.1694388 Test Loss: 0.1955774
	iters: 100, epoch: 14 | loss: 0.1844154
	speed: 1.7639s/iter; left time: 3873.4948s
Epoch: 14 cost time: 124.34753561019897
Epoch: 14, Steps: 135 | Train Loss: 0.1973508 Vali Loss: 0.1690470 Test Loss: 0.1952150
	iters: 100, epoch: 15 | loss: 0.1845457
	speed: 1.7470s/iter; left time: 3600.5304s
Epoch: 15 cost time: 123.1264135837555
Epoch: 15, Steps: 135 | Train Loss: 0.1973214 Vali Loss: 0.1687240 Test Loss: 0.1949165
	iters: 100, epoch: 16 | loss: 0.1846717
	speed: 1.7547s/iter; left time: 3379.5820s
Epoch: 16 cost time: 123.77411985397339
Epoch: 16, Steps: 135 | Train Loss: 0.1972971 Vali Loss: 0.1684569 Test Loss: 0.1946694
	iters: 100, epoch: 17 | loss: 0.1847921
	speed: 1.7511s/iter; left time: 3136.1947s
Epoch: 17 cost time: 123.52307677268982
Epoch: 17, Steps: 135 | Train Loss: 0.1972770 Vali Loss: 0.1682351 Test Loss: 0.1944640
	iters: 100, epoch: 18 | loss: 0.1849060
	speed: 1.7521s/iter; left time: 2901.4858s
Epoch: 18 cost time: 122.85485601425171
Epoch: 18, Steps: 135 | Train Loss: 0.1972601 Vali Loss: 0.1680503 Test Loss: 0.1942924
	iters: 100, epoch: 19 | loss: 0.1850132
	speed: 1.7585s/iter; left time: 2674.7225s
Epoch: 19 cost time: 124.19236993789673
Epoch: 19, Steps: 135 | Train Loss: 0.1972459 Vali Loss: 0.1678958 Test Loss: 0.1941484
	iters: 100, epoch: 20 | loss: 0.1851136
	speed: 1.7680s/iter; left time: 2450.4156s
Epoch: 20 cost time: 124.60752320289612
Epoch: 20, Steps: 135 | Train Loss: 0.1972338 Vali Loss: 0.1677664 Test Loss: 0.1940271
	iters: 100, epoch: 21 | loss: 0.1852072
	speed: 1.7660s/iter; left time: 2209.2609s
Epoch: 21 cost time: 124.37755608558655
Epoch: 21, Steps: 135 | Train Loss: 0.1972235 Vali Loss: 0.1676575 Test Loss: 0.1939244
	iters: 100, epoch: 22 | loss: 0.1852941
	speed: 1.7693s/iter; left time: 1974.5532s
Epoch: 22 cost time: 125.84024906158447
Epoch: 22, Steps: 135 | Train Loss: 0.1972147 Vali Loss: 0.1675658 Test Loss: 0.1938372
	iters: 100, epoch: 23 | loss: 0.1853747
	speed: 1.7576s/iter; left time: 1724.1772s
Epoch: 23 cost time: 123.23945999145508
Epoch: 23, Steps: 135 | Train Loss: 0.1972070 Vali Loss: 0.1674883 Test Loss: 0.1937628
	iters: 100, epoch: 24 | loss: 0.1854493
	speed: 1.7643s/iter; left time: 1492.5623s
Epoch: 24 cost time: 124.7259030342102
Epoch: 24, Steps: 135 | Train Loss: 0.1972004 Vali Loss: 0.1674227 Test Loss: 0.1936992
	iters: 100, epoch: 25 | loss: 0.1855182
	speed: 1.7775s/iter; left time: 1263.7950s
Epoch: 25 cost time: 125.05768609046936
Epoch: 25, Steps: 135 | Train Loss: 0.1971947 Vali Loss: 0.1673670 Test Loss: 0.1936446
	iters: 100, epoch: 26 | loss: 0.1855818
	speed: 1.7531s/iter; left time: 1009.7866s
Epoch: 26 cost time: 124.45777249336243
Epoch: 26, Steps: 135 | Train Loss: 0.1971896 Vali Loss: 0.1673197 Test Loss: 0.1935977
	iters: 100, epoch: 27 | loss: 0.1856403
	speed: 1.7773s/iter; left time: 783.7845s
Epoch: 27 cost time: 124.81956624984741
Epoch: 27, Steps: 135 | Train Loss: 0.1971852 Vali Loss: 0.1672795 Test Loss: 0.1935572
	iters: 100, epoch: 28 | loss: 0.1856942
	speed: 1.7579s/iter; left time: 537.9139s
Epoch: 28 cost time: 123.8161084651947
Epoch: 28, Steps: 135 | Train Loss: 0.1971813 Vali Loss: 0.1672453 Test Loss: 0.1935222
	iters: 100, epoch: 29 | loss: 0.1857438
	speed: 1.7688s/iter; left time: 302.4623s
Epoch: 29 cost time: 125.04108619689941
Epoch: 29, Steps: 135 | Train Loss: 0.1971778 Vali Loss: 0.1672162 Test Loss: 0.1934919
	iters: 100, epoch: 30 | loss: 0.1857894
	speed: 1.7668s/iter; left time: 63.6057s
Epoch: 30 cost time: 126.54393458366394
Epoch: 30, Steps: 135 | Train Loss: 0.1971748 Vali Loss: 0.1671913 Test Loss: 0.1934656
>>>>>>>testing : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.19126562774181366, mae:0.2993529140949249, rse:0.4352710247039795
Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16973
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2839727
	speed: 2.7541s/iter; left time: 10633.6048s
Epoch: 1 cost time: 211.02374649047852
Epoch: 1, Steps: 132 | Train Loss: 0.2968918 Vali Loss: 0.2011228 Test Loss: 0.2415604
	iters: 100, epoch: 2 | loss: 0.2776476
	speed: 2.6539s/iter; left time: 9896.5235s
Epoch: 2 cost time: 198.8676302433014
Epoch: 2, Steps: 132 | Train Loss: 0.2455444 Vali Loss: 0.1878125 Test Loss: 0.2207165
	iters: 100, epoch: 3 | loss: 0.2809228
	speed: 2.6179s/iter; left time: 9416.4474s
Epoch: 3 cost time: 199.14105367660522
Epoch: 3, Steps: 132 | Train Loss: 0.2436285 Vali Loss: 0.1858479 Test Loss: 0.2179505
	iters: 100, epoch: 4 | loss: 0.2818470
	speed: 2.6100s/iter; left time: 9043.6854s
Epoch: 4 cost time: 199.27816104888916
Epoch: 4, Steps: 132 | Train Loss: 0.2427986 Vali Loss: 0.1852282 Test Loss: 0.2177547
	iters: 100, epoch: 5 | loss: 0.2812980
	speed: 2.5960s/iter; left time: 8652.4557s
Epoch: 5 cost time: 197.74523305892944
Epoch: 5, Steps: 132 | Train Loss: 0.2423379 Vali Loss: 0.1848106 Test Loss: 0.2177959
	iters: 100, epoch: 6 | loss: 0.2805412
	speed: 2.6160s/iter; left time: 8373.8768s
Epoch: 6 cost time: 199.04293584823608
Epoch: 6, Steps: 132 | Train Loss: 0.2421272 Vali Loss: 0.1844918 Test Loss: 0.2177844
	iters: 100, epoch: 7 | loss: 0.2800999
	speed: 2.6008s/iter; left time: 7981.9177s
Epoch: 7 cost time: 198.65475940704346
Epoch: 7, Steps: 132 | Train Loss: 0.2421060 Vali Loss: 0.1843054 Test Loss: 0.2177870
	iters: 100, epoch: 8 | loss: 0.2799189
	speed: 2.5944s/iter; left time: 7619.6127s
Epoch: 8 cost time: 197.44598269462585
Epoch: 8, Steps: 132 | Train Loss: 0.2421823 Vali Loss: 0.1842413 Test Loss: 0.2178399
	iters: 100, epoch: 9 | loss: 0.2798609
	speed: 2.5968s/iter; left time: 7284.0634s
Epoch: 9 cost time: 198.06178784370422
Epoch: 9, Steps: 132 | Train Loss: 0.2422918 Vali Loss: 0.1842575 Test Loss: 0.2179304
	iters: 100, epoch: 10 | loss: 0.2798459
	speed: 2.6140s/iter; left time: 6987.1676s
Epoch: 10 cost time: 199.77760362625122
Epoch: 10, Steps: 132 | Train Loss: 0.2424033 Vali Loss: 0.1843155 Test Loss: 0.2180370
	iters: 100, epoch: 11 | loss: 0.2798393
	speed: 2.6312s/iter; left time: 6685.9310s
Epoch: 11 cost time: 201.1988639831543
Epoch: 11, Steps: 132 | Train Loss: 0.2425048 Vali Loss: 0.1843904 Test Loss: 0.2181449
	iters: 100, epoch: 12 | loss: 0.2798287
	speed: 2.6020s/iter; left time: 6268.1496s
Epoch: 12 cost time: 198.71312642097473
Epoch: 12, Steps: 132 | Train Loss: 0.2425928 Vali Loss: 0.1844682 Test Loss: 0.2182458
	iters: 100, epoch: 13 | loss: 0.2798115
	speed: 2.5998s/iter; left time: 5919.8533s
Epoch: 13 cost time: 198.46828746795654
Epoch: 13, Steps: 132 | Train Loss: 0.2426674 Vali Loss: 0.1845420 Test Loss: 0.2183362
	iters: 100, epoch: 14 | loss: 0.2797890
	speed: 2.6242s/iter; left time: 5628.8381s
Epoch: 14 cost time: 200.79931569099426
Epoch: 14, Steps: 132 | Train Loss: 0.2427302 Vali Loss: 0.1846089 Test Loss: 0.2184152
	iters: 100, epoch: 15 | loss: 0.2797633
	speed: 2.6128s/iter; left time: 5259.5863s
Epoch: 15 cost time: 199.71749091148376
Epoch: 15, Steps: 132 | Train Loss: 0.2427828 Vali Loss: 0.1846680 Test Loss: 0.2184834
	iters: 100, epoch: 16 | loss: 0.2797365
	speed: 2.6050s/iter; left time: 4900.0073s
Epoch: 16 cost time: 198.71322107315063
Epoch: 16, Steps: 132 | Train Loss: 0.2428269 Vali Loss: 0.1847197 Test Loss: 0.2185417
	iters: 100, epoch: 17 | loss: 0.2797101
	speed: 2.6070s/iter; left time: 4559.6226s
Epoch: 17 cost time: 199.21603274345398
Epoch: 17, Steps: 132 | Train Loss: 0.2428639 Vali Loss: 0.1847644 Test Loss: 0.2185913
	iters: 100, epoch: 18 | loss: 0.2796853
	speed: 2.5910s/iter; left time: 4189.6572s
Epoch: 18 cost time: 197.77169179916382
Epoch: 18, Steps: 132 | Train Loss: 0.2428952 Vali Loss: 0.1848030 Test Loss: 0.2186335
	iters: 100, epoch: 19 | loss: 0.2796629
	speed: 2.5991s/iter; left time: 3859.6781s
Epoch: 19 cost time: 198.5334117412567
Epoch: 19, Steps: 132 | Train Loss: 0.2429214 Vali Loss: 0.1848364 Test Loss: 0.2186694
	iters: 100, epoch: 20 | loss: 0.2796431
	speed: 2.5929s/iter; left time: 3508.2327s
Epoch: 20 cost time: 197.77983903884888
Epoch: 20, Steps: 132 | Train Loss: 0.2429436 Vali Loss: 0.1848653 Test Loss: 0.2187000
	iters: 100, epoch: 21 | loss: 0.2796261
	speed: 2.6102s/iter; left time: 3187.0019s
Epoch: 21 cost time: 199.27842736244202
Epoch: 21, Steps: 132 | Train Loss: 0.2429624 Vali Loss: 0.1848903 Test Loss: 0.2187261
	iters: 100, epoch: 22 | loss: 0.2796119
	speed: 2.5875s/iter; left time: 2817.7645s
Epoch: 22 cost time: 197.69254755973816
Epoch: 22, Steps: 132 | Train Loss: 0.2429784 Vali Loss: 0.1849120 Test Loss: 0.2187485
	iters: 100, epoch: 23 | loss: 0.2796002
	speed: 2.6103s/iter; left time: 2498.0687s
Epoch: 23 cost time: 199.5890634059906
Epoch: 23, Steps: 132 | Train Loss: 0.2429919 Vali Loss: 0.1849309 Test Loss: 0.2187677
	iters: 100, epoch: 24 | loss: 0.2795908
	speed: 2.6212s/iter; left time: 2162.4977s
Epoch: 24 cost time: 200.1900234222412
Epoch: 24, Steps: 132 | Train Loss: 0.2430034 Vali Loss: 0.1849475 Test Loss: 0.2187842
	iters: 100, epoch: 25 | loss: 0.2795835
	speed: 2.6048s/iter; left time: 1805.1321s
Epoch: 25 cost time: 198.80769395828247
Epoch: 25, Steps: 132 | Train Loss: 0.2430133 Vali Loss: 0.1849620 Test Loss: 0.2187985
	iters: 100, epoch: 26 | loss: 0.2795780
	speed: 2.6057s/iter; left time: 1461.8226s
Epoch: 26 cost time: 199.5101797580719
Epoch: 26, Steps: 132 | Train Loss: 0.2430216 Vali Loss: 0.1849747 Test Loss: 0.2188109
	iters: 100, epoch: 27 | loss: 0.2795740
	speed: 2.6154s/iter; left time: 1122.0251s
Epoch: 27 cost time: 199.67652535438538
Epoch: 27, Steps: 132 | Train Loss: 0.2430288 Vali Loss: 0.1849860 Test Loss: 0.2188217
	iters: 100, epoch: 28 | loss: 0.2795714
	speed: 2.6038s/iter; left time: 773.3251s
Epoch: 28 cost time: 198.37327027320862
Epoch: 28, Steps: 132 | Train Loss: 0.2430348 Vali Loss: 0.1849958 Test Loss: 0.2188311
	iters: 100, epoch: 29 | loss: 0.2795697
	speed: 2.6102s/iter; left time: 430.6830s
Epoch: 29 cost time: 199.76110434532166
Epoch: 29, Steps: 132 | Train Loss: 0.2430400 Vali Loss: 0.1850046 Test Loss: 0.2188393
	iters: 100, epoch: 30 | loss: 0.2795689
	speed: 2.6297s/iter; left time: 86.7812s
Epoch: 30 cost time: 200.66895818710327
Epoch: 30, Steps: 132 | Train Loss: 0.2430444 Vali Loss: 0.1850123 Test Loss: 0.2188466
>>>>>>>testing : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2172478437423706, mae:0.3100104331970215, rse:0.4649488031864166
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Epoch: 1 cost time: 180.96906399726868
Epoch: 1, Steps: 89 | Train Loss: 0.3266055 Vali Loss: 0.3552630 Test Loss: 0.4160372
Epoch: 2 cost time: 171.55342268943787
Epoch: 2, Steps: 89 | Train Loss: 0.2639893 Vali Loss: 0.3530054 Test Loss: 0.4144239
Epoch: 3 cost time: 172.28373074531555
Epoch: 3, Steps: 89 | Train Loss: 0.2658203 Vali Loss: 0.3492836 Test Loss: 0.4118483
Epoch: 4 cost time: 172.74190711975098
Epoch: 4, Steps: 89 | Train Loss: 0.2663043 Vali Loss: 0.3487108 Test Loss: 0.4117303
Epoch: 5 cost time: 172.21790623664856
Epoch: 5, Steps: 89 | Train Loss: 0.2665738 Vali Loss: 0.3485804 Test Loss: 0.4119784
Epoch: 6 cost time: 171.91215348243713
Epoch: 6, Steps: 89 | Train Loss: 0.2667293 Vali Loss: 0.3486337 Test Loss: 0.4123079
Epoch: 7 cost time: 172.490656375885
Epoch: 7, Steps: 89 | Train Loss: 0.2668267 Vali Loss: 0.3487344 Test Loss: 0.4126182
Epoch: 8 cost time: 172.61935257911682
Epoch: 8, Steps: 89 | Train Loss: 0.2668904 Vali Loss: 0.3488416 Test Loss: 0.4128877
Epoch: 9 cost time: 172.0630280971527
Epoch: 9, Steps: 89 | Train Loss: 0.2669338 Vali Loss: 0.3489407 Test Loss: 0.4131150
Epoch: 10 cost time: 172.17559504508972
Epoch: 10, Steps: 89 | Train Loss: 0.2669640 Vali Loss: 0.3490278 Test Loss: 0.4133049
Epoch: 11 cost time: 171.89143657684326
Epoch: 11, Steps: 89 | Train Loss: 0.2669856 Vali Loss: 0.3491025 Test Loss: 0.4134634
Epoch: 12 cost time: 172.9461932182312
Epoch: 12, Steps: 89 | Train Loss: 0.2670012 Vali Loss: 0.3491659 Test Loss: 0.4135959
Epoch: 13 cost time: 172.5630156993866
Epoch: 13, Steps: 89 | Train Loss: 0.2670125 Vali Loss: 0.3492197 Test Loss: 0.4137072
Epoch: 14 cost time: 171.73969674110413
Epoch: 14, Steps: 89 | Train Loss: 0.2670209 Vali Loss: 0.3492651 Test Loss: 0.4138011
Epoch: 15 cost time: 172.60737919807434
Epoch: 15, Steps: 89 | Train Loss: 0.2670272 Vali Loss: 0.3493034 Test Loss: 0.4138807
Epoch: 16 cost time: 172.63804268836975
Epoch: 16, Steps: 89 | Train Loss: 0.2670319 Vali Loss: 0.3493360 Test Loss: 0.4139484
Epoch: 17 cost time: 172.25116109848022
Epoch: 17, Steps: 89 | Train Loss: 0.2670354 Vali Loss: 0.3493637 Test Loss: 0.4140063
Epoch: 18 cost time: 172.57982873916626
Epoch: 18, Steps: 89 | Train Loss: 0.2670381 Vali Loss: 0.3493871 Test Loss: 0.4140560
Epoch: 19 cost time: 171.45385003089905
Epoch: 19, Steps: 89 | Train Loss: 0.2670402 Vali Loss: 0.3494071 Test Loss: 0.4140988
Epoch: 20 cost time: 171.98746943473816
Epoch: 20, Steps: 89 | Train Loss: 0.2670417 Vali Loss: 0.3494243 Test Loss: 0.4141358
Epoch: 21 cost time: 172.09867668151855
Epoch: 21, Steps: 89 | Train Loss: 0.2670430 Vali Loss: 0.3494390 Test Loss: 0.4141679
Epoch: 22 cost time: 171.71554040908813
Epoch: 22, Steps: 89 | Train Loss: 0.2670439 Vali Loss: 0.3494515 Test Loss: 0.4141959
Epoch: 23 cost time: 172.46180033683777
Epoch: 23, Steps: 89 | Train Loss: 0.2670447 Vali Loss: 0.3494624 Test Loss: 0.4142203
Epoch: 24 cost time: 172.64900612831116
Epoch: 24, Steps: 89 | Train Loss: 0.2670452 Vali Loss: 0.3494717 Test Loss: 0.4142416
Epoch: 25 cost time: 172.44863867759705
Epoch: 25, Steps: 89 | Train Loss: 0.2670457 Vali Loss: 0.3494797 Test Loss: 0.4142603
Epoch: 26 cost time: 172.27925181388855
Epoch: 26, Steps: 89 | Train Loss: 0.2670461 Vali Loss: 0.3494866 Test Loss: 0.4142768
Epoch: 27 cost time: 172.56008100509644
Epoch: 27, Steps: 89 | Train Loss: 0.2670464 Vali Loss: 0.3494926 Test Loss: 0.4142912
Epoch: 28 cost time: 171.97719717025757
Epoch: 28, Steps: 89 | Train Loss: 0.2670466 Vali Loss: 0.3494978 Test Loss: 0.4143040
Epoch: 29 cost time: 172.11906480789185
Epoch: 29, Steps: 89 | Train Loss: 0.2670468 Vali Loss: 0.3495022 Test Loss: 0.4143153
Epoch: 30 cost time: 171.76828694343567
Epoch: 30, Steps: 89 | Train Loss: 0.2670470 Vali Loss: 0.3495061 Test Loss: 0.4143252
>>>>>>>testing : traffic_720_96_SparseTSF_custom_ftM_sl720_pl96_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
scripts/SparseTSF/mlp/traffic.sh: line 13: 376718 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1565
test 3317
Epoch: 1 cost time: 193.7714488506317
Epoch: 1, Steps: 88 | Train Loss: 0.3360535 Vali Loss: 0.3639995 Test Loss: 0.4384142
Epoch: 2 cost time: 181.08354544639587
Epoch: 2, Steps: 88 | Train Loss: 0.2727545 Vali Loss: 0.3849809 Test Loss: 0.4584789
Epoch: 3 cost time: 181.82295989990234
Epoch: 3, Steps: 88 | Train Loss: 0.2741727 Vali Loss: 0.3790156 Test Loss: 0.4519880
Epoch: 4 cost time: 181.38800048828125
Epoch: 4, Steps: 88 | Train Loss: 0.2741816 Vali Loss: 0.3767010 Test Loss: 0.4495248
Epoch: 5 cost time: 182.7841453552246
Epoch: 5, Steps: 88 | Train Loss: 0.2742963 Vali Loss: 0.3756351 Test Loss: 0.4484235
Epoch: 6 cost time: 181.32673335075378
Epoch: 6, Steps: 88 | Train Loss: 0.2743812 Vali Loss: 0.3749551 Test Loss: 0.4477405
Epoch: 7 cost time: 180.75184440612793
Epoch: 7, Steps: 88 | Train Loss: 0.2744379 Vali Loss: 0.3744923 Test Loss: 0.4472874
Epoch: 8 cost time: 181.0136649608612
Epoch: 8, Steps: 88 | Train Loss: 0.2744775 Vali Loss: 0.3741598 Test Loss: 0.4469695
Epoch: 9 cost time: 180.90481519699097
Epoch: 9, Steps: 88 | Train Loss: 0.2745059 Vali Loss: 0.3739121 Test Loss: 0.4467373
Epoch: 10 cost time: 181.29046177864075
Epoch: 10, Steps: 88 | Train Loss: 0.2745267 Vali Loss: 0.3737215 Test Loss: 0.4465618
Epoch: 11 cost time: 180.66112112998962
Epoch: 11, Steps: 88 | Train Loss: 0.2745422 Vali Loss: 0.3735709 Test Loss: 0.4464252
Epoch: 12 cost time: 181.10184860229492
Epoch: 12, Steps: 88 | Train Loss: 0.2745537 Vali Loss: 0.3734492 Test Loss: 0.4463161
Epoch: 13 cost time: 181.3061134815216
Epoch: 13, Steps: 88 | Train Loss: 0.2745623 Vali Loss: 0.3733491 Test Loss: 0.4462272
Epoch: 14 cost time: 181.19119262695312
Epoch: 14, Steps: 88 | Train Loss: 0.2745687 Vali Loss: 0.3732655 Test Loss: 0.4461535
Epoch: 15 cost time: 181.2526774406433
Epoch: 15, Steps: 88 | Train Loss: 0.2745735 Vali Loss: 0.3731946 Test Loss: 0.4460912
Epoch: 16 cost time: 181.88056921958923
Epoch: 16, Steps: 88 | Train Loss: 0.2745771 Vali Loss: 0.3731339 Test Loss: 0.4460382
Epoch: 17 cost time: 181.54908442497253
Epoch: 17, Steps: 88 | Train Loss: 0.2745797 Vali Loss: 0.3730814 Test Loss: 0.4459925
Epoch: 18 cost time: 180.60930109024048
Epoch: 18, Steps: 88 | Train Loss: 0.2745817 Vali Loss: 0.3730357 Test Loss: 0.4459526
Epoch: 19 cost time: 180.45278787612915
Epoch: 19, Steps: 88 | Train Loss: 0.2745831 Vali Loss: 0.3729955 Test Loss: 0.4459176
Epoch: 20 cost time: 181.45182132720947
Epoch: 20, Steps: 88 | Train Loss: 0.2745842 Vali Loss: 0.3729601 Test Loss: 0.4458868
Epoch: 21 cost time: 180.84953689575195
Epoch: 21, Steps: 88 | Train Loss: 0.2745849 Vali Loss: 0.3729287 Test Loss: 0.4458594
Epoch: 22 cost time: 181.28401064872742
Epoch: 22, Steps: 88 | Train Loss: 0.2745854 Vali Loss: 0.3729006 Test Loss: 0.4458348
Epoch: 23 cost time: 181.70280146598816
Epoch: 23, Steps: 88 | Train Loss: 0.2745857 Vali Loss: 0.3728756 Test Loss: 0.4458129
Epoch: 24 cost time: 181.06935477256775
Epoch: 24, Steps: 88 | Train Loss: 0.2745859 Vali Loss: 0.3728531 Test Loss: 0.4457932
Epoch: 25 cost time: 181.22735571861267
Epoch: 25, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3728328 Test Loss: 0.4457753
Epoch: 26 cost time: 180.39691805839539
Epoch: 26, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3728146 Test Loss: 0.4457593
Epoch: 27 cost time: 181.38357186317444
Epoch: 27, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3727981 Test Loss: 0.4457447
Epoch: 28 cost time: 182.47194170951843
Epoch: 28, Steps: 88 | Train Loss: 0.2745860 Vali Loss: 0.3727832 Test Loss: 0.4457315
Epoch: 29 cost time: 180.37192702293396
Epoch: 29, Steps: 88 | Train Loss: 0.2745859 Vali Loss: 0.3727696 Test Loss: 0.4457194
Epoch: 30 cost time: 181.382474899292
Epoch: 30, Steps: 88 | Train Loss: 0.2745858 Vali Loss: 0.3727573 Test Loss: 0.4457085
>>>>>>>testing : traffic_720_192_SparseTSF_custom_ftM_sl720_pl192_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
scripts/SparseTSF/mlp/traffic.sh: line 13: 405980 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1421
test 3173
Epoch: 1 cost time: 243.47175431251526
Epoch: 1, Steps: 87 | Train Loss: 0.3443427 Vali Loss: 0.4043419 Test Loss: 0.4910342
Epoch: 2 cost time: 237.81058359146118
Epoch: 2, Steps: 87 | Train Loss: 0.2946257 Vali Loss: 0.4128924 Test Loss: 0.5010188
Epoch: 3 cost time: 238.16855430603027
Epoch: 3, Steps: 87 | Train Loss: 0.2934018 Vali Loss: 0.4160010 Test Loss: 0.5033123
Epoch: 4 cost time: 239.2272024154663
Epoch: 4, Steps: 87 | Train Loss: 0.2927021 Vali Loss: 0.4163986 Test Loss: 0.5030383
Epoch: 5 cost time: 237.2603542804718
Epoch: 5, Steps: 87 | Train Loss: 0.2922287 Vali Loss: 0.4164222 Test Loss: 0.5026301
Epoch: 6 cost time: 237.39109873771667
Epoch: 6, Steps: 87 | Train Loss: 0.2918818 Vali Loss: 0.4163004 Test Loss: 0.5021969
Epoch: 7 cost time: 237.7169165611267
Epoch: 7, Steps: 87 | Train Loss: 0.2916146 Vali Loss: 0.4161284 Test Loss: 0.5017885
Epoch: 8 cost time: 238.11446285247803
Epoch: 8, Steps: 87 | Train Loss: 0.2914099 Vali Loss: 0.4159523 Test Loss: 0.5014309
Epoch: 9 cost time: 237.70986795425415
Epoch: 9, Steps: 87 | Train Loss: 0.2912512 Vali Loss: 0.4157861 Test Loss: 0.5011221
Epoch: 10 cost time: 237.99378514289856
Epoch: 10, Steps: 87 | Train Loss: 0.2911261 Vali Loss: 0.4156338 Test Loss: 0.5008561
Epoch: 11 cost time: 238.63579201698303
Epoch: 11, Steps: 87 | Train Loss: 0.2910261 Vali Loss: 0.4154961 Test Loss: 0.5006262
Epoch: 12 cost time: 238.25882577896118
Epoch: 12, Steps: 87 | Train Loss: 0.2909450 Vali Loss: 0.4153721 Test Loss: 0.5004264
Epoch: 13 cost time: 238.3977792263031
Epoch: 13, Steps: 87 | Train Loss: 0.2908782 Vali Loss: 0.4152606 Test Loss: 0.5002517
Epoch: 14 cost time: 237.88773155212402
Epoch: 14, Steps: 87 | Train Loss: 0.2908226 Vali Loss: 0.4151601 Test Loss: 0.5000980
Epoch: 15 cost time: 237.6566185951233
Epoch: 15, Steps: 87 | Train Loss: 0.2907757 Vali Loss: 0.4150695 Test Loss: 0.4999622
Epoch: 16 cost time: 237.96100449562073
Epoch: 16, Steps: 87 | Train Loss: 0.2907360 Vali Loss: 0.4149875 Test Loss: 0.4998415
Epoch: 17 cost time: 239.37224555015564
Epoch: 17, Steps: 87 | Train Loss: 0.2907019 Vali Loss: 0.4149133 Test Loss: 0.4997338
Epoch: 18 cost time: 237.9285445213318
Epoch: 18, Steps: 87 | Train Loss: 0.2906724 Vali Loss: 0.4148459 Test Loss: 0.4996373
Epoch: 19 cost time: 237.822203874588
Epoch: 19, Steps: 87 | Train Loss: 0.2906468 Vali Loss: 0.4147847 Test Loss: 0.4995506
Epoch: 20 cost time: 238.78354859352112
Epoch: 20, Steps: 87 | Train Loss: 0.2906244 Vali Loss: 0.4147287 Test Loss: 0.4994723
Epoch: 21 cost time: 236.92423510551453
Epoch: 21, Steps: 87 | Train Loss: 0.2906048 Vali Loss: 0.4146778 Test Loss: 0.4994017
Epoch: 22 cost time: 238.2793128490448
Epoch: 22, Steps: 87 | Train Loss: 0.2905873 Vali Loss: 0.4146312 Test Loss: 0.4993375
Epoch: 23 cost time: 238.20912957191467
Epoch: 23, Steps: 87 | Train Loss: 0.2905719 Vali Loss: 0.4145885 Test Loss: 0.4992791
Epoch: 24 cost time: 238.60981559753418
Epoch: 24, Steps: 87 | Train Loss: 0.2905582 Vali Loss: 0.4145494 Test Loss: 0.4992260
Epoch: 25 cost time: 238.11223554611206
Epoch: 25, Steps: 87 | Train Loss: 0.2905459 Vali Loss: 0.4145135 Test Loss: 0.4991777
Epoch: 26 cost time: 237.0277600288391
Epoch: 26, Steps: 87 | Train Loss: 0.2905349 Vali Loss: 0.4144805 Test Loss: 0.4991335
Epoch: 27 cost time: 237.36352467536926
Epoch: 27, Steps: 87 | Train Loss: 0.2905250 Vali Loss: 0.4144503 Test Loss: 0.4990930
Epoch: 28 cost time: 238.11557841300964
Epoch: 28, Steps: 87 | Train Loss: 0.2905162 Vali Loss: 0.4144224 Test Loss: 0.4990560
Epoch: 29 cost time: 238.0977017879486
Epoch: 29, Steps: 87 | Train Loss: 0.2905082 Vali Loss: 0.4143967 Test Loss: 0.4990220
Epoch: 30 cost time: 238.79962825775146
Epoch: 30, Steps: 87 | Train Loss: 0.2905009 Vali Loss: 0.4143731 Test Loss: 0.4989910
>>>>>>>testing : traffic_720_336_SparseTSF_custom_ftM_sl720_pl336_linear_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
scripts/SparseTSF/mlp/traffic.sh: line 13: 436858 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='traffic_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, model_type='linear', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : traffic_720_720_SparseTSF_custom_ftM_sl720_pl720_linear_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10841
val 1037
test 2789
scripts/SparseTSF/mlp/traffic.sh: line 13: 474565 Killed                  python -u run_longExp.py --is_training 1 --root_path $root_path_name --data_path $data_path_name --model_id $model_id_name'_'$seq_len'_'$pred_len --model $model_name --data $data_name --features M --seq_len $seq_len --pred_len $pred_len --period_len 24 --enc_in 862 --train_epochs 30 --patience 5 --itr 1 --batch_size 128 --learning_rate 0.03
Args in experiment:
Namespace(is_training=1, model_id='weather_720_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, model_type='mlp', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_96_SparseTSF_custom_ftM_sl720_pl96_mlp_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2758335
	speed: 0.2268s/iter; left time: 930.1410s
Epoch: 1 cost time: 15.44718337059021
Epoch: 1, Steps: 140 | Train Loss: 0.6152241 Vali Loss: 0.4878934 Test Loss: 0.2172577
	iters: 100, epoch: 2 | loss: 0.2396816
	speed: 0.2187s/iter; left time: 866.3749s
Epoch: 2 cost time: 15.168625354766846
Epoch: 2, Steps: 140 | Train Loss: 0.5739967 Vali Loss: 0.4739211 Test Loss: 0.2109677
	iters: 100, epoch: 3 | loss: 0.1895449
	speed: 0.2170s/iter; left time: 829.1450s
Epoch: 3 cost time: 15.18955659866333
Epoch: 3, Steps: 140 | Train Loss: 0.5202330 Vali Loss: 0.4560286 Test Loss: 0.1924592
	iters: 100, epoch: 4 | loss: 0.1628551
	speed: 0.2210s/iter; left time: 813.5630s
Epoch: 4 cost time: 16.038901329040527
Epoch: 4, Steps: 140 | Train Loss: 0.4742901 Vali Loss: 0.4218670 Test Loss: 0.1789320
	iters: 100, epoch: 5 | loss: 0.1710368
	speed: 0.2102s/iter; left time: 744.3305s
Epoch: 5 cost time: 15.160226583480835
Epoch: 5, Steps: 140 | Train Loss: 0.4537742 Vali Loss: 0.4202252 Test Loss: 0.1749290
	iters: 100, epoch: 6 | loss: 0.1724858
	speed: 0.2161s/iter; left time: 734.7963s
Epoch: 6 cost time: 15.821378231048584
Epoch: 6, Steps: 140 | Train Loss: 0.4513155 Vali Loss: 0.4587372 Test Loss: 0.1881520
	iters: 100, epoch: 7 | loss: 0.1707884
	speed: 0.2111s/iter; left time: 688.2765s
Epoch: 7 cost time: 14.909188270568848
Epoch: 7, Steps: 140 | Train Loss: 0.4528972 Vali Loss: 0.4380358 Test Loss: 0.1786523
	iters: 100, epoch: 8 | loss: 0.1540166
	speed: 0.2150s/iter; left time: 671.0978s
Epoch: 8 cost time: 15.388448476791382
Epoch: 8, Steps: 140 | Train Loss: 0.4499423 Vali Loss: 0.4077142 Test Loss: 0.1715005
	iters: 100, epoch: 9 | loss: 0.1703309
	speed: 0.2170s/iter; left time: 646.7418s
Epoch: 9 cost time: 15.196656465530396
Epoch: 9, Steps: 140 | Train Loss: 0.4479297 Vali Loss: 0.4630436 Test Loss: 0.1903322
	iters: 100, epoch: 10 | loss: 0.1787717
	speed: 0.2084s/iter; left time: 592.0784s
Epoch: 10 cost time: 14.560209035873413
Epoch: 10, Steps: 140 | Train Loss: 0.4552492 Vali Loss: 0.4770274 Test Loss: 0.1938371
	iters: 100, epoch: 11 | loss: 0.1609327
	speed: 0.2195s/iter; left time: 592.8961s
Epoch: 11 cost time: 15.715516805648804
Epoch: 11, Steps: 140 | Train Loss: 0.4587492 Vali Loss: 0.4692385 Test Loss: 0.1928772
	iters: 100, epoch: 12 | loss: 0.1596795
	speed: 0.2090s/iter; left time: 535.2048s
Epoch: 12 cost time: 14.837841749191284
Epoch: 12, Steps: 140 | Train Loss: 0.4494776 Vali Loss: 0.4164113 Test Loss: 0.1799275
	iters: 100, epoch: 13 | loss: 0.1767267
	speed: 0.2140s/iter; left time: 518.0677s
Epoch: 13 cost time: 15.540815114974976
Epoch: 13, Steps: 140 | Train Loss: 0.4536316 Vali Loss: 0.4851437 Test Loss: 0.1940717
	iters: 100, epoch: 14 | loss: 0.1615117
	speed: 0.2148s/iter; left time: 489.8661s
Epoch: 14 cost time: 15.165392637252808
Epoch: 14, Steps: 140 | Train Loss: 0.4619414 Vali Loss: 0.4246837 Test Loss: 0.1805030
	iters: 100, epoch: 15 | loss: 0.1558263
	speed: 0.2095s/iter; left time: 448.6179s
Epoch: 15 cost time: 14.599053382873535
Epoch: 15, Steps: 140 | Train Loss: 0.4533792 Vali Loss: 0.4284638 Test Loss: 0.1806825
	iters: 100, epoch: 16 | loss: 0.1716851
	speed: 0.2097s/iter; left time: 419.6547s
Epoch: 16 cost time: 15.221076726913452
Epoch: 16, Steps: 140 | Train Loss: 0.4457403 Vali Loss: 0.4089223 Test Loss: 0.1747647
	iters: 100, epoch: 17 | loss: 0.1745281
	speed: 0.2122s/iter; left time: 394.9601s
Epoch: 17 cost time: 15.372802019119263
Epoch: 17, Steps: 140 | Train Loss: 0.4495006 Vali Loss: 0.4245449 Test Loss: 0.1766960
	iters: 100, epoch: 18 | loss: 0.1555950
	speed: 0.2087s/iter; left time: 359.2375s
Epoch: 18 cost time: 14.412962436676025
Epoch: 18, Steps: 140 | Train Loss: 0.4466711 Vali Loss: 0.4527055 Test Loss: 0.1858525
	iters: 100, epoch: 19 | loss: 0.1607538
	speed: 0.2099s/iter; left time: 331.8025s
Epoch: 19 cost time: 14.855829954147339
Epoch: 19, Steps: 140 | Train Loss: 0.4526265 Vali Loss: 0.4685752 Test Loss: 0.1951125
	iters: 100, epoch: 20 | loss: 0.1727900
	speed: 0.2133s/iter; left time: 307.3940s
Epoch: 20 cost time: 15.284357786178589
Epoch: 20, Steps: 140 | Train Loss: 0.4519514 Vali Loss: 0.4278922 Test Loss: 0.1772311
	iters: 100, epoch: 21 | loss: 0.1665016
	speed: 0.2159s/iter; left time: 280.8395s
Epoch: 21 cost time: 15.015671730041504
Epoch: 21, Steps: 140 | Train Loss: 0.4500118 Vali Loss: 0.4285022 Test Loss: 0.1716501
	iters: 100, epoch: 22 | loss: 0.1744355
	speed: 0.2130s/iter; left time: 247.2732s
Epoch: 22 cost time: 15.20641541481018
Epoch: 22, Steps: 140 | Train Loss: 0.4556724 Vali Loss: 0.4472168 Test Loss: 0.1856355
	iters: 100, epoch: 23 | loss: 0.1628350
	speed: 0.2127s/iter; left time: 217.2089s
Epoch: 23 cost time: 15.060610294342041
Epoch: 23, Steps: 140 | Train Loss: 0.4484485 Vali Loss: 0.4069883 Test Loss: 0.1713846
	iters: 100, epoch: 24 | loss: 0.1606693
	speed: 0.2100s/iter; left time: 185.0026s
Epoch: 24 cost time: 14.317322492599487
Epoch: 24, Steps: 140 | Train Loss: 0.4440266 Vali Loss: 0.4208792 Test Loss: 0.1755185
	iters: 100, epoch: 25 | loss: 0.1649275
	speed: 0.2123s/iter; left time: 157.3066s
Epoch: 25 cost time: 15.667968988418579
Epoch: 25, Steps: 140 | Train Loss: 0.4765516 Vali Loss: 0.5112570 Test Loss: 0.2084513
	iters: 100, epoch: 26 | loss: 0.2043654
	speed: 0.2228s/iter; left time: 133.8747s
Epoch: 26 cost time: 15.768847465515137
Epoch: 26, Steps: 140 | Train Loss: 0.5181646 Vali Loss: 0.4349158 Test Loss: 0.1821951
	iters: 100, epoch: 27 | loss: 0.1567931
	speed: 0.2153s/iter; left time: 99.2509s
Epoch: 27 cost time: 15.341004610061646
Epoch: 27, Steps: 140 | Train Loss: 0.4483568 Vali Loss: 0.4167295 Test Loss: 0.1755111
	iters: 100, epoch: 28 | loss: 0.1544279
	speed: 0.2168s/iter; left time: 69.6056s
Epoch: 28 cost time: 15.229625940322876
Epoch: 28, Steps: 140 | Train Loss: 0.4528497 Vali Loss: 0.4518389 Test Loss: 0.1804321
	iters: 100, epoch: 29 | loss: 0.1553291
	speed: 0.2158s/iter; left time: 39.0568s
Epoch: 29 cost time: 15.441384077072144
Epoch: 29, Steps: 140 | Train Loss: 0.4452038 Vali Loss: 0.4219545 Test Loss: 0.1800339
	iters: 100, epoch: 30 | loss: 0.1533140
	speed: 0.2083s/iter; left time: 8.5405s
Epoch: 30 cost time: 15.214973449707031
Epoch: 30, Steps: 140 | Train Loss: 0.4465024 Vali Loss: 0.4099490 Test Loss: 0.1698875
>>>>>>>testing : weather_720_96_SparseTSF_custom_ftM_sl720_pl96_mlp_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17050231993198395, mae:0.2326509952545166, rse:0.5441483855247498
Args in experiment:
Namespace(is_training=1, model_id='weather_720_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, period_len=4, model_type='mlp', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_192_SparseTSF_custom_ftM_sl720_pl192_mlp_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4539734
	speed: 0.2500s/iter; left time: 1025.1598s
Epoch: 1 cost time: 17.414299488067627
Epoch: 1, Steps: 140 | Train Loss: 0.7187293 Vali Loss: 0.5532165 Test Loss: 0.2535428
	iters: 100, epoch: 2 | loss: 0.5236505
	speed: 0.2340s/iter; left time: 926.9814s
Epoch: 2 cost time: 16.100691318511963
Epoch: 2, Steps: 140 | Train Loss: 0.6328997 Vali Loss: 0.5345530 Test Loss: 0.2444455
	iters: 100, epoch: 3 | loss: 0.2773978
	speed: 0.2244s/iter; left time: 857.2671s
Epoch: 3 cost time: 15.67463207244873
Epoch: 3, Steps: 140 | Train Loss: 0.5964705 Vali Loss: 0.5013303 Test Loss: 0.2235291
	iters: 100, epoch: 4 | loss: 0.2905391
	speed: 0.2293s/iter; left time: 844.0654s
Epoch: 4 cost time: 16.27360200881958
Epoch: 4, Steps: 140 | Train Loss: 0.5234280 Vali Loss: 0.5150205 Test Loss: 0.2253019
	iters: 100, epoch: 5 | loss: 0.2645311
	speed: 0.2358s/iter; left time: 835.1446s
Epoch: 5 cost time: 16.68126392364502
Epoch: 5, Steps: 140 | Train Loss: 0.5031659 Vali Loss: 0.4856485 Test Loss: 0.2154533
	iters: 100, epoch: 6 | loss: 0.2696004
	speed: 0.2305s/iter; left time: 784.0507s
Epoch: 6 cost time: 16.17192769050598
Epoch: 6, Steps: 140 | Train Loss: 0.5033610 Vali Loss: 0.4779042 Test Loss: 0.2107373
	iters: 100, epoch: 7 | loss: 0.2713326
	speed: 0.2363s/iter; left time: 770.4326s
Epoch: 7 cost time: 16.646058797836304
Epoch: 7, Steps: 140 | Train Loss: 0.5121794 Vali Loss: 0.4858330 Test Loss: 0.2150535
	iters: 100, epoch: 8 | loss: 0.2733845
	speed: 0.2417s/iter; left time: 754.3937s
Epoch: 8 cost time: 17.32100009918213
Epoch: 8, Steps: 140 | Train Loss: 0.5106084 Vali Loss: 0.4783041 Test Loss: 0.2088677
	iters: 100, epoch: 9 | loss: 0.2733665
	speed: 0.2254s/iter; left time: 671.8438s
Epoch: 9 cost time: 15.743842124938965
Epoch: 9, Steps: 140 | Train Loss: 0.4987957 Vali Loss: 0.4794761 Test Loss: 0.2117680
	iters: 100, epoch: 10 | loss: 0.2815663
	speed: 0.2216s/iter; left time: 629.4798s
Epoch: 10 cost time: 15.691547393798828
Epoch: 10, Steps: 140 | Train Loss: 0.4964291 Vali Loss: 0.4736408 Test Loss: 0.2092438
	iters: 100, epoch: 11 | loss: 0.2716843
	speed: 0.2290s/iter; left time: 618.5490s
Epoch: 11 cost time: 15.913709163665771
Epoch: 11, Steps: 140 | Train Loss: 0.4976935 Vali Loss: 0.5169346 Test Loss: 0.2330394
	iters: 100, epoch: 12 | loss: 0.2706037
	speed: 0.2245s/iter; left time: 574.8377s
Epoch: 12 cost time: 15.70148754119873
Epoch: 12, Steps: 140 | Train Loss: 0.5173536 Vali Loss: 0.5244914 Test Loss: 0.2132755
	iters: 100, epoch: 13 | loss: 0.2649797
	speed: 0.2287s/iter; left time: 553.7520s
Epoch: 13 cost time: 16.417274951934814
Epoch: 13, Steps: 140 | Train Loss: 0.5158582 Vali Loss: 0.4781008 Test Loss: 0.2128054
	iters: 100, epoch: 14 | loss: 0.2702762
	speed: 0.2240s/iter; left time: 510.8894s
Epoch: 14 cost time: 15.69832158088684
Epoch: 14, Steps: 140 | Train Loss: 0.5136257 Vali Loss: 0.4864973 Test Loss: 0.2092028
	iters: 100, epoch: 15 | loss: 0.2588871
	speed: 0.2372s/iter; left time: 507.8197s
Epoch: 15 cost time: 17.061398029327393
Epoch: 15, Steps: 140 | Train Loss: 0.4993304 Vali Loss: 0.4765332 Test Loss: 0.2118426
	iters: 100, epoch: 16 | loss: 0.2638645
	speed: 0.2300s/iter; left time: 460.1592s
Epoch: 16 cost time: 16.071152687072754
Epoch: 16, Steps: 140 | Train Loss: 0.4945896 Vali Loss: 0.4750516 Test Loss: 0.2097169
	iters: 100, epoch: 17 | loss: 0.2659808
	speed: 0.2258s/iter; left time: 420.2052s
Epoch: 17 cost time: 16.61511492729187
Epoch: 17, Steps: 140 | Train Loss: 0.4945510 Vali Loss: 0.4684805 Test Loss: 0.2072596
	iters: 100, epoch: 18 | loss: 0.2652319
	speed: 0.2320s/iter; left time: 399.2001s
Epoch: 18 cost time: 15.83098030090332
Epoch: 18, Steps: 140 | Train Loss: 0.4952073 Vali Loss: 0.4794083 Test Loss: 0.2164358
	iters: 100, epoch: 19 | loss: 0.2621805
	speed: 0.2223s/iter; left time: 351.4623s
Epoch: 19 cost time: 15.760101556777954
Epoch: 19, Steps: 140 | Train Loss: 0.4997398 Vali Loss: 0.5061641 Test Loss: 0.2204047
	iters: 100, epoch: 20 | loss: 0.2447267
	speed: 0.2240s/iter; left time: 322.7216s
Epoch: 20 cost time: 15.688618898391724
Epoch: 20, Steps: 140 | Train Loss: 0.5234654 Vali Loss: 0.5134718 Test Loss: 0.2222768
	iters: 100, epoch: 21 | loss: 0.2645546
	speed: 0.2281s/iter; left time: 296.8205s
Epoch: 21 cost time: 15.937591791152954
Epoch: 21, Steps: 140 | Train Loss: 0.4971614 Vali Loss: 0.5044736 Test Loss: 0.2169363
	iters: 100, epoch: 22 | loss: 0.2651133
	speed: 0.2286s/iter; left time: 265.4501s
Epoch: 22 cost time: 16.9226713180542
Epoch: 22, Steps: 140 | Train Loss: 0.5026002 Vali Loss: 0.5023829 Test Loss: 0.2127680
	iters: 100, epoch: 23 | loss: 0.2727364
	speed: 0.2340s/iter; left time: 238.8817s
Epoch: 23 cost time: 16.289578437805176
Epoch: 23, Steps: 140 | Train Loss: 0.5163203 Vali Loss: 0.4871151 Test Loss: 0.2118277
	iters: 100, epoch: 24 | loss: 0.2680652
	speed: 0.2299s/iter; left time: 202.5176s
Epoch: 24 cost time: 16.049180030822754
Epoch: 24, Steps: 140 | Train Loss: 0.4988792 Vali Loss: 0.4786585 Test Loss: 0.2076346
	iters: 100, epoch: 25 | loss: 0.2834652
	speed: 0.2330s/iter; left time: 172.6388s
Epoch: 25 cost time: 16.110499382019043
Epoch: 25, Steps: 140 | Train Loss: 0.5181753 Vali Loss: 0.4768134 Test Loss: 0.2059589
	iters: 100, epoch: 26 | loss: 0.2637237
	speed: 0.2260s/iter; left time: 135.8277s
Epoch: 26 cost time: 16.091403484344482
Epoch: 26, Steps: 140 | Train Loss: 0.5048549 Vali Loss: 0.4968570 Test Loss: 0.2232106
	iters: 100, epoch: 27 | loss: 0.2863935
	speed: 0.2294s/iter; left time: 105.7494s
Epoch: 27 cost time: 16.02976155281067
Epoch: 27, Steps: 140 | Train Loss: 0.5057921 Vali Loss: 0.4881656 Test Loss: 0.2157020
	iters: 100, epoch: 28 | loss: 0.2599838
	speed: 0.2240s/iter; left time: 71.9128s
Epoch: 28 cost time: 15.89960789680481
Epoch: 28, Steps: 140 | Train Loss: 0.5082759 Vali Loss: 0.4833695 Test Loss: 0.2089676
	iters: 100, epoch: 29 | loss: 0.2562773
	speed: 0.2251s/iter; left time: 40.7487s
Epoch: 29 cost time: 15.837241411209106
Epoch: 29, Steps: 140 | Train Loss: 0.5042008 Vali Loss: 0.5111200 Test Loss: 0.2190104
	iters: 100, epoch: 30 | loss: 0.2693121
	speed: 0.2259s/iter; left time: 9.2629s
Epoch: 30 cost time: 15.69081449508667
Epoch: 30, Steps: 140 | Train Loss: 0.5028853 Vali Loss: 0.4917677 Test Loss: 0.2118826
>>>>>>>testing : weather_720_192_SparseTSF_custom_ftM_sl720_pl192_mlp_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.21415135264396667, mae:0.2678666412830353, rse:0.6091560125350952
Args in experiment:
Namespace(is_training=1, model_id='weather_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=4, model_type='mlp', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_336_SparseTSF_custom_ftM_sl720_pl336_mlp_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6618875
	speed: 0.2893s/iter; left time: 1177.9089s
Epoch: 1 cost time: 20.448802709579468
Epoch: 1, Steps: 139 | Train Loss: 0.7290207 Vali Loss: 0.6266211 Test Loss: 0.3044300
	iters: 100, epoch: 2 | loss: 0.4992081
	speed: 0.2672s/iter; left time: 1050.7650s
Epoch: 2 cost time: 18.212589502334595
Epoch: 2, Steps: 139 | Train Loss: 0.7175743 Vali Loss: 0.6281480 Test Loss: 0.2950329
	iters: 100, epoch: 3 | loss: 0.4252144
	speed: 0.2702s/iter; left time: 1024.8532s
Epoch: 3 cost time: 19.242818117141724
Epoch: 3, Steps: 139 | Train Loss: 0.5893829 Vali Loss: 0.5917244 Test Loss: 0.2802721
	iters: 100, epoch: 4 | loss: 0.4040957
	speed: 0.2595s/iter; left time: 948.3944s
Epoch: 4 cost time: 18.411745309829712
Epoch: 4, Steps: 139 | Train Loss: 0.5694365 Vali Loss: 0.5491670 Test Loss: 0.2641676
	iters: 100, epoch: 5 | loss: 0.4168243
	speed: 0.2620s/iter; left time: 920.9886s
Epoch: 5 cost time: 18.4958815574646
Epoch: 5, Steps: 139 | Train Loss: 0.5646750 Vali Loss: 0.5522693 Test Loss: 0.2631949
	iters: 100, epoch: 6 | loss: 0.3935989
	speed: 0.2668s/iter; left time: 900.5861s
Epoch: 6 cost time: 19.02967357635498
Epoch: 6, Steps: 139 | Train Loss: 0.5569221 Vali Loss: 0.5521124 Test Loss: 0.2619983
	iters: 100, epoch: 7 | loss: 0.4045744
	speed: 0.2632s/iter; left time: 851.9769s
Epoch: 7 cost time: 19.01079773902893
Epoch: 7, Steps: 139 | Train Loss: 0.5551961 Vali Loss: 0.5496275 Test Loss: 0.2618638
	iters: 100, epoch: 8 | loss: 0.4138409
	speed: 0.2614s/iter; left time: 809.9502s
Epoch: 8 cost time: 18.697481155395508
Epoch: 8, Steps: 139 | Train Loss: 0.5579461 Vali Loss: 0.5580437 Test Loss: 0.2631504
	iters: 100, epoch: 9 | loss: 0.4106273
	speed: 0.2663s/iter; left time: 788.0908s
Epoch: 9 cost time: 18.7238667011261
Epoch: 9, Steps: 139 | Train Loss: 0.5559098 Vali Loss: 0.5441222 Test Loss: 0.2607331
	iters: 100, epoch: 10 | loss: 0.4011896
	speed: 0.2651s/iter; left time: 747.5617s
Epoch: 10 cost time: 18.983936071395874
Epoch: 10, Steps: 139 | Train Loss: 0.5563023 Vali Loss: 0.5510588 Test Loss: 0.2592508
	iters: 100, epoch: 11 | loss: 0.4183024
	speed: 0.2683s/iter; left time: 719.1881s
Epoch: 11 cost time: 19.538479804992676
Epoch: 11, Steps: 139 | Train Loss: 0.5591884 Vali Loss: 0.5395078 Test Loss: 0.2593040
	iters: 100, epoch: 12 | loss: 0.3933780
	speed: 0.2681s/iter; left time: 681.4958s
Epoch: 12 cost time: 18.809380054473877
Epoch: 12, Steps: 139 | Train Loss: 0.5534768 Vali Loss: 0.5521721 Test Loss: 0.2589029
	iters: 100, epoch: 13 | loss: 0.4073903
	speed: 0.2645s/iter; left time: 635.5917s
Epoch: 13 cost time: 18.840172052383423
Epoch: 13, Steps: 139 | Train Loss: 0.5574833 Vali Loss: 0.5525576 Test Loss: 0.2632893
	iters: 100, epoch: 14 | loss: 0.4123726
	speed: 0.2585s/iter; left time: 585.2864s
Epoch: 14 cost time: 18.732142210006714
Epoch: 14, Steps: 139 | Train Loss: 0.5676187 Vali Loss: 0.5834315 Test Loss: 0.2716486
	iters: 100, epoch: 15 | loss: 0.4068502
	speed: 0.2633s/iter; left time: 559.5429s
Epoch: 15 cost time: 18.550968170166016
Epoch: 15, Steps: 139 | Train Loss: 0.5864313 Vali Loss: 0.5888273 Test Loss: 0.2747992
	iters: 100, epoch: 16 | loss: 0.3830674
	speed: 0.2843s/iter; left time: 564.6565s
Epoch: 16 cost time: 20.263970613479614
Epoch: 16, Steps: 139 | Train Loss: 0.5619111 Vali Loss: 0.5623608 Test Loss: 0.2612557
	iters: 100, epoch: 17 | loss: 0.4147955
	speed: 0.2801s/iter; left time: 517.3129s
Epoch: 17 cost time: 20.6028254032135
Epoch: 17, Steps: 139 | Train Loss: 0.5779998 Vali Loss: 0.5864794 Test Loss: 0.2690770
	iters: 100, epoch: 18 | loss: 0.3989249
	speed: 0.2966s/iter; left time: 506.6451s
Epoch: 18 cost time: 20.862592458724976
Epoch: 18, Steps: 139 | Train Loss: 0.5579873 Vali Loss: 0.5441140 Test Loss: 0.2579355
	iters: 100, epoch: 19 | loss: 0.4100754
	speed: 0.2845s/iter; left time: 446.4568s
Epoch: 19 cost time: 20.68354105949402
Epoch: 19, Steps: 139 | Train Loss: 0.5626030 Vali Loss: 0.5435414 Test Loss: 0.2560716
	iters: 100, epoch: 20 | loss: 0.4007616
	speed: 0.2852s/iter; left time: 407.8747s
Epoch: 20 cost time: 20.656381845474243
Epoch: 20, Steps: 139 | Train Loss: 0.5556970 Vali Loss: 0.5492105 Test Loss: 0.2586299
	iters: 100, epoch: 21 | loss: 0.4007602
	speed: 0.2702s/iter; left time: 348.8790s
Epoch: 21 cost time: 19.533759593963623
Epoch: 21, Steps: 139 | Train Loss: 0.5558183 Vali Loss: 0.5451481 Test Loss: 0.2564954
	iters: 100, epoch: 22 | loss: 0.4043930
	speed: 0.2674s/iter; left time: 308.0695s
Epoch: 22 cost time: 19.435072422027588
Epoch: 22, Steps: 139 | Train Loss: 0.5628143 Vali Loss: 0.5460470 Test Loss: 0.2611941
	iters: 100, epoch: 23 | loss: 0.4150396
	speed: 0.2669s/iter; left time: 270.3416s
Epoch: 23 cost time: 18.7319278717041
Epoch: 23, Steps: 139 | Train Loss: 0.5616714 Vali Loss: 0.5752411 Test Loss: 0.2667459
	iters: 100, epoch: 24 | loss: 0.4165638
	speed: 0.2687s/iter; left time: 234.8731s
Epoch: 24 cost time: 19.302310705184937
Epoch: 24, Steps: 139 | Train Loss: 0.5576146 Vali Loss: 0.5519722 Test Loss: 0.2627942
	iters: 100, epoch: 25 | loss: 0.4159537
	speed: 0.2642s/iter; left time: 194.1862s
Epoch: 25 cost time: 18.869119882583618
Epoch: 25, Steps: 139 | Train Loss: 0.5677511 Vali Loss: 0.5767726 Test Loss: 0.2640701
	iters: 100, epoch: 26 | loss: 0.4189216
	speed: 0.2588s/iter; left time: 154.2460s
Epoch: 26 cost time: 18.94131851196289
Epoch: 26, Steps: 139 | Train Loss: 0.5614594 Vali Loss: 0.5400252 Test Loss: 0.2568114
	iters: 100, epoch: 27 | loss: 0.4006496
	speed: 0.2732s/iter; left time: 124.8751s
Epoch: 27 cost time: 19.095710515975952
Epoch: 27, Steps: 139 | Train Loss: 0.5581657 Vali Loss: 0.5654544 Test Loss: 0.2626180
	iters: 100, epoch: 28 | loss: 0.3940910
	speed: 0.2636s/iter; left time: 83.8335s
Epoch: 28 cost time: 19.156010627746582
Epoch: 28, Steps: 139 | Train Loss: 0.5563331 Vali Loss: 0.5507029 Test Loss: 0.2608199
	iters: 100, epoch: 29 | loss: 0.4205534
	speed: 0.2667s/iter; left time: 47.7471s
Epoch: 29 cost time: 18.93934154510498
Epoch: 29, Steps: 139 | Train Loss: 0.5677938 Vali Loss: 0.6059881 Test Loss: 0.2742060
	iters: 100, epoch: 30 | loss: 0.4092102
	speed: 0.2686s/iter; left time: 10.7436s
Epoch: 30 cost time: 19.33815884590149
Epoch: 30, Steps: 139 | Train Loss: 0.5540869 Vali Loss: 0.5427518 Test Loss: 0.2568685
>>>>>>>testing : weather_720_336_SparseTSF_custom_ftM_sl720_pl336_mlp_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.25721248984336853, mae:0.29663464426994324, rse:0.6660879254341125
Args in experiment:
Namespace(is_training=1, model_id='weather_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=4, model_type='mlp', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use CPU
>>>>>>>start training : weather_720_720_SparseTSF_custom_ftM_sl720_pl720_mlp_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5850809
	speed: 0.4347s/iter; left time: 1756.7024s
Epoch: 1 cost time: 32.55388593673706
Epoch: 1, Steps: 138 | Train Loss: 0.7762574 Vali Loss: 0.6874487 Test Loss: 0.3529842
	iters: 100, epoch: 2 | loss: 0.4966063
	speed: 0.4218s/iter; left time: 1646.2494s
Epoch: 2 cost time: 30.664525747299194
Epoch: 2, Steps: 138 | Train Loss: 0.6878145 Vali Loss: 0.6851802 Test Loss: 0.3510318
	iters: 100, epoch: 3 | loss: 0.4540845
	speed: 0.4042s/iter; left time: 1521.7315s
Epoch: 3 cost time: 31.13368558883667
Epoch: 3, Steps: 138 | Train Loss: 0.6612455 Vali Loss: 0.6613976 Test Loss: 0.3401659
	iters: 100, epoch: 4 | loss: 0.4521471
	speed: 0.4095s/iter; left time: 1485.2095s
Epoch: 4 cost time: 30.76996684074402
Epoch: 4, Steps: 138 | Train Loss: 0.6375178 Vali Loss: 0.6500310 Test Loss: 0.3323048
	iters: 100, epoch: 5 | loss: 0.4588602
	speed: 0.4199s/iter; left time: 1464.9607s
Epoch: 5 cost time: 30.32296848297119
Epoch: 5, Steps: 138 | Train Loss: 0.6370035 Vali Loss: 0.6723291 Test Loss: 0.3333752
	iters: 100, epoch: 6 | loss: 0.4581849
	speed: 0.3996s/iter; left time: 1339.0313s
Epoch: 6 cost time: 30.210796356201172
Epoch: 6, Steps: 138 | Train Loss: 0.6296566 Vali Loss: 0.6366508 Test Loss: 0.3275419
	iters: 100, epoch: 7 | loss: 0.4543079
	speed: 0.4004s/iter; left time: 1286.3968s
Epoch: 7 cost time: 30.349337339401245
Epoch: 7, Steps: 138 | Train Loss: 0.6293159 Vali Loss: 0.6474383 Test Loss: 0.3339967
	iters: 100, epoch: 8 | loss: 0.4608923
	speed: 0.4110s/iter; left time: 1263.8881s
Epoch: 8 cost time: 30.972121000289917
Epoch: 8, Steps: 138 | Train Loss: 0.6321354 Vali Loss: 0.7016174 Test Loss: 0.3372690
	iters: 100, epoch: 9 | loss: 0.4703667
	speed: 0.4025s/iter; left time: 1182.1559s
Epoch: 9 cost time: 30.423466205596924
Epoch: 9, Steps: 138 | Train Loss: 0.6222056 Vali Loss: 0.6344043 Test Loss: 0.3216967
	iters: 100, epoch: 10 | loss: 0.4618827
	speed: 0.4017s/iter; left time: 1124.4158s
Epoch: 10 cost time: 30.444984436035156
Epoch: 10, Steps: 138 | Train Loss: 0.6255733 Vali Loss: 0.6358161 Test Loss: 0.3243442
	iters: 100, epoch: 11 | loss: 0.4604244
	speed: 0.4117s/iter; left time: 1095.5648s
Epoch: 11 cost time: 30.973906755447388
Epoch: 11, Steps: 138 | Train Loss: 0.6216171 Vali Loss: 0.6889943 Test Loss: 0.3320194
	iters: 100, epoch: 12 | loss: 0.4750411
	speed: 0.4180s/iter; left time: 1054.4895s
Epoch: 12 cost time: 31.605986833572388
Epoch: 12, Steps: 138 | Train Loss: 0.6293563 Vali Loss: 0.7129281 Test Loss: 0.3499635
	iters: 100, epoch: 13 | loss: 0.4706579
	speed: 0.4144s/iter; left time: 988.4412s
Epoch: 13 cost time: 30.74308180809021
Epoch: 13, Steps: 138 | Train Loss: 0.6351620 Vali Loss: 0.6495652 Test Loss: 0.3235893
	iters: 100, epoch: 14 | loss: 0.4821463
	speed: 0.4197s/iter; left time: 943.0815s
Epoch: 14 cost time: 31.329221487045288
Epoch: 14, Steps: 138 | Train Loss: 0.6268295 Vali Loss: 0.6410392 Test Loss: 0.3233962
	iters: 100, epoch: 15 | loss: 0.4583238
	speed: 0.4026s/iter; left time: 849.1157s
Epoch: 15 cost time: 30.20915937423706
Epoch: 15, Steps: 138 | Train Loss: 0.6608512 Vali Loss: 0.6514841 Test Loss: 0.3270413
	iters: 100, epoch: 16 | loss: 0.4707904
	speed: 0.4286s/iter; left time: 844.8289s
Epoch: 16 cost time: 32.4874906539917
Epoch: 16, Steps: 138 | Train Loss: 0.6303067 Vali Loss: 0.6191225 Test Loss: 0.3244957
	iters: 100, epoch: 17 | loss: 0.4762630
	speed: 0.4163s/iter; left time: 763.1285s
Epoch: 17 cost time: 31.576930046081543
Epoch: 17, Steps: 138 | Train Loss: 0.6248033 Vali Loss: 0.6986052 Test Loss: 0.3461882
	iters: 100, epoch: 18 | loss: 0.4780720
	speed: 0.4095s/iter; left time: 694.1741s
Epoch: 18 cost time: 31.148185968399048
Epoch: 18, Steps: 138 | Train Loss: 0.6627982 Vali Loss: 0.6337610 Test Loss: 0.3263778
	iters: 100, epoch: 19 | loss: 0.4701584
	speed: 0.4292s/iter; left time: 668.2065s
Epoch: 19 cost time: 32.92965769767761
Epoch: 19, Steps: 138 | Train Loss: 0.6202397 Vali Loss: 0.6283894 Test Loss: 0.3238476
	iters: 100, epoch: 20 | loss: 0.4648711
	speed: 0.3809s/iter; left time: 540.5220s
Epoch: 20 cost time: 29.19281816482544
Epoch: 20, Steps: 138 | Train Loss: 0.6193107 Vali Loss: 0.6202421 Test Loss: 0.3215440
	iters: 100, epoch: 21 | loss: 0.4764580
	speed: 0.4260s/iter; left time: 545.6662s
Epoch: 21 cost time: 31.586076498031616
Epoch: 21, Steps: 138 | Train Loss: 0.6238881 Vali Loss: 0.6479043 Test Loss: 0.3302640
	iters: 100, epoch: 22 | loss: 0.4559786
	speed: 0.3879s/iter; left time: 443.4171s
Epoch: 22 cost time: 28.991917371749878
Epoch: 22, Steps: 138 | Train Loss: 0.6228247 Vali Loss: 0.6343272 Test Loss: 0.3228132
	iters: 100, epoch: 23 | loss: 0.4603004
	speed: 0.4270s/iter; left time: 429.1628s
Epoch: 23 cost time: 31.955423831939697
Epoch: 23, Steps: 138 | Train Loss: 0.6244286 Vali Loss: 0.6504959 Test Loss: 0.3239650
	iters: 100, epoch: 24 | loss: 0.4797077
	speed: 0.4094s/iter; left time: 354.9575s
Epoch: 24 cost time: 31.435851335525513
Epoch: 24, Steps: 138 | Train Loss: 0.6312066 Vali Loss: 0.6783513 Test Loss: 0.3277008
	iters: 100, epoch: 25 | loss: 0.4588209
	speed: 0.4147s/iter; left time: 302.3141s
Epoch: 25 cost time: 31.274966955184937
Epoch: 25, Steps: 138 | Train Loss: 0.6448255 Vali Loss: 0.6332436 Test Loss: 0.3183399
	iters: 100, epoch: 26 | loss: 0.4633651
	speed: 0.4121s/iter; left time: 243.5784s
Epoch: 26 cost time: 30.87394070625305
Epoch: 26, Steps: 138 | Train Loss: 0.6417190 Vali Loss: 0.6482401 Test Loss: 0.3236333
	iters: 100, epoch: 27 | loss: 0.4716642
	speed: 0.4112s/iter; left time: 186.2613s
Epoch: 27 cost time: 31.49199628829956
Epoch: 27, Steps: 138 | Train Loss: 0.6389006 Vali Loss: 0.6370377 Test Loss: 0.3240776
	iters: 100, epoch: 28 | loss: 0.4985196
	speed: 0.4259s/iter; left time: 134.1504s
Epoch: 28 cost time: 32.38638496398926
Epoch: 28, Steps: 138 | Train Loss: 0.6282759 Vali Loss: 0.6563820 Test Loss: 0.3333994
	iters: 100, epoch: 29 | loss: 0.4773933
	speed: 0.4197s/iter; left time: 74.2858s
Epoch: 29 cost time: 31.46190333366394
Epoch: 29, Steps: 138 | Train Loss: 0.6353800 Vali Loss: 0.6316767 Test Loss: 0.3211061
	iters: 100, epoch: 30 | loss: 0.4932754
	speed: 0.4137s/iter; left time: 16.1338s
Epoch: 30 cost time: 31.39816951751709
Epoch: 30, Steps: 138 | Train Loss: 0.6253760 Vali Loss: 0.6177489 Test Loss: 0.3232316
>>>>>>>testing : weather_720_720_SparseTSF_custom_ftM_sl720_pl720_mlp_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32038432359695435, mae:0.3473871052265167, rse:0.7448480725288391
